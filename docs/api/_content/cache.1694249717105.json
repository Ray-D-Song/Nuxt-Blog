{"generatedAt":1694249734668,"generateTime":2755,"contents":[{"_path":"/1692667782462","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"协程(Coroutine)和纤程(Fiber)","description":"最近在看 C++ 引入 Fiber 的[N4024文档: 区分纤程和协程](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4024.pdf), 文章给纤程和协程十分明确的区分. 但过去我看过的很多资料会将其混为一谈或者模糊二者的边界, 所以写了这篇博客来总结一下.","cover":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202308221107239.png","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"最近在看 C++ 引入 Fiber 的"},{"type":"element","tag":"a","props":{"href":"https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4024.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"N4024文档: 区分纤程和协程"}]},{"type":"text","value":", 文章给纤程和协程十分明确的区分. 但过去我看过的很多资料会将其混为一谈或者模糊二者的边界, 所以写了这篇博客来总结一下."}]},{"type":"element","tag":"h1","props":{"id":"纤程"},"children":[{"type":"text","value":"纤程"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"线程是一种轻量级的线程, 本质是对线程时间进行切片处理, 调度也由用户进行. 最早是 Microsoft 为了解决 Unix 平台的引用程序移植到 Windows 上时出现的问题而发起的提案.\n因此, 纤程是一种偏底层的概念, 通常由操作系统或runtime自动管理, 并不需要程序员手动干预. 例如 Windows 上的纤程就是在其内核上实现."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"值得注意的是, php8 引入的 Fiber 虽然叫做纤程, 其本质是协程."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"一个线程可以包含多个纤程, 纤程的好处是可以有效防止长时间的线程挂起. 例如在 IO 操作时, 实例化一个纤程进行 IO 操作, 在该纤程阻塞的过程中, 因为仅占用了一部分的时间切片, 程序依旧可以继续执行."}]},{"type":"element","tag":"h1","props":{"id":"协程"},"children":[{"type":"text","value":"协程"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"协程的核心就是协作, 通过明确的挂起和恢复来控制执行的流程，使得不同任务之间可以更好地协同工作，共享信息，避免竞态条件，提高性能.\n协程在许多语言中都有实现, 例如 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Lua、Go、Ruby、Java(Virtual Threads)"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Python 和 JavaScript(基于生成器)"}]},{"type":"text","value":".\n如果要用一句话来总结协程: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"控制流的主动让出和恢复"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"有栈协程和无栈协程"},"children":[{"type":"text","value":"有栈协程和无栈协程"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"协程有很多种, 按照多个协程之间是否存在调用栈, 可以分为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"有栈协程(如goroutine、lua协程)"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"无栈协程(如JavaScript、Dart、Python)"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"调用栈的作用是保存协程挂起时的状态.\n有栈协程在恢复时会将其上下文从栈内存中捞出恢复到系统栈中.\n无栈协程的挂起和恢复则依赖闭包和状态机实现."}]}]},{"type":"element","tag":"h2","props":{"id":"对称协程和非对称协程"},"children":[{"type":"text","value":"对称协程和非对称协程"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"非对称协程提供"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"两种控制操作"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"调用协程"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"挂起协程"}]},{"type":"text","value":". 非对称协程可以看做是其调用者的从属, 跟特定调用者绑定, 在让出控制权时, 只能回到原调用者.\n对称协程提供"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"单个控制操作"}]},{"type":"text","value":", 可以通过该操作在协程之间显示的传递控制权. 对称协程在启动后和原调用者就没什么关系了, 也因此, 对称协程需要一个调度器去选择转移控制权操作的目标协程."}]},{"type":"element","tag":"h3","props":{"id":"对称"},"children":[{"type":"text","value":"对称"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"对称协程的例子非常少, 以下是 C++ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Boost.Coroutine"}]},{"type":"text","value":" 的示例."}]},{"type":"element","tag":"code","props":{"className":["language-cpp"],"code":"#include <iostream>\n#include <coroutine>\n\nstruct CountingCoroutine {\n    struct promise_type {\n        int current_value = 0;\n\n        CountingCoroutine get_return_object() {\n            return CountingCoroutine(std::coroutine_handle<promise_type>::from_promise(*this));\n        }\n\n        std::suspend_always initial_suspend() { return {}; }\n        std::suspend_always final_suspend() noexcept { return {}; }\n        void return_void() {}\n        void unhandled_exception() {}\n        std::suspend_always yield_value(int value) {\n            current_value = value;\n            return {};\n        }\n    };\n\n    std::coroutine_handle<promise_type> coroutine;\n\n    CountingCoroutine(std::coroutine_handle<promise_type> handle) : coroutine(handle) {}\n\n    ~CountingCoroutine() {\n        if (coroutine)\n            coroutine.destroy();\n    }\n\n    int getValue() const {\n        return coroutine.promise().current_value;\n    }\n\n    void resume() {\n        coroutine.resume();\n    }\n};\n\nCountingCoroutine generateNumbers() {\n    for (int i = 0; i < 10; ++i) {\n        //移交控制权\n        co_yield i;\n    }\n}\n\nint main() {\n    CountingCoroutine counter = generateNumbers();\n\n    while (counter.coroutine) {\n        std::cout << \"Value: \" << counter.getValue() << std::endl;\n        //回到 co_yield 继续执行\n        counter.resume();\n    }\n\n    return 0;\n}\n","language":"cpp","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"<iostream>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"<coroutine>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"struct"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"struct"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"promise_type"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" current_value "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"get_return_object"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"coroutine_handle"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"promise_type"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"from_promise"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"suspend_always"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"initial_suspend"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() { "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {}; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"suspend_always"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"final_suspend"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"noexcept"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {}; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"return_void"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"unhandled_exception"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"suspend_always"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"yield_value"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"value"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            current_value "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" value;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {};\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    };\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::coroutine_handle"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"promise_type"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" coroutine;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"coroutine_handle"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"promise_type"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"handle"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") : "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"coroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(handle) {}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"~CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" (coroutine)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            coroutine."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"destroy"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"getValue"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" coroutine."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"promise"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"().current_value;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"resume"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        coroutine."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"resume"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"};\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CountingCoroutine"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"generateNumbers"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"; i "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"; "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"i) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"        //移交控制权\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"co_yield"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" i;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    CountingCoroutine counter "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"generateNumbers"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" (counter.coroutine) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"Value: \""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" counter."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"getValue"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"::endl;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"        //回到 co_yield 继续执行\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        counter."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"resume"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 Go 语言中, 我们可以通过 chan 在没有特定从属关系的情况下完成协程间控制权的转移, 也算是对称协程的实现:"}]},{"type":"element","tag":"code","props":{"className":["language-go"],"code":"func main() {\n    ch1 := make(chan int)\n    ch2 := make(chan int)\n\n    var wg sync.WaitGroup\n\n    wg.Add(1)\n    go func() { // <--- 1\n        defer wg.Done()\n        for val := range ch1 {\n            fmt.Println(val)\n        }\n    }()\n\n    wg.Add(1)\n    go func() { // <--- 2\n        defer wg.Done()\n        for val := range ch2 {\n            ch1 <- val\n        }\n        close(ch1)\n    }()\n\n    wg.Add(1)\n    go func() { // <--- 3\n        defer wg.Done()\n        for i := 1; i <= 5; i++ {\n            ch2 <- i\n        }\n        close(ch2)\n    }()\n\n    wg.Wait()\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"func"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    ch1 "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"make"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"chan"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    ch2 "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"make"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"chan"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"var"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" wg sync.WaitGroup\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Add"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"go"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"func"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() { "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// <--- 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"defer"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Done"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" val "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ch1 {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            fmt."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Println"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(val)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Add"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"go"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"func"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() { "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// <--- 2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"defer"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Done"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" val "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ch2 {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            ch1 "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" val\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"close"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(ch1)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Add"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"go"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"func"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() { "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// <--- 3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"defer"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Done"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"; i "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"; i"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            ch2 "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"<-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"close"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(ch2)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    wg."}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"Wait"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果按照代码的顺序执行, 那正确的排列顺序是 3 2 1, 但在此处由于channel的阻塞特性, 第一个goroutine会等待第二个goroutine将数据从 ch2 传输到 ch1, 而第二个goroutine会等待第三个goroutine将数据发送到 ch2, 这就保证了它们的执行顺序. 最后，当所有goroutine都完成并且WaitGroup计数为0时, wg.Wait() 返回, 程序退出."}]},{"type":"element","tag":"h3","props":{"id":"非对称"},"children":[{"type":"text","value":"非对称"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"JavaScript 的 async、await、promise 则是创建非对称协程的工具."}]},{"type":"element","tag":"code","props":{"className":["language-javascript"],"code":"// async 标记的函数会创建协程\nconst useFetch = async () => { \n  // 执行到 await 处会将该协程挂起, 直到 fetch 返回\n  const res = await fetch('https://www.v2ex.com/api/topics/hot.json')\n  return res.json()\n}\n\nconst main = () => {\n  console.log('main start')\n  // 执行到此处, 控制权转移到协程\n  useFetch().then(res => { \n    // 执行到函数内部 await 处, 暂时挂起, 控制权返回到 main\n    console.log(`fetch res: ${res}`)\n  })\n  console.log('main end')\n}\n\nmain()\n/**\n * main start\n * main end\n * fetch res: ...\n */\n","language":"javascript","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// async 标记的函数会创建协程\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"useFetch"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" { \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 执行到 await 处会将该协程挂起, 直到 fetch 返回\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'https://www.v2ex.com/api/topics/hot.json'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" res."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  console."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'main start'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 执行到此处, 控制权转移到协程\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"useFetch"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" { \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 执行到函数内部 await 处, 暂时挂起, 控制权返回到 main\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`fetch res: ${"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"res"}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"}`"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  console."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'main end'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"/**\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":" * main start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":" * main end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":" * fetch res: ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":" */"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可以看到, 在 JS 中, 协程转移的控制权一定会返回到协程的调用者上."}]},{"type":"element","tag":"h1","props":{"id":"异同"},"children":[{"type":"text","value":"异同"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"看到这里, 会发现纤程和协程极为相似.\n没错, 大框架上两者的基本概念是一样的. 仅有的区别是纤程的状态保存由操作系统API提供, 而协程保存和恢复的方式由语言或库提供, 背后的实现更是则多种多样.\n所以我们可以认为: 纤程实际上就是由操作系统提供的协程.\n参考"},{"type":"element","tag":"a","props":{"href":"https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4024.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"Distinguishing coroutines and fibers"}]},{"type":"text","value":", 以下是一些细节的差别:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Fiber 在发起后不再依赖于发起它的程序存在, 可以拥有独立的生命周期.\nCoroutine 作为发起者的「子程序」, 不存在独立的生命周期."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Fiber 和 Thread 行为模式基本一致. 存在一个调度器, 某个 Fiber 被阻塞, 会将控制权移交至调度器, 由调度器去唤起其他准备运行的 Fiber.\n对称协程的行为方式和 Fiber 基本一致. 非对称协程不存在调度器, 控制权会回到发起者."}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-984823{color:#F97583;}\n.light .ct-984823{color:#D73A49;}\n.ct-212337{color:#E1E4E8;}\n.light .ct-212337{color:#24292E;}\n.ct-695486{color:#9ECBFF;}\n.light .ct-695486{color:#032F62;}\n.ct-941699{color:#B392F0;}\n.light .ct-941699{color:#6F42C1;}\n.ct-055721{color:#79B8FF;}\n.light .ct-055721{color:#005CC5;}\n.ct-880416{color:#FFAB70;}\n.light .ct-880416{color:#E36209;}\n.ct-782603{color:#6A737D;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"有栈协程和无栈协程","depth":2,"text":"有栈协程和无栈协程"},{"id":"对称协程和非对称协程","depth":2,"text":"对称协程和非对称协程","children":[{"id":"对称","depth":3,"text":"对称"},{"id":"非对称","depth":3,"text":"非对称"}]}]}},"_type":"markdown","_id":"content:1692667782462.md","_source":"content","_file":"1692667782462.md","_extension":"md"},{"_path":"/1693682341339","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"tailwind css的价值","description":"tailwind 一直饱受非议, 其中说的最多的大概就是「我为什么不直接写内联样式?」. 其实 tailwind 不仅是简写了样式名这么简单, 它是一系列便利的封装.","cover":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309030328341.png","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tailwind 一直饱受非议, 其中说的最多的大概就是「我为什么不直接写内联样式?」.\n其实 tailwind 不仅是简写了样式名这么简单, 它是一系列便利的封装."}]},{"type":"element","tag":"h1","props":{"id":"动画"},"children":[{"type":"text","value":"动画"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"举个简单的例子, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"animate-spin"}]},{"type":"text","value":" 属性用于添加旋转动画, 常用在 loading 中. 如果你用传统的 css/sass 编写, 那你至少需要以下代码."}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":"animation: spin 1s linear infinite;\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"animation: spin 1s linear infinite;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"@keyframes"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"spin"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"rotate"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"deg"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"to"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"rotate"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"360"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"deg"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h1","props":{"id":"交互"},"children":[{"type":"text","value":"交互"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果你希望一个 button 在鼠标炫富时颜色变浅, 在 tailwind 中只需要简单的"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hover:opacity-90"}]},{"type":"text","value":", 传统的 css 则需要:"}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":".btn:hover {\n  background-color: rga(xxx,xxx,xxx, 0.9)\n}\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":".btn:hover"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"background-color"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":": rga(xxx,xxx,xxx, "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"0.9"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h1","props":{"id":"响应式设计"},"children":[{"type":"text","value":"响应式设计"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"同时现代很多网页需要同时满足大屏设备和移动小屏设备的适配, 一般我们会用 css3 的 @media 来根据窗口尺寸编写不同的 css."}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":"@media (max-width: 768px) {\n  body {\n    width: 80%\n  }\n}\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"@media"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"max-width"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"768"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"px"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"width"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"80"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 tailwind 上, 适配 768px 宽度的设备, 你只要在样式前加入 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"md"}]},{"type":"text","value":" 前缀即可."}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<body class=\"md:w-4/5\">\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"md:w-4/5\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"h1","props":{"id":"利好无设计开发"},"children":[{"type":"text","value":"利好无设计开发"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"个人或者小团队开发产品, 没有专业的设计师出图, 写组件相当痛苦.\n例如 box-shadow 属性, button、card、modal, 每个都需要不一样的 shadow 样式. 在自己编写的时候经常要重复修改多次来达到一个比较好的效果, twc 提供了 7 个不同规格的选项, 都是泛用性非常高的选择.\n现在你要写一个现代化外观的按钮只需要"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"class=\"shadow-md rounded-lg\""}]},{"type":"text","value":"就行了."}]},{"type":"element","tag":"h1","props":{"id":"新的组件模式"},"children":[{"type":"text","value":"新的组件模式"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tailwind 还有个衍生品, Headless UI. 将组件的功能和样式彻底分离. 很多时候组件的功能是相同的 , 但是需要不同的样式, 有时候样子一样的组件却需要完全不同的 api. Headless 就是为了解决这个问题."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"NuxtLab UI 就是一个无头tailwind组件库, 闲得蛋疼可以看看, 代码很干净."}]}]},{"type":"element","tag":"h1","props":{"id":"class-也太特么长了"},"children":[{"type":"text","value":"class 也太特么长了"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这是一个由 tailwind 编写的 checkbox, 做了动效和深色适配."}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<input type=\"checkbox\" class=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600\"/>\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"input"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"checkbox\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"/>"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"看到这个长度是不是蚌埠住了. 没关系 tailwind 有"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"@layer"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"@apply"}]},{"type":"text","value":", 你可以像组织传统 css 一样去组织 tailwind, 封装自己的样式组件."}]},{"type":"element","tag":"code","props":{"className":["language-css"],"code":"@layer components {\n  .checkbox {\n    @apply\n    w-4\n    h-4\n    text-blue-600\n    bg-gray-100\n    border-gray-300\n    rounded\n    focus:ring-blue-500\n    dark:focus:ring-blue-600\n    dark:ring-offset-gray-800\n    focus:ring-2\n    dark:bg-gray-700\n    dark:border-gray-600\n  }\n}\n","language":"css","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"@layer"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" components {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":".checkbox"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    @"}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"apply\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"w-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"4\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"h-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"4\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"text-blue-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"600\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"bg-gray-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"100\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"border-gray-"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"300\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"rounded\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"focus"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":":ring-blue-500\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"dark"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":":focus:ring-blue-600\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"dark"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":":ring-offset-gray-800\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    focus:ring-2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"dark"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":":bg-gray-700\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"dark"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":":border-gray-600\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"过长的样式导致的问题是无法避免的, 即便你直接写内联也是一样, 最终一定会回到封装样式组件的路上. 但之前所有的好处(抽象、减少代码量、响应式...)都还在.\n这也是一种「不过早抽象」的价值. 一个小的 idea, 你可以一把梭抢先实现原型, 后期再抽离维护, tailwind 降低了这一操作的难度."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"当然, 这种种好处的前提是, 要么你写风格多样化的 C 端界面, 要么需要创建属于自己团队的组件库. 然而很明显, 大多数公司还停留在"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"element antd"}]},{"type":"text","value":"一把梭的阶段. 但这当然不是 tailwind 的问题."}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"实际上海外 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"3T架构(Next tRPC Tailwind)"}]},{"type":"text","value":" 已经火了有一阵了, 当然你也可以说这是前端瞎折腾, 但这确实是写出「现代、好看、交互强的界面」的捷径."}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-212337{color:#E1E4E8;}\n.light .ct-212337{color:#24292E;}\n.ct-984823{color:#F97583;}\n.light .ct-984823{color:#D73A49;}\n.ct-880416{color:#FFAB70;}\n.light .ct-880416{color:#E36209;}\n.ct-941699{color:#B392F0;}\n.light .ct-941699{color:#6F42C1;}\n.ct-055721{color:#79B8FF;}\n.light .ct-055721{color:#005CC5;}\n.ct-735963{color:#85E89D;}\n.light .ct-735963{color:#22863A;}\n.ct-695486{color:#9ECBFF;}\n.light .ct-695486{color:#032F62;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:1693682341339.md","_source":"content","_file":"1693682341339.md","_extension":"md"},{"_path":"/1694241377468","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"试试 WebComponents","description":"最近突然觉得`All in Frontend Framework`非常的麻烦, 引入和编写了很多代码就为了解决一些简单的问题. 所以在寻找无痛嵌入 Rails/Larval/Django 等 mvc 框架的前端解决方案.","cover":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309091438630.png","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"最近突然觉得"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"All in Frontend Framework"}]},{"type":"text","value":"非常的麻烦, 引入和编写了很多代码就为了解决一些简单的问题. 所以在寻找无痛嵌入 Rails/Larval/Django 等 mvc 框架的前端解决方案."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"首先前端框架最大的意义是引入组件机制, 带来了逻辑的抽象和可复用性. 在这方面, 现代浏览器提供了一个原生的解决方案, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Web Components"}]},{"type":"text","value":" (以下简称"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"wcp"}]},{"type":"text","value":")."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"wcp 是基于 JavaScript class 的封装, 先看一个简单的 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Card"}]},{"type":"text","value":" 组件示例, 然后再解释一些关键的概念."}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<body>\n  <template id=\"custom-card-template\">\n    <style>\n      /* 省略样式 */\n    </style>\n    <div class=\"container\">\n      <img class=\"cover\" src=\"https://lit.dev/images/logo.svg\">\n      <div class=\"desc\">Web Components FrameWork</div>\n    </div>\n  </template>\n\n  <div>自定义卡片组件: </div>\n  <custom-card></custom-card>\n</body>\n\n<script>\n  customElements.define('custom-card', ( // wcp 的定义方法\n    class card extends HTMLElement{\n      constructor() {\n        super() // super 方法必须放在顶部\n\n        const root = this.attachShadow({mode: 'open'}) // 创建 shadowDOM 的根元素\n        const template = document.getElementById('custom-card-template').content // 获取模板内容\n        root.appendChild(template.cloneNode(true)) // 挂载模板\n      }\n    }\n  ))\n</script>\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"custom-card-template\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"style"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"/* 省略样式 */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    </"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"style"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"container\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"img"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"cover\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"src"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"https://lit.dev/images/logo.svg\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"desc\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">Web Components FrameWork</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    </"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  </"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">自定义卡片组件: </"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  customElements."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"define"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'custom-card'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", ( "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// wcp 的定义方法\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"extends"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"HTMLElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"super"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// super 方法必须放在顶部\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"root"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"attachShadow"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"({mode: "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'open'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}) "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 创建 shadowDOM 的根元素\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"getElementById"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'custom-card-template'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":").content "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 获取模板内容\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        root."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"appendChild"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(template."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"cloneNode"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")) "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 挂载模板\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  ))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"showcase:\n"},{"type":"element","tag":"img","props":{"alt":"showcase","src":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309062231860.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"customelementsdefine"},"children":[{"type":"text","value":"customElements.define"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"定义web components 的方法, 接收三个参数, 组件名、定义组件的类、继承自哪个原生元素(可选)\n上面的例子是自定了一个全新的元素, 你也可以选择基于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"span"}]},{"type":"text","value":"标签去定义一个鼠标放置就会出现提示文案的"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"tooltip-span"}]}]},{"type":"element","tag":"code","props":{"className":["language-js"],"code":"window.customElements.define('tool-tip',\n  class toolTip extends HTMLSpanElement { // 继承 span 元素\n    constructor() {\n      super()\n      const spans = document.querySelectorAll('span')\n      spans.forEach((item) => {\n        if(item.getAttribute('is')==='tool-tip'){\n          item.style.position = 'relative'\n          // 注册光标放置事件, 放置后添加tip子元素\n          item.addEventListener('mouseenter', () => {\n            const tip = document.createElement('span')\n            tip.textContent = \"When you hover your mouse over it, a more detailed description will appear.\"\n            // 样式\n            tip.style.position = 'absolute'\n            tip.style.top = '100%'\n            tip.style.left = '0'\n            tip.style.backgroundColor = '#111827'\n            tip.style.color = '#98ABB9'\n            tip.id = 'tip'\n            item.appendChild(tip)\n          })\n          // 光标离开后移除子元素\n          item.addEventListener('mouseout', () => {\n            const tips = document.querySelectorAll('#tip')\n            tips.forEach(item => item.remove())\n          })\n        }\n      })\n    }\n  }, {\n  extends: 'span'\n})\n","language":"js","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"window.customElements."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"define"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'tool-tip'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"toolTip"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"extends"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"HTMLSpanElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 继承 span 元素\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"super"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"spans"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"querySelectorAll"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'span'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      spans."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"forEach"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"item"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(item."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"getAttribute"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'is'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'tool-tip'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"){\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          item.style.position "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'relative'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 注册光标放置事件, 放置后添加tip子元素\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          item."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"addEventListener"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'mouseenter'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", () "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"tip"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'span'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.textContent "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"When you hover your mouse over it, a more detailed description will appear.\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 样式\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.style.position "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'absolute'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.style.top "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'100%'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.style.left "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'0'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.style.backgroundColor "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'#111827'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.style.color "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'#98ABB9'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tip.id "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'tip'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            item."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"appendChild"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(tip)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 光标离开后移除子元素\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          item."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"addEventListener"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'mouseout'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", () "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"tips"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"querySelectorAll"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'#tip'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"            tips."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"forEach"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"item"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" item."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"remove"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"          })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }, {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  extends: "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'span'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"})"}]}]}]}]}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<script src=\"./card.js\" async></script>\n\n<div>\n  <!-- is 属性注明这是自定义的 tool-tip 元素 -->\n  <span is=\"tool-tip\">tool-tip</span>\n</div>\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"src"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"./card.js\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"<!-- is 属性注明这是自定义的 tool-tip 元素 -->\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"span"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"is"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"tool-tip\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">tool-tip</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"span"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"showcase:\n"},{"type":"element","tag":"img","props":{"alt":"showcase","src":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309091434319.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"template"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Vue 开发者对此一定不陌生, 浏览器原生的 template 标签和内容物在加载页面时不会出现, 多数情况下仅做容器作用, 在 wpc 中可以理解为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"(可复用的)一组标签的容器"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"slot"},"children":[{"type":"text","value":"slot"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"slot(插槽的作用)就和其名字一样, 在模板中定义"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"<slot>"}]},{"type":"text","value":"标签, 给他取个好听的名字, 页面上给 wcp 传入子元素就会被嵌入在定义插槽的位置.\n一个简单的示例:"}]},{"type":"element","tag":"code","props":{"className":["language-js"],"code":"const cardInner = `\n  <div>\n    <slot name=\"description\" style=\"font-style: italic; font-size: large;\">default description</slot>\n  </div>\n`\n","language":"js","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"cardInner"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  <div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    <slot name=\"description\" style=\"font-style: italic; font-size: large;\">default description</slot>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  </div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`"}]}]}]}]}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<custom-card>\n  <!-- slot 属性等于插槽名 -->\n  <span slot=\"description\">Ray-D-Song</span>\n</custom-card>\n<!-- 页面上会出现斜体的 Ray-D-Song -->\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"<!-- slot 属性等于插槽名 -->\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"span"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"slot"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"description\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">Ray-D-Song</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"span"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"<!-- 页面上会出现斜体的 Ray-D-Song -->"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"shadow-dom"},"children":[{"type":"text","value":"shadow DOM"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果你打开浏览器控制台查看WCP 的 DOM 树, 会发现类似以下结构:"}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<hello-world>\n  #shadow-root (open)\n    <div>\n      Hello World\n    </div>\n</hello-world>\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  #shadow-root (open)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      Hello World\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    </"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"#shadow-root"}]},{"type":"text","value":" 表明这是一个 shadow DOM. 你可以将 shadow DOM 理解为一种封装容器, 它将一组元素与其他元素隔离.\n"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"element-attachShadow({mode: 'open'})"}]},{"type":"text","value":" 方法用于将 shadow-root 附加到任何一个元素上. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"mode"}]},{"type":"text","value":" 字段可以取"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"open或closed"}]},{"type":"text","value":"(代表元素是否可被 JavaScript 操作)."}]},{"type":"element","tag":"h2","props":{"id":"生命周期"},"children":[{"type":"text","value":"生命周期"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"wcp 有许多现代前端框架的特性, 例如生命周期. 在 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Vue"}]},{"type":"text","value":" 中, 组件拥有"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"onBeforeMount(DOM挂载前)、onMounted(DOM挂载后)"}]},{"type":"text","value":"等生命周期.\nwcp 有以下生命周期:"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"回调函数"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"描述"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"connectedCallback"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"首次插入页面时调用"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"disconnectedCallback"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"从页面中删除时调用"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"adoptedCallback"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"移动到新页面时调用"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"attributeChangedCallback"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"增加、删除、修改自身属性时调用"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"例如我们希望组件被删除时弹窗:"}]},{"type":"element","tag":"code","props":{"className":["language-js"],"code":"class CustomComponent extends HTMLElement {\n  constructor() {\n    // ...\n  }\n\n  disconnectedCallback() {\n    window.alert(name + 'is removed')\n  }\n}\n","language":"js","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CustomComponent"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"extends"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"HTMLElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"disconnectedCallback"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    window."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"alert"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(name "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'is removed'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"简化操作"},"children":[{"type":"text","value":"简化操作"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不少文章都会选择用上面这种方式: JS 的 DOM API 去各种"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"createElement appendChild"}]},{"type":"text","value":", 或者用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"getElementById"}]},{"type":"text","value":"之类的的 api 获取 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"<template>"}]},{"type":"text","value":" 标签的内容, 但我个人觉得这实在是太操蛋了. (类似操作可见"},{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/zh-CN/docs/Web/API/Web_components/Using_custom_elements","rel":["nofollow"]},"children":[{"type":"text","value":"MDN"}]},{"type":"text","value":")\n如果你有一个需要复用的 Button. 上面这种做法就要求所有用到的页面都复制一份 Button 的 template, 还谈个屁的封装, 理想状态下一个(或多个)组件应该被包含在一个 js 文件中.\n有一种比较好的做法是封装一个"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"用组件名和模板内容字符串就可以创建组件"}]},{"type":"text","value":"的工具方法:"}]},{"type":"element","tag":"code","props":{"className":["language-js"],"code":"const useWebComponent = ({name, templateInner}) => {\n  window.customElements.define(name, // 注册\n    class CustomComponent extends HTMLElement {\n      constructor() {\n        super()\n        this.attachShadow({mode: 'open'})\n        const template = document.createElement('template') // 创建模板元素\n        template.innerHTML = templateInner\n        this.shadowRoot.append(template.content) // 拼接\n      }\n  })\n}\n\nconst batchRegister = (param) => { // 批量注册, param 为数组\n  param.forEach((item) => {\n    useWebComponent({name: item.name, templateInner: item.templateInner})\n  })\n}\n\nconst helloWorldInner = `\n  <div style=\"\n    color: cornflowerblue;\n    font-size: 18px;\n    \">\n    Hello World\n  </div>\n`\n\nconst cardInner = `\n  <div>\n    <div>Just a test</div>\n  </div>\n`\n\nconst componentList = [\n  {name: 'hello-world', templateInner: helloWorldInner},\n  {name: 'custom-card', templateInner: cardInner}\n]\n\nbatchRegister(componentList) // 批量注册\n","language":"js","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"useWebComponent"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ({"}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"templateInner"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}) "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  window.customElements."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"define"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(name, "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 注册\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"CustomComponent"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"extends"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"HTMLElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"super"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"attachShadow"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"({mode: "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'open'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"})\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" document."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'template'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 创建模板元素\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        template.innerHTML "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" templateInner\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":".shadowRoot."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"append"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(template.content) "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 拼接\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"      }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"batchRegister"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"param"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 批量注册, param 为数组\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  param."}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"forEach"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"class":"ct-880416"},"children":[{"type":"text","value":"item"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"useWebComponent"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"({name: item.name, templateInner: item.templateInner})\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"helloWorldInner"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  <div style=\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    color: cornflowerblue;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    font-size: 18px;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    \">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    Hello World\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  </div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"cardInner"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  <div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"    <div>Just a test</div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"  </div>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"`\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-055721"},"children":[{"type":"text","value":"componentList"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-984823"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  {name: "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'hello-world'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", templateInner: helloWorldInner},\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  {name: "}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"'custom-card'"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":", templateInner: cardInner}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"batchRegister"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"(componentList) "}]},{"type":"element","tag":"span","props":{"class":"ct-782603"},"children":[{"type":"text","value":"// 批量注册"}]}]}]}]}]},{"type":"element","tag":"code","props":{"className":["language-html"],"code":"<script src=\"./index.js\"></script>\n\n<div>\n  <hello-world></hello-world>\n  <custom-card></custom-card>\n</div>\n","language":"html","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-941699"},"children":[{"type":"text","value":"src"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-695486"},"children":[{"type":"text","value":"\"./index.js\""}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"  <"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"custom-card"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-735963"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-212337"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 webstorm 下,  形如"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"innerHTML"}]},{"type":"text","value":"的字符串会被自动识别为 HTML 元素, 有代码提示和着色, vsocde 用户可以安装"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"inline HTML"}]},{"type":"text","value":"插件."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"其实 Web Components 非常适合作为前端框架的"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"底层组件"}]},{"type":"text","value":", 如果你只是想实现一个轻量化的框架而不是一整套解决方案的话, 编译到 Web Components 就非常合适. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"lit"}]},{"type":"text","value":"就是这种思路的产物."}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-212337{color:#E1E4E8;}\n.light .ct-212337{color:#24292E;}\n.ct-735963{color:#85E89D;}\n.light .ct-735963{color:#22863A;}\n.ct-941699{color:#B392F0;}\n.light .ct-941699{color:#6F42C1;}\n.ct-695486{color:#9ECBFF;}\n.light .ct-695486{color:#032F62;}\n.ct-782603{color:#6A737D;}\n.ct-984823{color:#F97583;}\n.light .ct-984823{color:#D73A49;}\n.ct-055721{color:#79B8FF;}\n.light .ct-055721{color:#005CC5;}\n.ct-880416{color:#FFAB70;}\n.light .ct-880416{color:#E36209;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"customelementsdefine","depth":2,"text":"customElements.define"},{"id":"template","depth":2,"text":"template"},{"id":"slot","depth":2,"text":"slot"},{"id":"shadow-dom","depth":2,"text":"shadow DOM"},{"id":"生命周期","depth":2,"text":"生命周期"},{"id":"简化操作","depth":2,"text":"简化操作"}]}},"_type":"markdown","_id":"content:1694241377468.md","_source":"content","_file":"1694241377468.md","_extension":"md"},{"_path":"/1694247812862","_dir":"","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"并发与并行","description":"这是一篇小短文, 白话文给自己归纳关于并发和并行的知识.","cover":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309091654764.png","body":{"type":"root","children":[{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这是一篇小短文, 白话文给自己归纳所学."}]}]},{"type":"element","tag":"h1","props":{"id":"并发"},"children":[{"type":"text","value":"并发"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"假设有一个处理器, 因为只有一个核心, 所以同时他只能运行一个进程, 又因为一个进程上同一时间只能运行一个线程(task). 所以你可以认为, 同一时间, 这颗处理器只能处理一个任务.\n操作系统会将"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"cpu 使用时间"}]},{"type":"text","value":"这一资源进行切分, 这就是"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"时间分片"}]},{"type":"text","value":". 划分好的资源会按照调度算法分配给各个线程去使用. 进程内线程切换大概就是下面这种感觉:\n"},{"type":"element","tag":"img","props":{"alt":"线程调度","src":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309091531790.png"},"children":[]},{"type":"text","value":"\n因为现代计算机性能足够强劲, 所以使用者体感上是 task_1、2、3 在同时运行, 这就是并发.\n我并不想用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"「多个任务同时发生」"}]},{"type":"text","value":"这种模糊的表达, 在我看来"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"「并发」"}]},{"type":"text","value":"之所以被称为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"「并发」"}]},{"type":"text","value":"单纯是翻译后中文表达的问题.\n"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"无论如何, 同时确实只有一个任务在进行"}]}]},{"type":"element","tag":"h1","props":{"id":"并行"},"children":[{"type":"text","value":"并行"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"并行就要好理解的多, 你有一个多核心处理器, 例如拥有两个核心的老古董E6600. 因为有两个核心, 同时能运行两个进程, 每个进程可以运行一个线程. 因此, 你的电脑就能真正的在同一时间运行两个任务.\n大概就是下面这种感觉:\n"},{"type":"element","tag":"img","props":{"alt":"并行","src":"https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202309091547730.png"},"children":[]}]},{"type":"element","tag":"h1","props":{"id":"程序设计"},"children":[{"type":"text","value":"程序设计"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"之前刷知乎时, 看到这样一种说法:"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"「你的程序首先必须支持并发, 才能支持并行」"}]},{"type":"text","value":"\n因为并发不仅是对程序执行状态的一种描述, 也是一种程序设计的方法论:\n设计并发程序的条件就是"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"「程序的执行不依赖先后顺序、不依赖精确时序」"}]},{"type":"text","value":".\n而一段不依赖先后顺序、不依赖精确时序的程序, 自然可以拆分成多段, 在多个线程上运行. 这多个线程又可以运行在不同的进程之上, 进而实现"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"并行"}]},{"type":"text","value":"."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:1694247812862.md","_source":"content","_file":"1694247812862.md","_extension":"md"}],"navigation":[{"title":"协程(Coroutine)和纤程(Fiber)","_path":"/1692667782462"},{"title":"tailwind css的价值","_path":"/1693682341339"},{"title":"试试 WebComponents","_path":"/1694241377468"},{"title":"并发与并行","_path":"/1694247812862"}]}