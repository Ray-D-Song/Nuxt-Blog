[{"data":1,"prerenderedAt":7547},["Reactive",2],{"1701870426245":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":5,"_empty":6,"title":7,"description":8,"cover":9,"body":10,"_type":7542,"_id":7543,"_source":7544,"_file":7545,"_extension":7546},"/1701870426245","",false,"Vue 使用 Vitest进行单元测试","笔者过去并没有写过前端单测, 只在例如 Go 这样社区大力推崇 TDD 的语言中实践过, 最近遇到很多前端通过人肉测试难以覆盖的场景, 因此尝试 vitest.","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141754429.png",{"type":11,"children":12,"toc":7532},"root",[13,21,39,44,79,85,90,147,180,263,268,273,680,698,784,789,794,799,809,1494,1499,1504,1519,1547,1564,1975,1985,2498,2513,3179,3187,3193,3198,3446,3465,3500,3505,4578,4583,4593,4945,4974,4979,5007,5240,5245,5282,5301,5570,5575,5863,5880,5961,5966,6157,6172,6177,6182,6187,6197,6582,6593,6670,6692,6787,6793,6803,7343,7365,7370,7401,7406,7423,7514,7527],{"type":14,"tag":15,"props":16,"children":18},"element","h1",{"id":17},"单元测试的定义",[19],{"type":20,"value":17},"text",{"type":14,"tag":22,"props":23,"children":24},"blockquote",{},[25],{"type":14,"tag":26,"props":27,"children":28},"p",{},[29,31,37],{"type":20,"value":30},"单元测试（英语：Unit Testing）又称为模块测试 ",{"type":14,"tag":32,"props":33,"children":34},"span",{},[35],{"type":20,"value":36},"来源请求",{"type":20,"value":38}," ，是针对程序模块（软件设计的最小单位）来进行正确性检验的测试工作。程序单元是应用的最小可测试部件。在过程化编程中，一个单元就是单个程序、函数、过程等；对于面向对象编程，最小单元就是方法，包括基类（超类）、抽象类、或者派生类（子类）中的方法。     ———wiki",{"type":14,"tag":26,"props":40,"children":41},{},[42],{"type":20,"value":43},"在一个典型的 Vue 项目中, 我们经常需要进行单元测试的模块包括以下几种:",{"type":14,"tag":45,"props":46,"children":47},"ul",{},[48,54,59,64,69,74],{"type":14,"tag":49,"props":50,"children":51},"li",{},[52],{"type":20,"value":53},"hooks",{"type":14,"tag":49,"props":55,"children":56},{},[57],{"type":20,"value":58},"工具函数 (utils)",{"type":14,"tag":49,"props":60,"children":61},{},[62],{"type":20,"value":63},"校验规则 (reg)",{"type":14,"tag":49,"props":65,"children":66},{},[67],{"type":20,"value":68},"脚手架 (bin/scaffold)",{"type":14,"tag":49,"props":70,"children":71},{},[72],{"type":20,"value":73},"自定义 vue 指令",{"type":14,"tag":49,"props":75,"children":76},{},[77],{"type":20,"value":78},"全局状态 (store)",{"type":14,"tag":15,"props":80,"children":82},{"id":81},"初始化-vitest",[83],{"type":20,"value":84},"初始化 Vitest",{"type":14,"tag":26,"props":86,"children":87},{},[88],{"type":20,"value":89},"安装 Vitest",{"type":14,"tag":91,"props":92,"children":97},"code",{"className":93,"code":95,"language":96,"meta":5},[94],"language-bash","pnpm add -D vitest\n","bash",[98],{"type":14,"tag":99,"props":100,"children":101},"pre",{},[102],{"type":14,"tag":91,"props":103,"children":104},{"__ignoreMap":5},[105],{"type":14,"tag":32,"props":106,"children":109},{"class":107,"line":108},"line",1,[110,116,122,128,132,138,142],{"type":14,"tag":32,"props":111,"children":113},{"class":112},"ct-941699",[114],{"type":20,"value":115},"pnpm",{"type":14,"tag":32,"props":117,"children":119},{"class":118},"ct-212337",[120],{"type":20,"value":121}," ",{"type":14,"tag":32,"props":123,"children":125},{"class":124},"ct-695486",[126],{"type":20,"value":127},"add",{"type":14,"tag":32,"props":129,"children":130},{"class":118},[131],{"type":20,"value":121},{"type":14,"tag":32,"props":133,"children":135},{"class":134},"ct-055721",[136],{"type":20,"value":137},"-D",{"type":14,"tag":32,"props":139,"children":140},{"class":118},[141],{"type":20,"value":121},{"type":14,"tag":32,"props":143,"children":144},{"class":124},[145],{"type":20,"value":146},"vitest",{"type":14,"tag":26,"props":148,"children":149},{},[150,152,156,158,164,166,171,173,178],{"type":20,"value":151},"Vitest 默认和 Vite 配置集成, 不需要额外的配置文件.",{"type":14,"tag":153,"props":154,"children":155},"br",{},[],{"type":20,"value":157},"\n修改",{"type":14,"tag":159,"props":160,"children":161},"code-inline",{},[162],{"type":20,"value":163},"package.json",{"type":20,"value":165},", 在",{"type":14,"tag":159,"props":167,"children":168},{},[169],{"type":20,"value":170},"script",{"type":20,"value":172},"下新增",{"type":14,"tag":159,"props":174,"children":175},{},[176],{"type":20,"value":177},"test:unit",{"type":20,"value":179},"命令",{"type":14,"tag":91,"props":181,"children":186},{"className":182,"code":184,"language":185,"meta":5},[183],"language-json","  \"scripts\": {\n    ...\n    \"test:unit\": \"vitest\",\n  },\n","json",[187],{"type":14,"tag":99,"props":188,"children":189},{},[190],{"type":14,"tag":91,"props":191,"children":192},{"__ignoreMap":5},[193,211,226,254],{"type":14,"tag":32,"props":194,"children":195},{"class":107,"line":108},[196,201,206],{"type":14,"tag":32,"props":197,"children":198},{"class":118},[199],{"type":20,"value":200},"  ",{"type":14,"tag":32,"props":202,"children":203},{"class":124},[204],{"type":20,"value":205},"\"scripts\"",{"type":14,"tag":32,"props":207,"children":208},{"class":118},[209],{"type":20,"value":210},": {\n",{"type":14,"tag":32,"props":212,"children":214},{"class":107,"line":213},2,[215,220],{"type":14,"tag":32,"props":216,"children":217},{"class":118},[218],{"type":20,"value":219},"    ",{"type":14,"tag":32,"props":221,"children":223},{"class":222},"ct-338738",[224],{"type":20,"value":225},"...\n",{"type":14,"tag":32,"props":227,"children":229},{"class":107,"line":228},3,[230,234,239,244,249],{"type":14,"tag":32,"props":231,"children":232},{"class":118},[233],{"type":20,"value":219},{"type":14,"tag":32,"props":235,"children":236},{"class":134},[237],{"type":20,"value":238},"\"test:unit\"",{"type":14,"tag":32,"props":240,"children":241},{"class":118},[242],{"type":20,"value":243},": ",{"type":14,"tag":32,"props":245,"children":246},{"class":124},[247],{"type":20,"value":248},"\"vitest\"",{"type":14,"tag":32,"props":250,"children":251},{"class":118},[252],{"type":20,"value":253},",\n",{"type":14,"tag":32,"props":255,"children":257},{"class":107,"line":256},4,[258],{"type":14,"tag":32,"props":259,"children":260},{"class":118},[261],{"type":20,"value":262},"  },",{"type":14,"tag":15,"props":264,"children":266},{"id":265},"编写测试用例",[267],{"type":20,"value":265},{"type":14,"tag":26,"props":269,"children":270},{},[271],{"type":20,"value":272},"测试一个手机号校验函数",{"type":14,"tag":91,"props":274,"children":279},{"className":275,"code":277,"language":278,"meta":5},[276],"language-ts","/** /reg/phone.ts */\n// 校验是否国内手机号\nexport function regChinesePhoneNumber(phoneNumber: string) {\n  const regex = /^1[3456789]\\d{9}$/\n  return regex.test(phoneNumber)\n}\n\n/** /reg/phone.test.ts */\nimport { describe, expect, test } from 'vitest'\nimport { regChinesePhoneNumber } from '../phone'\n\ndescribe('phone', () => {\n  test('phone number belongs to Chinese', () => {\n    expect(regChinesePhoneNumber('17725663831')).toBe(true)\n  })\n})\n","ts",[280],{"type":14,"tag":99,"props":281,"children":282},{},[283],{"type":14,"tag":91,"props":284,"children":285},{"__ignoreMap":5},[286,295,303,360,425,453,462,471,480,508,534,542,575,608,662,671],{"type":14,"tag":32,"props":287,"children":288},{"class":107,"line":108},[289],{"type":14,"tag":32,"props":290,"children":292},{"class":291},"ct-782603",[293],{"type":20,"value":294},"/** /reg/phone.ts */\n",{"type":14,"tag":32,"props":296,"children":297},{"class":107,"line":213},[298],{"type":14,"tag":32,"props":299,"children":300},{"class":291},[301],{"type":20,"value":302},"// 校验是否国内手机号\n",{"type":14,"tag":32,"props":304,"children":305},{"class":107,"line":228},[306,312,316,321,325,330,335,341,346,350,355],{"type":14,"tag":32,"props":307,"children":309},{"class":308},"ct-984823",[310],{"type":20,"value":311},"export",{"type":14,"tag":32,"props":313,"children":314},{"class":118},[315],{"type":20,"value":121},{"type":14,"tag":32,"props":317,"children":318},{"class":308},[319],{"type":20,"value":320},"function",{"type":14,"tag":32,"props":322,"children":323},{"class":118},[324],{"type":20,"value":121},{"type":14,"tag":32,"props":326,"children":327},{"class":112},[328],{"type":20,"value":329},"regChinesePhoneNumber",{"type":14,"tag":32,"props":331,"children":332},{"class":118},[333],{"type":20,"value":334},"(",{"type":14,"tag":32,"props":336,"children":338},{"class":337},"ct-880416",[339],{"type":20,"value":340},"phoneNumber",{"type":14,"tag":32,"props":342,"children":343},{"class":308},[344],{"type":20,"value":345},":",{"type":14,"tag":32,"props":347,"children":348},{"class":118},[349],{"type":20,"value":121},{"type":14,"tag":32,"props":351,"children":352},{"class":134},[353],{"type":20,"value":354},"string",{"type":14,"tag":32,"props":356,"children":357},{"class":118},[358],{"type":20,"value":359},") {\n",{"type":14,"tag":32,"props":361,"children":362},{"class":107,"line":256},[363,367,372,376,381,385,390,395,400,405,410,415,420],{"type":14,"tag":32,"props":364,"children":365},{"class":118},[366],{"type":20,"value":200},{"type":14,"tag":32,"props":368,"children":369},{"class":308},[370],{"type":20,"value":371},"const",{"type":14,"tag":32,"props":373,"children":374},{"class":118},[375],{"type":20,"value":121},{"type":14,"tag":32,"props":377,"children":378},{"class":134},[379],{"type":20,"value":380},"regex",{"type":14,"tag":32,"props":382,"children":383},{"class":118},[384],{"type":20,"value":121},{"type":14,"tag":32,"props":386,"children":387},{"class":308},[388],{"type":20,"value":389},"=",{"type":14,"tag":32,"props":391,"children":393},{"class":392},"ct-273446",[394],{"type":20,"value":121},{"type":14,"tag":32,"props":396,"children":397},{"class":124},[398],{"type":20,"value":399},"/",{"type":14,"tag":32,"props":401,"children":402},{"class":308},[403],{"type":20,"value":404},"^",{"type":14,"tag":32,"props":406,"children":407},{"class":392},[408],{"type":20,"value":409},"1",{"type":14,"tag":32,"props":411,"children":412},{"class":134},[413],{"type":20,"value":414},"[3456789]\\d",{"type":14,"tag":32,"props":416,"children":417},{"class":308},[418],{"type":20,"value":419},"{9}$",{"type":14,"tag":32,"props":421,"children":422},{"class":124},[423],{"type":20,"value":424},"/\n",{"type":14,"tag":32,"props":426,"children":428},{"class":107,"line":427},5,[429,433,438,443,448],{"type":14,"tag":32,"props":430,"children":431},{"class":118},[432],{"type":20,"value":200},{"type":14,"tag":32,"props":434,"children":435},{"class":308},[436],{"type":20,"value":437},"return",{"type":14,"tag":32,"props":439,"children":440},{"class":118},[441],{"type":20,"value":442}," regex.",{"type":14,"tag":32,"props":444,"children":445},{"class":112},[446],{"type":20,"value":447},"test",{"type":14,"tag":32,"props":449,"children":450},{"class":118},[451],{"type":20,"value":452},"(phoneNumber)\n",{"type":14,"tag":32,"props":454,"children":456},{"class":107,"line":455},6,[457],{"type":14,"tag":32,"props":458,"children":459},{"class":118},[460],{"type":20,"value":461},"}\n",{"type":14,"tag":32,"props":463,"children":465},{"class":107,"line":464},7,[466],{"type":14,"tag":32,"props":467,"children":468},{},[469],{"type":20,"value":470},"\n",{"type":14,"tag":32,"props":472,"children":474},{"class":107,"line":473},8,[475],{"type":14,"tag":32,"props":476,"children":477},{"class":291},[478],{"type":20,"value":479},"/** /reg/phone.test.ts */\n",{"type":14,"tag":32,"props":481,"children":483},{"class":107,"line":482},9,[484,489,494,499,503],{"type":14,"tag":32,"props":485,"children":486},{"class":308},[487],{"type":20,"value":488},"import",{"type":14,"tag":32,"props":490,"children":491},{"class":118},[492],{"type":20,"value":493}," { describe, expect, test } ",{"type":14,"tag":32,"props":495,"children":496},{"class":308},[497],{"type":20,"value":498},"from",{"type":14,"tag":32,"props":500,"children":501},{"class":118},[502],{"type":20,"value":121},{"type":14,"tag":32,"props":504,"children":505},{"class":124},[506],{"type":20,"value":507},"'vitest'\n",{"type":14,"tag":32,"props":509,"children":511},{"class":107,"line":510},10,[512,516,521,525,529],{"type":14,"tag":32,"props":513,"children":514},{"class":308},[515],{"type":20,"value":488},{"type":14,"tag":32,"props":517,"children":518},{"class":118},[519],{"type":20,"value":520}," { regChinesePhoneNumber } ",{"type":14,"tag":32,"props":522,"children":523},{"class":308},[524],{"type":20,"value":498},{"type":14,"tag":32,"props":526,"children":527},{"class":118},[528],{"type":20,"value":121},{"type":14,"tag":32,"props":530,"children":531},{"class":124},[532],{"type":20,"value":533},"'../phone'\n",{"type":14,"tag":32,"props":535,"children":537},{"class":107,"line":536},11,[538],{"type":14,"tag":32,"props":539,"children":540},{},[541],{"type":20,"value":470},{"type":14,"tag":32,"props":543,"children":545},{"class":107,"line":544},12,[546,551,555,560,565,570],{"type":14,"tag":32,"props":547,"children":548},{"class":112},[549],{"type":20,"value":550},"describe",{"type":14,"tag":32,"props":552,"children":553},{"class":118},[554],{"type":20,"value":334},{"type":14,"tag":32,"props":556,"children":557},{"class":124},[558],{"type":20,"value":559},"'phone'",{"type":14,"tag":32,"props":561,"children":562},{"class":118},[563],{"type":20,"value":564},", () ",{"type":14,"tag":32,"props":566,"children":567},{"class":308},[568],{"type":20,"value":569},"=>",{"type":14,"tag":32,"props":571,"children":572},{"class":118},[573],{"type":20,"value":574}," {\n",{"type":14,"tag":32,"props":576,"children":578},{"class":107,"line":577},13,[579,583,587,591,596,600,604],{"type":14,"tag":32,"props":580,"children":581},{"class":118},[582],{"type":20,"value":200},{"type":14,"tag":32,"props":584,"children":585},{"class":112},[586],{"type":20,"value":447},{"type":14,"tag":32,"props":588,"children":589},{"class":118},[590],{"type":20,"value":334},{"type":14,"tag":32,"props":592,"children":593},{"class":124},[594],{"type":20,"value":595},"'phone number belongs to Chinese'",{"type":14,"tag":32,"props":597,"children":598},{"class":118},[599],{"type":20,"value":564},{"type":14,"tag":32,"props":601,"children":602},{"class":308},[603],{"type":20,"value":569},{"type":14,"tag":32,"props":605,"children":606},{"class":118},[607],{"type":20,"value":574},{"type":14,"tag":32,"props":609,"children":611},{"class":107,"line":610},14,[612,616,621,625,629,633,638,643,648,652,657],{"type":14,"tag":32,"props":613,"children":614},{"class":118},[615],{"type":20,"value":219},{"type":14,"tag":32,"props":617,"children":618},{"class":112},[619],{"type":20,"value":620},"expect",{"type":14,"tag":32,"props":622,"children":623},{"class":118},[624],{"type":20,"value":334},{"type":14,"tag":32,"props":626,"children":627},{"class":112},[628],{"type":20,"value":329},{"type":14,"tag":32,"props":630,"children":631},{"class":118},[632],{"type":20,"value":334},{"type":14,"tag":32,"props":634,"children":635},{"class":124},[636],{"type":20,"value":637},"'17725663831'",{"type":14,"tag":32,"props":639,"children":640},{"class":118},[641],{"type":20,"value":642},")).",{"type":14,"tag":32,"props":644,"children":645},{"class":112},[646],{"type":20,"value":647},"toBe",{"type":14,"tag":32,"props":649,"children":650},{"class":118},[651],{"type":20,"value":334},{"type":14,"tag":32,"props":653,"children":654},{"class":134},[655],{"type":20,"value":656},"true",{"type":14,"tag":32,"props":658,"children":659},{"class":118},[660],{"type":20,"value":661},")\n",{"type":14,"tag":32,"props":663,"children":665},{"class":107,"line":664},15,[666],{"type":14,"tag":32,"props":667,"children":668},{"class":118},[669],{"type":20,"value":670},"  })\n",{"type":14,"tag":32,"props":672,"children":674},{"class":107,"line":673},16,[675],{"type":14,"tag":32,"props":676,"children":677},{"class":118},[678],{"type":20,"value":679},"})",{"type":14,"tag":26,"props":681,"children":682},{},[683,685,690,692],{"type":20,"value":684},"输入命令",{"type":14,"tag":159,"props":686,"children":687},{},[688],{"type":20,"value":689},"npm run test:unit",{"type":20,"value":691},", 不出意外你会看到以下内容, 表明测试通过:\n",{"type":14,"tag":693,"props":694,"children":697},"img",{"alt":695,"src":696},"test result","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312071947299.png",[],{"type":14,"tag":26,"props":699,"children":700},{},[701,703,708,710,715,717,722,724,727,729,734,736,739,743,745,750,752,757,759,762,766,768,771,775,777,782],{"type":20,"value":702},"编写测试的代码文件通常放置在",{"type":14,"tag":159,"props":704,"children":705},{},[706],{"type":20,"value":707},"__test__",{"type":20,"value":709},"文件夹中, 命名为",{"type":14,"tag":159,"props":711,"children":712},{},[713],{"type":20,"value":714},"xxx.test.ts",{"type":20,"value":716},"或",{"type":14,"tag":159,"props":718,"children":719},{},[720],{"type":20,"value":721},"xxx.spec.ts",{"type":20,"value":723},", Vitest 会自动运行所有此类命名的文件.",{"type":14,"tag":153,"props":725,"children":726},{},[],{"type":20,"value":728},"\n编写测试的基础是",{"type":14,"tag":159,"props":730,"children":731},{},[732],{"type":20,"value":733},"describe、test、expect",{"type":20,"value":735},"关键字.",{"type":14,"tag":153,"props":737,"children":738},{},[],{"type":14,"tag":159,"props":740,"children":741},{},[742],{"type":20,"value":550},{"type":20,"value":744}," 用于定义一个测试",{"type":14,"tag":159,"props":746,"children":747},{},[748],{"type":20,"value":749},"套件",{"type":20,"value":751},", 套件类似于 js 的模块, 用于将多个 test 封装到一起, 搭配",{"type":14,"tag":159,"props":753,"children":754},{},[755],{"type":20,"value":756},"skip、only",{"type":20,"value":758},"等 api 可以实现选择性测试等功能.",{"type":14,"tag":153,"props":760,"children":761},{},[],{"type":14,"tag":159,"props":763,"children":764},{},[765],{"type":20,"value":447},{"type":20,"value":767}," 用于声明一个测试, 接收测试名称和保存测试期望的函数.",{"type":14,"tag":153,"props":769,"children":770},{},[],{"type":14,"tag":159,"props":772,"children":773},{},[774],{"type":20,"value":620},{"type":20,"value":776}," 用于设置断言, Vitest 默认提供基于",{"type":14,"tag":159,"props":778,"children":779},{},[780],{"type":20,"value":781},"chai",{"type":20,"value":783},"的断言, 你不知道什么是 chai 没关系, 断言是单元测试的关键助手, 后面会详细介绍",{"type":14,"tag":15,"props":785,"children":787},{"id":786},"实践",[788],{"type":20,"value":786},{"type":14,"tag":26,"props":790,"children":791},{},[792],{"type":20,"value":793},"接下来, 我们对几种常见的场景进行单测",{"type":14,"tag":795,"props":796,"children":797},"h2",{"id":53},[798],{"type":20,"value":53},{"type":14,"tag":26,"props":800,"children":801},{},[802,804,807],{"type":20,"value":803},"hooks 是逻辑的封装, 是最需要单测的场景.",{"type":14,"tag":153,"props":805,"children":806},{},[],{"type":20,"value":808},"\n编辑器和表单有一个常见需求是记录上一次更改时间, 我们可以通过几行代码封装一个 hooks.",{"type":14,"tag":91,"props":810,"children":813},{"className":811,"code":812,"language":278,"meta":5},[276],"/** /src/hooks/useLastChange.ts */\nimport { watch, ref, type WatchSource } from 'vue'\nimport moment from 'moment/moment'\n\nexport function useLastChange(source: WatchSource) {\n  const lastChange = ref('')\n\n  watch(source, () => {\n    lastChange.value = moment().format('YYYY-MM-DD HH:mm:ss')\n  })\n\n  return lastChange\n}\n\n/** /src/hooks/__test__/useLastChange.test.ts */\nimport { expect, it } from 'vitest'\nimport { nextTick, ref } from 'vue'\nimport { useLastChange } from '../useLastChange'\n\nit('update lastChange when source changes', async () => {\n  const source = ref('')\n  const lastChange = useLastChange(source)\n  const snapShot01 = lastChange.value\n  source.value = 'Ray'\n  await nextTick()\n  const snapShot02 = lastChange.value\n\n  expect(snapShot01).not.toBe(snapShot02)\n})\n",[814],{"type":14,"tag":99,"props":815,"children":816},{},[817],{"type":14,"tag":91,"props":818,"children":819},{"__ignoreMap":5},[820,828,863,888,895,945,995,1002,1027,1071,1078,1085,1101,1108,1115,1123,1147,1172,1198,1206,1247,1295,1336,1370,1392,1419,1452,1460,1486],{"type":14,"tag":32,"props":821,"children":822},{"class":107,"line":108},[823],{"type":14,"tag":32,"props":824,"children":825},{"class":291},[826],{"type":20,"value":827},"/** /src/hooks/useLastChange.ts */\n",{"type":14,"tag":32,"props":829,"children":830},{"class":107,"line":213},[831,835,840,845,850,854,858],{"type":14,"tag":32,"props":832,"children":833},{"class":308},[834],{"type":20,"value":488},{"type":14,"tag":32,"props":836,"children":837},{"class":118},[838],{"type":20,"value":839}," { watch, ref, ",{"type":14,"tag":32,"props":841,"children":842},{"class":308},[843],{"type":20,"value":844},"type",{"type":14,"tag":32,"props":846,"children":847},{"class":118},[848],{"type":20,"value":849}," WatchSource } ",{"type":14,"tag":32,"props":851,"children":852},{"class":308},[853],{"type":20,"value":498},{"type":14,"tag":32,"props":855,"children":856},{"class":118},[857],{"type":20,"value":121},{"type":14,"tag":32,"props":859,"children":860},{"class":124},[861],{"type":20,"value":862},"'vue'\n",{"type":14,"tag":32,"props":864,"children":865},{"class":107,"line":228},[866,870,875,879,883],{"type":14,"tag":32,"props":867,"children":868},{"class":308},[869],{"type":20,"value":488},{"type":14,"tag":32,"props":871,"children":872},{"class":118},[873],{"type":20,"value":874}," moment ",{"type":14,"tag":32,"props":876,"children":877},{"class":308},[878],{"type":20,"value":498},{"type":14,"tag":32,"props":880,"children":881},{"class":118},[882],{"type":20,"value":121},{"type":14,"tag":32,"props":884,"children":885},{"class":124},[886],{"type":20,"value":887},"'moment/moment'\n",{"type":14,"tag":32,"props":889,"children":890},{"class":107,"line":256},[891],{"type":14,"tag":32,"props":892,"children":893},{},[894],{"type":20,"value":470},{"type":14,"tag":32,"props":896,"children":897},{"class":107,"line":427},[898,902,906,910,914,919,923,928,932,936,941],{"type":14,"tag":32,"props":899,"children":900},{"class":308},[901],{"type":20,"value":311},{"type":14,"tag":32,"props":903,"children":904},{"class":118},[905],{"type":20,"value":121},{"type":14,"tag":32,"props":907,"children":908},{"class":308},[909],{"type":20,"value":320},{"type":14,"tag":32,"props":911,"children":912},{"class":118},[913],{"type":20,"value":121},{"type":14,"tag":32,"props":915,"children":916},{"class":112},[917],{"type":20,"value":918},"useLastChange",{"type":14,"tag":32,"props":920,"children":921},{"class":118},[922],{"type":20,"value":334},{"type":14,"tag":32,"props":924,"children":925},{"class":337},[926],{"type":20,"value":927},"source",{"type":14,"tag":32,"props":929,"children":930},{"class":308},[931],{"type":20,"value":345},{"type":14,"tag":32,"props":933,"children":934},{"class":118},[935],{"type":20,"value":121},{"type":14,"tag":32,"props":937,"children":938},{"class":112},[939],{"type":20,"value":940},"WatchSource",{"type":14,"tag":32,"props":942,"children":943},{"class":118},[944],{"type":20,"value":359},{"type":14,"tag":32,"props":946,"children":947},{"class":107,"line":455},[948,952,956,960,965,969,973,977,982,986,991],{"type":14,"tag":32,"props":949,"children":950},{"class":118},[951],{"type":20,"value":200},{"type":14,"tag":32,"props":953,"children":954},{"class":308},[955],{"type":20,"value":371},{"type":14,"tag":32,"props":957,"children":958},{"class":118},[959],{"type":20,"value":121},{"type":14,"tag":32,"props":961,"children":962},{"class":134},[963],{"type":20,"value":964},"lastChange",{"type":14,"tag":32,"props":966,"children":967},{"class":118},[968],{"type":20,"value":121},{"type":14,"tag":32,"props":970,"children":971},{"class":308},[972],{"type":20,"value":389},{"type":14,"tag":32,"props":974,"children":975},{"class":118},[976],{"type":20,"value":121},{"type":14,"tag":32,"props":978,"children":979},{"class":112},[980],{"type":20,"value":981},"ref",{"type":14,"tag":32,"props":983,"children":984},{"class":118},[985],{"type":20,"value":334},{"type":14,"tag":32,"props":987,"children":988},{"class":124},[989],{"type":20,"value":990},"''",{"type":14,"tag":32,"props":992,"children":993},{"class":118},[994],{"type":20,"value":661},{"type":14,"tag":32,"props":996,"children":997},{"class":107,"line":464},[998],{"type":14,"tag":32,"props":999,"children":1000},{},[1001],{"type":20,"value":470},{"type":14,"tag":32,"props":1003,"children":1004},{"class":107,"line":473},[1005,1009,1014,1019,1023],{"type":14,"tag":32,"props":1006,"children":1007},{"class":118},[1008],{"type":20,"value":200},{"type":14,"tag":32,"props":1010,"children":1011},{"class":112},[1012],{"type":20,"value":1013},"watch",{"type":14,"tag":32,"props":1015,"children":1016},{"class":118},[1017],{"type":20,"value":1018},"(source, () ",{"type":14,"tag":32,"props":1020,"children":1021},{"class":308},[1022],{"type":20,"value":569},{"type":14,"tag":32,"props":1024,"children":1025},{"class":118},[1026],{"type":20,"value":574},{"type":14,"tag":32,"props":1028,"children":1029},{"class":107,"line":482},[1030,1035,1039,1043,1048,1053,1058,1062,1067],{"type":14,"tag":32,"props":1031,"children":1032},{"class":118},[1033],{"type":20,"value":1034},"    lastChange.value ",{"type":14,"tag":32,"props":1036,"children":1037},{"class":308},[1038],{"type":20,"value":389},{"type":14,"tag":32,"props":1040,"children":1041},{"class":118},[1042],{"type":20,"value":121},{"type":14,"tag":32,"props":1044,"children":1045},{"class":112},[1046],{"type":20,"value":1047},"moment",{"type":14,"tag":32,"props":1049,"children":1050},{"class":118},[1051],{"type":20,"value":1052},"().",{"type":14,"tag":32,"props":1054,"children":1055},{"class":112},[1056],{"type":20,"value":1057},"format",{"type":14,"tag":32,"props":1059,"children":1060},{"class":118},[1061],{"type":20,"value":334},{"type":14,"tag":32,"props":1063,"children":1064},{"class":124},[1065],{"type":20,"value":1066},"'YYYY-MM-DD HH:mm:ss'",{"type":14,"tag":32,"props":1068,"children":1069},{"class":118},[1070],{"type":20,"value":661},{"type":14,"tag":32,"props":1072,"children":1073},{"class":107,"line":510},[1074],{"type":14,"tag":32,"props":1075,"children":1076},{"class":118},[1077],{"type":20,"value":670},{"type":14,"tag":32,"props":1079,"children":1080},{"class":107,"line":536},[1081],{"type":14,"tag":32,"props":1082,"children":1083},{},[1084],{"type":20,"value":470},{"type":14,"tag":32,"props":1086,"children":1087},{"class":107,"line":544},[1088,1092,1096],{"type":14,"tag":32,"props":1089,"children":1090},{"class":118},[1091],{"type":20,"value":200},{"type":14,"tag":32,"props":1093,"children":1094},{"class":308},[1095],{"type":20,"value":437},{"type":14,"tag":32,"props":1097,"children":1098},{"class":118},[1099],{"type":20,"value":1100}," lastChange\n",{"type":14,"tag":32,"props":1102,"children":1103},{"class":107,"line":577},[1104],{"type":14,"tag":32,"props":1105,"children":1106},{"class":118},[1107],{"type":20,"value":461},{"type":14,"tag":32,"props":1109,"children":1110},{"class":107,"line":610},[1111],{"type":14,"tag":32,"props":1112,"children":1113},{},[1114],{"type":20,"value":470},{"type":14,"tag":32,"props":1116,"children":1117},{"class":107,"line":664},[1118],{"type":14,"tag":32,"props":1119,"children":1120},{"class":291},[1121],{"type":20,"value":1122},"/** /src/hooks/__test__/useLastChange.test.ts */\n",{"type":14,"tag":32,"props":1124,"children":1125},{"class":107,"line":673},[1126,1130,1135,1139,1143],{"type":14,"tag":32,"props":1127,"children":1128},{"class":308},[1129],{"type":20,"value":488},{"type":14,"tag":32,"props":1131,"children":1132},{"class":118},[1133],{"type":20,"value":1134}," { expect, it } ",{"type":14,"tag":32,"props":1136,"children":1137},{"class":308},[1138],{"type":20,"value":498},{"type":14,"tag":32,"props":1140,"children":1141},{"class":118},[1142],{"type":20,"value":121},{"type":14,"tag":32,"props":1144,"children":1145},{"class":124},[1146],{"type":20,"value":507},{"type":14,"tag":32,"props":1148,"children":1150},{"class":107,"line":1149},17,[1151,1155,1160,1164,1168],{"type":14,"tag":32,"props":1152,"children":1153},{"class":308},[1154],{"type":20,"value":488},{"type":14,"tag":32,"props":1156,"children":1157},{"class":118},[1158],{"type":20,"value":1159}," { nextTick, ref } ",{"type":14,"tag":32,"props":1161,"children":1162},{"class":308},[1163],{"type":20,"value":498},{"type":14,"tag":32,"props":1165,"children":1166},{"class":118},[1167],{"type":20,"value":121},{"type":14,"tag":32,"props":1169,"children":1170},{"class":124},[1171],{"type":20,"value":862},{"type":14,"tag":32,"props":1173,"children":1175},{"class":107,"line":1174},18,[1176,1180,1185,1189,1193],{"type":14,"tag":32,"props":1177,"children":1178},{"class":308},[1179],{"type":20,"value":488},{"type":14,"tag":32,"props":1181,"children":1182},{"class":118},[1183],{"type":20,"value":1184}," { useLastChange } ",{"type":14,"tag":32,"props":1186,"children":1187},{"class":308},[1188],{"type":20,"value":498},{"type":14,"tag":32,"props":1190,"children":1191},{"class":118},[1192],{"type":20,"value":121},{"type":14,"tag":32,"props":1194,"children":1195},{"class":124},[1196],{"type":20,"value":1197},"'../useLastChange'\n",{"type":14,"tag":32,"props":1199,"children":1201},{"class":107,"line":1200},19,[1202],{"type":14,"tag":32,"props":1203,"children":1204},{},[1205],{"type":20,"value":470},{"type":14,"tag":32,"props":1207,"children":1209},{"class":107,"line":1208},20,[1210,1215,1219,1224,1229,1234,1239,1243],{"type":14,"tag":32,"props":1211,"children":1212},{"class":112},[1213],{"type":20,"value":1214},"it",{"type":14,"tag":32,"props":1216,"children":1217},{"class":118},[1218],{"type":20,"value":334},{"type":14,"tag":32,"props":1220,"children":1221},{"class":124},[1222],{"type":20,"value":1223},"'update lastChange when source changes'",{"type":14,"tag":32,"props":1225,"children":1226},{"class":118},[1227],{"type":20,"value":1228},", ",{"type":14,"tag":32,"props":1230,"children":1231},{"class":308},[1232],{"type":20,"value":1233},"async",{"type":14,"tag":32,"props":1235,"children":1236},{"class":118},[1237],{"type":20,"value":1238}," () ",{"type":14,"tag":32,"props":1240,"children":1241},{"class":308},[1242],{"type":20,"value":569},{"type":14,"tag":32,"props":1244,"children":1245},{"class":118},[1246],{"type":20,"value":574},{"type":14,"tag":32,"props":1248,"children":1250},{"class":107,"line":1249},21,[1251,1255,1259,1263,1267,1271,1275,1279,1283,1287,1291],{"type":14,"tag":32,"props":1252,"children":1253},{"class":118},[1254],{"type":20,"value":200},{"type":14,"tag":32,"props":1256,"children":1257},{"class":308},[1258],{"type":20,"value":371},{"type":14,"tag":32,"props":1260,"children":1261},{"class":118},[1262],{"type":20,"value":121},{"type":14,"tag":32,"props":1264,"children":1265},{"class":134},[1266],{"type":20,"value":927},{"type":14,"tag":32,"props":1268,"children":1269},{"class":118},[1270],{"type":20,"value":121},{"type":14,"tag":32,"props":1272,"children":1273},{"class":308},[1274],{"type":20,"value":389},{"type":14,"tag":32,"props":1276,"children":1277},{"class":118},[1278],{"type":20,"value":121},{"type":14,"tag":32,"props":1280,"children":1281},{"class":112},[1282],{"type":20,"value":981},{"type":14,"tag":32,"props":1284,"children":1285},{"class":118},[1286],{"type":20,"value":334},{"type":14,"tag":32,"props":1288,"children":1289},{"class":124},[1290],{"type":20,"value":990},{"type":14,"tag":32,"props":1292,"children":1293},{"class":118},[1294],{"type":20,"value":661},{"type":14,"tag":32,"props":1296,"children":1298},{"class":107,"line":1297},22,[1299,1303,1307,1311,1315,1319,1323,1327,1331],{"type":14,"tag":32,"props":1300,"children":1301},{"class":118},[1302],{"type":20,"value":200},{"type":14,"tag":32,"props":1304,"children":1305},{"class":308},[1306],{"type":20,"value":371},{"type":14,"tag":32,"props":1308,"children":1309},{"class":118},[1310],{"type":20,"value":121},{"type":14,"tag":32,"props":1312,"children":1313},{"class":134},[1314],{"type":20,"value":964},{"type":14,"tag":32,"props":1316,"children":1317},{"class":118},[1318],{"type":20,"value":121},{"type":14,"tag":32,"props":1320,"children":1321},{"class":308},[1322],{"type":20,"value":389},{"type":14,"tag":32,"props":1324,"children":1325},{"class":118},[1326],{"type":20,"value":121},{"type":14,"tag":32,"props":1328,"children":1329},{"class":112},[1330],{"type":20,"value":918},{"type":14,"tag":32,"props":1332,"children":1333},{"class":118},[1334],{"type":20,"value":1335},"(source)\n",{"type":14,"tag":32,"props":1337,"children":1339},{"class":107,"line":1338},23,[1340,1344,1348,1352,1357,1361,1365],{"type":14,"tag":32,"props":1341,"children":1342},{"class":118},[1343],{"type":20,"value":200},{"type":14,"tag":32,"props":1345,"children":1346},{"class":308},[1347],{"type":20,"value":371},{"type":14,"tag":32,"props":1349,"children":1350},{"class":118},[1351],{"type":20,"value":121},{"type":14,"tag":32,"props":1353,"children":1354},{"class":134},[1355],{"type":20,"value":1356},"snapShot01",{"type":14,"tag":32,"props":1358,"children":1359},{"class":118},[1360],{"type":20,"value":121},{"type":14,"tag":32,"props":1362,"children":1363},{"class":308},[1364],{"type":20,"value":389},{"type":14,"tag":32,"props":1366,"children":1367},{"class":118},[1368],{"type":20,"value":1369}," lastChange.value\n",{"type":14,"tag":32,"props":1371,"children":1373},{"class":107,"line":1372},24,[1374,1379,1383,1387],{"type":14,"tag":32,"props":1375,"children":1376},{"class":118},[1377],{"type":20,"value":1378},"  source.value ",{"type":14,"tag":32,"props":1380,"children":1381},{"class":308},[1382],{"type":20,"value":389},{"type":14,"tag":32,"props":1384,"children":1385},{"class":118},[1386],{"type":20,"value":121},{"type":14,"tag":32,"props":1388,"children":1389},{"class":124},[1390],{"type":20,"value":1391},"'Ray'\n",{"type":14,"tag":32,"props":1393,"children":1395},{"class":107,"line":1394},25,[1396,1400,1405,1409,1414],{"type":14,"tag":32,"props":1397,"children":1398},{"class":118},[1399],{"type":20,"value":200},{"type":14,"tag":32,"props":1401,"children":1402},{"class":308},[1403],{"type":20,"value":1404},"await",{"type":14,"tag":32,"props":1406,"children":1407},{"class":118},[1408],{"type":20,"value":121},{"type":14,"tag":32,"props":1410,"children":1411},{"class":112},[1412],{"type":20,"value":1413},"nextTick",{"type":14,"tag":32,"props":1415,"children":1416},{"class":118},[1417],{"type":20,"value":1418},"()\n",{"type":14,"tag":32,"props":1420,"children":1422},{"class":107,"line":1421},26,[1423,1427,1431,1435,1440,1444,1448],{"type":14,"tag":32,"props":1424,"children":1425},{"class":118},[1426],{"type":20,"value":200},{"type":14,"tag":32,"props":1428,"children":1429},{"class":308},[1430],{"type":20,"value":371},{"type":14,"tag":32,"props":1432,"children":1433},{"class":118},[1434],{"type":20,"value":121},{"type":14,"tag":32,"props":1436,"children":1437},{"class":134},[1438],{"type":20,"value":1439},"snapShot02",{"type":14,"tag":32,"props":1441,"children":1442},{"class":118},[1443],{"type":20,"value":121},{"type":14,"tag":32,"props":1445,"children":1446},{"class":308},[1447],{"type":20,"value":389},{"type":14,"tag":32,"props":1449,"children":1450},{"class":118},[1451],{"type":20,"value":1369},{"type":14,"tag":32,"props":1453,"children":1455},{"class":107,"line":1454},27,[1456],{"type":14,"tag":32,"props":1457,"children":1458},{},[1459],{"type":20,"value":470},{"type":14,"tag":32,"props":1461,"children":1463},{"class":107,"line":1462},28,[1464,1468,1472,1477,1481],{"type":14,"tag":32,"props":1465,"children":1466},{"class":118},[1467],{"type":20,"value":200},{"type":14,"tag":32,"props":1469,"children":1470},{"class":112},[1471],{"type":20,"value":620},{"type":14,"tag":32,"props":1473,"children":1474},{"class":118},[1475],{"type":20,"value":1476},"(snapShot01).not.",{"type":14,"tag":32,"props":1478,"children":1479},{"class":112},[1480],{"type":20,"value":647},{"type":14,"tag":32,"props":1482,"children":1483},{"class":118},[1484],{"type":20,"value":1485},"(snapShot02)\n",{"type":14,"tag":32,"props":1487,"children":1489},{"class":107,"line":1488},29,[1490],{"type":14,"tag":32,"props":1491,"children":1492},{"class":118},[1493],{"type":20,"value":679},{"type":14,"tag":26,"props":1495,"children":1496},{},[1497],{"type":20,"value":1498},"hooks 的测试比较简单, 就是执行后比对结果. utils 和 reg 也是类似, 此处略过.",{"type":14,"tag":795,"props":1500,"children":1502},{"id":1501},"scaffold",[1503],{"type":20,"value":1501},{"type":14,"tag":26,"props":1505,"children":1506},{},[1507,1509,1512,1514,1517],{"type":20,"value":1508},"脚手架一般是框架自身提供的命令行工具, 用于生成模板代码, 放置于 bin 目录.",{"type":14,"tag":153,"props":1510,"children":1511},{},[],{"type":20,"value":1513},"\nVue 和 React 自身只提供了创建项目工具, 没有提供类似 Rails Command Line 的项目搭建工具. 因此前端spa项目的脚手架都是自己针对常见业务场景的封装.",{"type":14,"tag":153,"props":1515,"children":1516},{},[],{"type":20,"value":1518},"\n脚手架一般通过 npm 命令执行, 在 package.json 中添加一条命令",{"type":14,"tag":91,"props":1520,"children":1523},{"className":1521,"code":1522,"language":185,"meta":5},[183],"\"create\": \"node ./bin/create.js --type=$npm_config_type --path=$npm_config_path\n",[1524],{"type":14,"tag":99,"props":1525,"children":1526},{},[1527],{"type":14,"tag":91,"props":1528,"children":1529},{"__ignoreMap":5},[1530],{"type":14,"tag":32,"props":1531,"children":1532},{"class":107,"line":108},[1533,1538,1542],{"type":14,"tag":32,"props":1534,"children":1535},{"class":124},[1536],{"type":20,"value":1537},"\"create\"",{"type":14,"tag":32,"props":1539,"children":1540},{"class":118},[1541],{"type":20,"value":243},{"type":14,"tag":32,"props":1543,"children":1544},{"class":124},[1545],{"type":20,"value":1546},"\"node ./bin/create.js --type=$npm_config_type --path=$npm_config_path",{"type":14,"tag":26,"props":1548,"children":1549},{},[1550,1552,1557,1559,1562],{"type":20,"value":1551},"运行",{"type":14,"tag":159,"props":1553,"children":1554},{},[1555],{"type":20,"value":1556},"npm run create --type=table --path='/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/views/TestTable.vue' ",{"type":20,"value":1558},", 就会执行 /bin/index 脚本中的内容并将 type 和 path 值作为参数传递.",{"type":14,"tag":153,"props":1560,"children":1561},{},[],{"type":20,"value":1563},"\n编写 create 脚本:",{"type":14,"tag":91,"props":1565,"children":1570},{"className":1566,"code":1568,"language":1569,"meta":5},[1567],"language-js","/** /src/bin/create.js */\nimport minimist from 'minimist'\nimport { readFileSync, writeFileSync } from 'fs'\n\nfunction main() {\n  // 使用 minimist 处理参数\n  const args = minimist(process.argv.slice(2))\n  const { type, path } = args\n  let temp = ''\n  if(type === 'table') {\n    temp = readFileSync('./src/bin/dist/table', 'utf-8') \n  }\n  writeFileSync(path, temp)\n  console.log('\\n创建完成')\n}\n\nmain()\n","js",[1571],{"type":14,"tag":99,"props":1572,"children":1573},{},[1574],{"type":14,"tag":91,"props":1575,"children":1576},{"__ignoreMap":5},[1577,1585,1610,1635,1642,1663,1675,1736,1779,1809,1844,1888,1896,1913,1949,1956,1963],{"type":14,"tag":32,"props":1578,"children":1579},{"class":107,"line":108},[1580],{"type":14,"tag":32,"props":1581,"children":1582},{"class":291},[1583],{"type":20,"value":1584},"/** /src/bin/create.js */\n",{"type":14,"tag":32,"props":1586,"children":1587},{"class":107,"line":213},[1588,1592,1597,1601,1605],{"type":14,"tag":32,"props":1589,"children":1590},{"class":308},[1591],{"type":20,"value":488},{"type":14,"tag":32,"props":1593,"children":1594},{"class":118},[1595],{"type":20,"value":1596}," minimist ",{"type":14,"tag":32,"props":1598,"children":1599},{"class":308},[1600],{"type":20,"value":498},{"type":14,"tag":32,"props":1602,"children":1603},{"class":118},[1604],{"type":20,"value":121},{"type":14,"tag":32,"props":1606,"children":1607},{"class":124},[1608],{"type":20,"value":1609},"'minimist'\n",{"type":14,"tag":32,"props":1611,"children":1612},{"class":107,"line":228},[1613,1617,1622,1626,1630],{"type":14,"tag":32,"props":1614,"children":1615},{"class":308},[1616],{"type":20,"value":488},{"type":14,"tag":32,"props":1618,"children":1619},{"class":118},[1620],{"type":20,"value":1621}," { readFileSync, writeFileSync } ",{"type":14,"tag":32,"props":1623,"children":1624},{"class":308},[1625],{"type":20,"value":498},{"type":14,"tag":32,"props":1627,"children":1628},{"class":118},[1629],{"type":20,"value":121},{"type":14,"tag":32,"props":1631,"children":1632},{"class":124},[1633],{"type":20,"value":1634},"'fs'\n",{"type":14,"tag":32,"props":1636,"children":1637},{"class":107,"line":256},[1638],{"type":14,"tag":32,"props":1639,"children":1640},{},[1641],{"type":20,"value":470},{"type":14,"tag":32,"props":1643,"children":1644},{"class":107,"line":427},[1645,1649,1653,1658],{"type":14,"tag":32,"props":1646,"children":1647},{"class":308},[1648],{"type":20,"value":320},{"type":14,"tag":32,"props":1650,"children":1651},{"class":118},[1652],{"type":20,"value":121},{"type":14,"tag":32,"props":1654,"children":1655},{"class":112},[1656],{"type":20,"value":1657},"main",{"type":14,"tag":32,"props":1659,"children":1660},{"class":118},[1661],{"type":20,"value":1662},"() {\n",{"type":14,"tag":32,"props":1664,"children":1665},{"class":107,"line":455},[1666,1670],{"type":14,"tag":32,"props":1667,"children":1668},{"class":118},[1669],{"type":20,"value":200},{"type":14,"tag":32,"props":1671,"children":1672},{"class":291},[1673],{"type":20,"value":1674},"// 使用 minimist 处理参数\n",{"type":14,"tag":32,"props":1676,"children":1677},{"class":107,"line":464},[1678,1682,1686,1690,1695,1699,1703,1707,1712,1717,1722,1726,1731],{"type":14,"tag":32,"props":1679,"children":1680},{"class":118},[1681],{"type":20,"value":200},{"type":14,"tag":32,"props":1683,"children":1684},{"class":308},[1685],{"type":20,"value":371},{"type":14,"tag":32,"props":1687,"children":1688},{"class":118},[1689],{"type":20,"value":121},{"type":14,"tag":32,"props":1691,"children":1692},{"class":134},[1693],{"type":20,"value":1694},"args",{"type":14,"tag":32,"props":1696,"children":1697},{"class":118},[1698],{"type":20,"value":121},{"type":14,"tag":32,"props":1700,"children":1701},{"class":308},[1702],{"type":20,"value":389},{"type":14,"tag":32,"props":1704,"children":1705},{"class":118},[1706],{"type":20,"value":121},{"type":14,"tag":32,"props":1708,"children":1709},{"class":112},[1710],{"type":20,"value":1711},"minimist",{"type":14,"tag":32,"props":1713,"children":1714},{"class":118},[1715],{"type":20,"value":1716},"(process.argv.",{"type":14,"tag":32,"props":1718,"children":1719},{"class":112},[1720],{"type":20,"value":1721},"slice",{"type":14,"tag":32,"props":1723,"children":1724},{"class":118},[1725],{"type":20,"value":334},{"type":14,"tag":32,"props":1727,"children":1728},{"class":134},[1729],{"type":20,"value":1730},"2",{"type":14,"tag":32,"props":1732,"children":1733},{"class":118},[1734],{"type":20,"value":1735},"))\n",{"type":14,"tag":32,"props":1737,"children":1738},{"class":107,"line":473},[1739,1743,1747,1752,1756,1760,1765,1770,1774],{"type":14,"tag":32,"props":1740,"children":1741},{"class":118},[1742],{"type":20,"value":200},{"type":14,"tag":32,"props":1744,"children":1745},{"class":308},[1746],{"type":20,"value":371},{"type":14,"tag":32,"props":1748,"children":1749},{"class":118},[1750],{"type":20,"value":1751}," { ",{"type":14,"tag":32,"props":1753,"children":1754},{"class":134},[1755],{"type":20,"value":844},{"type":14,"tag":32,"props":1757,"children":1758},{"class":118},[1759],{"type":20,"value":1228},{"type":14,"tag":32,"props":1761,"children":1762},{"class":134},[1763],{"type":20,"value":1764},"path",{"type":14,"tag":32,"props":1766,"children":1767},{"class":118},[1768],{"type":20,"value":1769}," } ",{"type":14,"tag":32,"props":1771,"children":1772},{"class":308},[1773],{"type":20,"value":389},{"type":14,"tag":32,"props":1775,"children":1776},{"class":118},[1777],{"type":20,"value":1778}," args\n",{"type":14,"tag":32,"props":1780,"children":1781},{"class":107,"line":482},[1782,1786,1791,1796,1800,1804],{"type":14,"tag":32,"props":1783,"children":1784},{"class":118},[1785],{"type":20,"value":200},{"type":14,"tag":32,"props":1787,"children":1788},{"class":308},[1789],{"type":20,"value":1790},"let",{"type":14,"tag":32,"props":1792,"children":1793},{"class":118},[1794],{"type":20,"value":1795}," temp ",{"type":14,"tag":32,"props":1797,"children":1798},{"class":308},[1799],{"type":20,"value":389},{"type":14,"tag":32,"props":1801,"children":1802},{"class":118},[1803],{"type":20,"value":121},{"type":14,"tag":32,"props":1805,"children":1806},{"class":124},[1807],{"type":20,"value":1808},"''\n",{"type":14,"tag":32,"props":1810,"children":1811},{"class":107,"line":510},[1812,1816,1821,1826,1831,1835,1840],{"type":14,"tag":32,"props":1813,"children":1814},{"class":118},[1815],{"type":20,"value":200},{"type":14,"tag":32,"props":1817,"children":1818},{"class":308},[1819],{"type":20,"value":1820},"if",{"type":14,"tag":32,"props":1822,"children":1823},{"class":118},[1824],{"type":20,"value":1825},"(type ",{"type":14,"tag":32,"props":1827,"children":1828},{"class":308},[1829],{"type":20,"value":1830},"===",{"type":14,"tag":32,"props":1832,"children":1833},{"class":118},[1834],{"type":20,"value":121},{"type":14,"tag":32,"props":1836,"children":1837},{"class":124},[1838],{"type":20,"value":1839},"'table'",{"type":14,"tag":32,"props":1841,"children":1842},{"class":118},[1843],{"type":20,"value":359},{"type":14,"tag":32,"props":1845,"children":1846},{"class":107,"line":536},[1847,1852,1856,1860,1865,1869,1874,1878,1883],{"type":14,"tag":32,"props":1848,"children":1849},{"class":118},[1850],{"type":20,"value":1851},"    temp ",{"type":14,"tag":32,"props":1853,"children":1854},{"class":308},[1855],{"type":20,"value":389},{"type":14,"tag":32,"props":1857,"children":1858},{"class":118},[1859],{"type":20,"value":121},{"type":14,"tag":32,"props":1861,"children":1862},{"class":112},[1863],{"type":20,"value":1864},"readFileSync",{"type":14,"tag":32,"props":1866,"children":1867},{"class":118},[1868],{"type":20,"value":334},{"type":14,"tag":32,"props":1870,"children":1871},{"class":124},[1872],{"type":20,"value":1873},"'./src/bin/dist/table'",{"type":14,"tag":32,"props":1875,"children":1876},{"class":118},[1877],{"type":20,"value":1228},{"type":14,"tag":32,"props":1879,"children":1880},{"class":124},[1881],{"type":20,"value":1882},"'utf-8'",{"type":14,"tag":32,"props":1884,"children":1885},{"class":118},[1886],{"type":20,"value":1887},") \n",{"type":14,"tag":32,"props":1889,"children":1890},{"class":107,"line":544},[1891],{"type":14,"tag":32,"props":1892,"children":1893},{"class":118},[1894],{"type":20,"value":1895},"  }\n",{"type":14,"tag":32,"props":1897,"children":1898},{"class":107,"line":577},[1899,1903,1908],{"type":14,"tag":32,"props":1900,"children":1901},{"class":118},[1902],{"type":20,"value":200},{"type":14,"tag":32,"props":1904,"children":1905},{"class":112},[1906],{"type":20,"value":1907},"writeFileSync",{"type":14,"tag":32,"props":1909,"children":1910},{"class":118},[1911],{"type":20,"value":1912},"(path, temp)\n",{"type":14,"tag":32,"props":1914,"children":1915},{"class":107,"line":610},[1916,1921,1926,1930,1935,1940,1945],{"type":14,"tag":32,"props":1917,"children":1918},{"class":118},[1919],{"type":20,"value":1920},"  console.",{"type":14,"tag":32,"props":1922,"children":1923},{"class":112},[1924],{"type":20,"value":1925},"log",{"type":14,"tag":32,"props":1927,"children":1928},{"class":118},[1929],{"type":20,"value":334},{"type":14,"tag":32,"props":1931,"children":1932},{"class":124},[1933],{"type":20,"value":1934},"'",{"type":14,"tag":32,"props":1936,"children":1937},{"class":134},[1938],{"type":20,"value":1939},"\\n",{"type":14,"tag":32,"props":1941,"children":1942},{"class":124},[1943],{"type":20,"value":1944},"创建完成'",{"type":14,"tag":32,"props":1946,"children":1947},{"class":118},[1948],{"type":20,"value":661},{"type":14,"tag":32,"props":1950,"children":1951},{"class":107,"line":664},[1952],{"type":14,"tag":32,"props":1953,"children":1954},{"class":118},[1955],{"type":20,"value":461},{"type":14,"tag":32,"props":1957,"children":1958},{"class":107,"line":673},[1959],{"type":14,"tag":32,"props":1960,"children":1961},{},[1962],{"type":20,"value":470},{"type":14,"tag":32,"props":1964,"children":1965},{"class":107,"line":1149},[1966,1970],{"type":14,"tag":32,"props":1967,"children":1968},{"class":112},[1969],{"type":20,"value":1657},{"type":14,"tag":32,"props":1971,"children":1972},{"class":118},[1973],{"type":20,"value":1974},"()",{"type":14,"tag":26,"props":1976,"children":1977},{},[1978,1980,1983],{"type":20,"value":1979},"脚手架其实只进行 3 个操作, 获取参数, 读取对应的模板, 创建目标文件.",{"type":14,"tag":153,"props":1981,"children":1982},{},[],{"type":20,"value":1984},"\nvitest 和 jest 并没有比较好的执行 npm 命令的方法, 因此我们要对上面的方法稍加改造:",{"type":14,"tag":91,"props":1986,"children":1989},{"className":1987,"code":1988,"language":1569,"meta":5},[1567],"/** /src/bin/create.js */\nimport { readFileSync, writeFileSync } from 'fs'\n\nfunction create(args) {\n  const { type, path } = args\n  let temp = ''\n  if(type === 'table') {\n    temp = readFileSync('./src/bin/dist/table', 'utf-8') \n  } else {\n    throw '当前仅支持生成 table 类型'\n  }\n  writeFileSync(path, temp)\n  console.log('\\n创建完成')\n}\n\nexport default create\n\n/** /src/bin/index.js */\nimport create from './create'\n\n// 使用 minimist 处理参数\nconst args = minimist(process.argv.slice(2))\ntry {\n  create(args)\n} catch(e) {\n  console.log(e)\n}\n",[1990],{"type":14,"tag":99,"props":1991,"children":1992},{},[1993],{"type":14,"tag":91,"props":1994,"children":1995},{"__ignoreMap":5},[1996,2003,2026,2033,2061,2100,2127,2158,2197,2214,2235,2242,2257,2288,2295,2302,2323,2330,2338,2363,2370,2377,2428,2440,2456,2474,2490],{"type":14,"tag":32,"props":1997,"children":1998},{"class":107,"line":108},[1999],{"type":14,"tag":32,"props":2000,"children":2001},{"class":291},[2002],{"type":20,"value":1584},{"type":14,"tag":32,"props":2004,"children":2005},{"class":107,"line":213},[2006,2010,2014,2018,2022],{"type":14,"tag":32,"props":2007,"children":2008},{"class":308},[2009],{"type":20,"value":488},{"type":14,"tag":32,"props":2011,"children":2012},{"class":118},[2013],{"type":20,"value":1621},{"type":14,"tag":32,"props":2015,"children":2016},{"class":308},[2017],{"type":20,"value":498},{"type":14,"tag":32,"props":2019,"children":2020},{"class":118},[2021],{"type":20,"value":121},{"type":14,"tag":32,"props":2023,"children":2024},{"class":124},[2025],{"type":20,"value":1634},{"type":14,"tag":32,"props":2027,"children":2028},{"class":107,"line":228},[2029],{"type":14,"tag":32,"props":2030,"children":2031},{},[2032],{"type":20,"value":470},{"type":14,"tag":32,"props":2034,"children":2035},{"class":107,"line":256},[2036,2040,2044,2049,2053,2057],{"type":14,"tag":32,"props":2037,"children":2038},{"class":308},[2039],{"type":20,"value":320},{"type":14,"tag":32,"props":2041,"children":2042},{"class":118},[2043],{"type":20,"value":121},{"type":14,"tag":32,"props":2045,"children":2046},{"class":112},[2047],{"type":20,"value":2048},"create",{"type":14,"tag":32,"props":2050,"children":2051},{"class":118},[2052],{"type":20,"value":334},{"type":14,"tag":32,"props":2054,"children":2055},{"class":337},[2056],{"type":20,"value":1694},{"type":14,"tag":32,"props":2058,"children":2059},{"class":118},[2060],{"type":20,"value":359},{"type":14,"tag":32,"props":2062,"children":2063},{"class":107,"line":427},[2064,2068,2072,2076,2080,2084,2088,2092,2096],{"type":14,"tag":32,"props":2065,"children":2066},{"class":118},[2067],{"type":20,"value":200},{"type":14,"tag":32,"props":2069,"children":2070},{"class":308},[2071],{"type":20,"value":371},{"type":14,"tag":32,"props":2073,"children":2074},{"class":118},[2075],{"type":20,"value":1751},{"type":14,"tag":32,"props":2077,"children":2078},{"class":134},[2079],{"type":20,"value":844},{"type":14,"tag":32,"props":2081,"children":2082},{"class":118},[2083],{"type":20,"value":1228},{"type":14,"tag":32,"props":2085,"children":2086},{"class":134},[2087],{"type":20,"value":1764},{"type":14,"tag":32,"props":2089,"children":2090},{"class":118},[2091],{"type":20,"value":1769},{"type":14,"tag":32,"props":2093,"children":2094},{"class":308},[2095],{"type":20,"value":389},{"type":14,"tag":32,"props":2097,"children":2098},{"class":118},[2099],{"type":20,"value":1778},{"type":14,"tag":32,"props":2101,"children":2102},{"class":107,"line":455},[2103,2107,2111,2115,2119,2123],{"type":14,"tag":32,"props":2104,"children":2105},{"class":118},[2106],{"type":20,"value":200},{"type":14,"tag":32,"props":2108,"children":2109},{"class":308},[2110],{"type":20,"value":1790},{"type":14,"tag":32,"props":2112,"children":2113},{"class":118},[2114],{"type":20,"value":1795},{"type":14,"tag":32,"props":2116,"children":2117},{"class":308},[2118],{"type":20,"value":389},{"type":14,"tag":32,"props":2120,"children":2121},{"class":118},[2122],{"type":20,"value":121},{"type":14,"tag":32,"props":2124,"children":2125},{"class":124},[2126],{"type":20,"value":1808},{"type":14,"tag":32,"props":2128,"children":2129},{"class":107,"line":464},[2130,2134,2138,2142,2146,2150,2154],{"type":14,"tag":32,"props":2131,"children":2132},{"class":118},[2133],{"type":20,"value":200},{"type":14,"tag":32,"props":2135,"children":2136},{"class":308},[2137],{"type":20,"value":1820},{"type":14,"tag":32,"props":2139,"children":2140},{"class":118},[2141],{"type":20,"value":1825},{"type":14,"tag":32,"props":2143,"children":2144},{"class":308},[2145],{"type":20,"value":1830},{"type":14,"tag":32,"props":2147,"children":2148},{"class":118},[2149],{"type":20,"value":121},{"type":14,"tag":32,"props":2151,"children":2152},{"class":124},[2153],{"type":20,"value":1839},{"type":14,"tag":32,"props":2155,"children":2156},{"class":118},[2157],{"type":20,"value":359},{"type":14,"tag":32,"props":2159,"children":2160},{"class":107,"line":473},[2161,2165,2169,2173,2177,2181,2185,2189,2193],{"type":14,"tag":32,"props":2162,"children":2163},{"class":118},[2164],{"type":20,"value":1851},{"type":14,"tag":32,"props":2166,"children":2167},{"class":308},[2168],{"type":20,"value":389},{"type":14,"tag":32,"props":2170,"children":2171},{"class":118},[2172],{"type":20,"value":121},{"type":14,"tag":32,"props":2174,"children":2175},{"class":112},[2176],{"type":20,"value":1864},{"type":14,"tag":32,"props":2178,"children":2179},{"class":118},[2180],{"type":20,"value":334},{"type":14,"tag":32,"props":2182,"children":2183},{"class":124},[2184],{"type":20,"value":1873},{"type":14,"tag":32,"props":2186,"children":2187},{"class":118},[2188],{"type":20,"value":1228},{"type":14,"tag":32,"props":2190,"children":2191},{"class":124},[2192],{"type":20,"value":1882},{"type":14,"tag":32,"props":2194,"children":2195},{"class":118},[2196],{"type":20,"value":1887},{"type":14,"tag":32,"props":2198,"children":2199},{"class":107,"line":482},[2200,2205,2210],{"type":14,"tag":32,"props":2201,"children":2202},{"class":118},[2203],{"type":20,"value":2204},"  } ",{"type":14,"tag":32,"props":2206,"children":2207},{"class":308},[2208],{"type":20,"value":2209},"else",{"type":14,"tag":32,"props":2211,"children":2212},{"class":118},[2213],{"type":20,"value":574},{"type":14,"tag":32,"props":2215,"children":2216},{"class":107,"line":510},[2217,2221,2226,2230],{"type":14,"tag":32,"props":2218,"children":2219},{"class":118},[2220],{"type":20,"value":219},{"type":14,"tag":32,"props":2222,"children":2223},{"class":308},[2224],{"type":20,"value":2225},"throw",{"type":14,"tag":32,"props":2227,"children":2228},{"class":118},[2229],{"type":20,"value":121},{"type":14,"tag":32,"props":2231,"children":2232},{"class":124},[2233],{"type":20,"value":2234},"'当前仅支持生成 table 类型'\n",{"type":14,"tag":32,"props":2236,"children":2237},{"class":107,"line":536},[2238],{"type":14,"tag":32,"props":2239,"children":2240},{"class":118},[2241],{"type":20,"value":1895},{"type":14,"tag":32,"props":2243,"children":2244},{"class":107,"line":544},[2245,2249,2253],{"type":14,"tag":32,"props":2246,"children":2247},{"class":118},[2248],{"type":20,"value":200},{"type":14,"tag":32,"props":2250,"children":2251},{"class":112},[2252],{"type":20,"value":1907},{"type":14,"tag":32,"props":2254,"children":2255},{"class":118},[2256],{"type":20,"value":1912},{"type":14,"tag":32,"props":2258,"children":2259},{"class":107,"line":577},[2260,2264,2268,2272,2276,2280,2284],{"type":14,"tag":32,"props":2261,"children":2262},{"class":118},[2263],{"type":20,"value":1920},{"type":14,"tag":32,"props":2265,"children":2266},{"class":112},[2267],{"type":20,"value":1925},{"type":14,"tag":32,"props":2269,"children":2270},{"class":118},[2271],{"type":20,"value":334},{"type":14,"tag":32,"props":2273,"children":2274},{"class":124},[2275],{"type":20,"value":1934},{"type":14,"tag":32,"props":2277,"children":2278},{"class":134},[2279],{"type":20,"value":1939},{"type":14,"tag":32,"props":2281,"children":2282},{"class":124},[2283],{"type":20,"value":1944},{"type":14,"tag":32,"props":2285,"children":2286},{"class":118},[2287],{"type":20,"value":661},{"type":14,"tag":32,"props":2289,"children":2290},{"class":107,"line":610},[2291],{"type":14,"tag":32,"props":2292,"children":2293},{"class":118},[2294],{"type":20,"value":461},{"type":14,"tag":32,"props":2296,"children":2297},{"class":107,"line":664},[2298],{"type":14,"tag":32,"props":2299,"children":2300},{},[2301],{"type":20,"value":470},{"type":14,"tag":32,"props":2303,"children":2304},{"class":107,"line":673},[2305,2309,2313,2318],{"type":14,"tag":32,"props":2306,"children":2307},{"class":308},[2308],{"type":20,"value":311},{"type":14,"tag":32,"props":2310,"children":2311},{"class":118},[2312],{"type":20,"value":121},{"type":14,"tag":32,"props":2314,"children":2315},{"class":308},[2316],{"type":20,"value":2317},"default",{"type":14,"tag":32,"props":2319,"children":2320},{"class":118},[2321],{"type":20,"value":2322}," create\n",{"type":14,"tag":32,"props":2324,"children":2325},{"class":107,"line":1149},[2326],{"type":14,"tag":32,"props":2327,"children":2328},{},[2329],{"type":20,"value":470},{"type":14,"tag":32,"props":2331,"children":2332},{"class":107,"line":1174},[2333],{"type":14,"tag":32,"props":2334,"children":2335},{"class":291},[2336],{"type":20,"value":2337},"/** /src/bin/index.js */\n",{"type":14,"tag":32,"props":2339,"children":2340},{"class":107,"line":1200},[2341,2345,2350,2354,2358],{"type":14,"tag":32,"props":2342,"children":2343},{"class":308},[2344],{"type":20,"value":488},{"type":14,"tag":32,"props":2346,"children":2347},{"class":118},[2348],{"type":20,"value":2349}," create ",{"type":14,"tag":32,"props":2351,"children":2352},{"class":308},[2353],{"type":20,"value":498},{"type":14,"tag":32,"props":2355,"children":2356},{"class":118},[2357],{"type":20,"value":121},{"type":14,"tag":32,"props":2359,"children":2360},{"class":124},[2361],{"type":20,"value":2362},"'./create'\n",{"type":14,"tag":32,"props":2364,"children":2365},{"class":107,"line":1208},[2366],{"type":14,"tag":32,"props":2367,"children":2368},{},[2369],{"type":20,"value":470},{"type":14,"tag":32,"props":2371,"children":2372},{"class":107,"line":1249},[2373],{"type":14,"tag":32,"props":2374,"children":2375},{"class":291},[2376],{"type":20,"value":1674},{"type":14,"tag":32,"props":2378,"children":2379},{"class":107,"line":1297},[2380,2384,2388,2392,2396,2400,2404,2408,2412,2416,2420,2424],{"type":14,"tag":32,"props":2381,"children":2382},{"class":308},[2383],{"type":20,"value":371},{"type":14,"tag":32,"props":2385,"children":2386},{"class":118},[2387],{"type":20,"value":121},{"type":14,"tag":32,"props":2389,"children":2390},{"class":134},[2391],{"type":20,"value":1694},{"type":14,"tag":32,"props":2393,"children":2394},{"class":118},[2395],{"type":20,"value":121},{"type":14,"tag":32,"props":2397,"children":2398},{"class":308},[2399],{"type":20,"value":389},{"type":14,"tag":32,"props":2401,"children":2402},{"class":118},[2403],{"type":20,"value":121},{"type":14,"tag":32,"props":2405,"children":2406},{"class":112},[2407],{"type":20,"value":1711},{"type":14,"tag":32,"props":2409,"children":2410},{"class":118},[2411],{"type":20,"value":1716},{"type":14,"tag":32,"props":2413,"children":2414},{"class":112},[2415],{"type":20,"value":1721},{"type":14,"tag":32,"props":2417,"children":2418},{"class":118},[2419],{"type":20,"value":334},{"type":14,"tag":32,"props":2421,"children":2422},{"class":134},[2423],{"type":20,"value":1730},{"type":14,"tag":32,"props":2425,"children":2426},{"class":118},[2427],{"type":20,"value":1735},{"type":14,"tag":32,"props":2429,"children":2430},{"class":107,"line":1338},[2431,2436],{"type":14,"tag":32,"props":2432,"children":2433},{"class":308},[2434],{"type":20,"value":2435},"try",{"type":14,"tag":32,"props":2437,"children":2438},{"class":118},[2439],{"type":20,"value":574},{"type":14,"tag":32,"props":2441,"children":2442},{"class":107,"line":1372},[2443,2447,2451],{"type":14,"tag":32,"props":2444,"children":2445},{"class":118},[2446],{"type":20,"value":200},{"type":14,"tag":32,"props":2448,"children":2449},{"class":112},[2450],{"type":20,"value":2048},{"type":14,"tag":32,"props":2452,"children":2453},{"class":118},[2454],{"type":20,"value":2455},"(args)\n",{"type":14,"tag":32,"props":2457,"children":2458},{"class":107,"line":1394},[2459,2464,2469],{"type":14,"tag":32,"props":2460,"children":2461},{"class":118},[2462],{"type":20,"value":2463},"} ",{"type":14,"tag":32,"props":2465,"children":2466},{"class":308},[2467],{"type":20,"value":2468},"catch",{"type":14,"tag":32,"props":2470,"children":2471},{"class":118},[2472],{"type":20,"value":2473},"(e) {\n",{"type":14,"tag":32,"props":2475,"children":2476},{"class":107,"line":1421},[2477,2481,2485],{"type":14,"tag":32,"props":2478,"children":2479},{"class":118},[2480],{"type":20,"value":1920},{"type":14,"tag":32,"props":2482,"children":2483},{"class":112},[2484],{"type":20,"value":1925},{"type":14,"tag":32,"props":2486,"children":2487},{"class":118},[2488],{"type":20,"value":2489},"(e)\n",{"type":14,"tag":32,"props":2491,"children":2492},{"class":107,"line":1454},[2493],{"type":14,"tag":32,"props":2494,"children":2495},{"class":118},[2496],{"type":20,"value":2497},"}",{"type":14,"tag":26,"props":2499,"children":2500},{},[2501,2503,2506,2508,2511],{"type":20,"value":2502},"将脚本入口和执行方法分离是为了防止 unit test 过程中自动执行 main 方法报错.",{"type":14,"tag":153,"props":2504,"children":2505},{},[],{"type":20,"value":2507},"\n接下来我们就可以在 test 中导入 create 方法进行测试. 断言可以通过读取生成的模板内容和 table 文件中内容进行比较.",{"type":14,"tag":153,"props":2509,"children":2510},{},[],{"type":20,"value":2512},"\n以下是测试用例, 从参数、生成内容进行测试",{"type":14,"tag":91,"props":2514,"children":2517},{"className":2515,"code":2516,"language":278,"meta":5},[276],"/** /src/bin/__test__/create.test.ts */\nimport create from '../create'\nimport { describe, expect, it } from 'vitest'\nimport { readFileSync } from 'fs'\n\ndescribe('bin scaffold module', () => {\n\n  describe('create table error args', () => {\n    it('error temp type', () => {\n      try {\n        create({\n          type: 'dialog',\n          path: '/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/dialog.vue'\n        })\n      } catch(e) {\n        expect(e).toBe('当前仅支持生成 table 类型')\n        const product = readFileSync('/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/dialog.vue', 'utf-8')\n        expect(product).toBeUndefined\n      }\n    })\n  })\n\n  it('create table', () => {\n    create({\n      type: 'table',\n      path: '/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/table.vue'\n    })\n    const temp = readFileSync('/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/dist/table', 'utf-8')\n    const product = readFileSync('/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/table.vue', 'utf-8')\n    expect(temp).toBe(product)\n  })\n\n})\n",[2518],{"type":14,"tag":99,"props":2519,"children":2520},{},[2521],{"type":14,"tag":91,"props":2522,"children":2523},{"__ignoreMap":5},[2524,2532,2556,2580,2604,2611,2639,2646,2678,2710,2726,2743,2760,2773,2781,2797,2830,2887,2903,2911,2919,2926,2933,2965,2980,2996,3009,3016,3073,3129,3155,3163,3171],{"type":14,"tag":32,"props":2525,"children":2526},{"class":107,"line":108},[2527],{"type":14,"tag":32,"props":2528,"children":2529},{"class":291},[2530],{"type":20,"value":2531},"/** /src/bin/__test__/create.test.ts */\n",{"type":14,"tag":32,"props":2533,"children":2534},{"class":107,"line":213},[2535,2539,2543,2547,2551],{"type":14,"tag":32,"props":2536,"children":2537},{"class":308},[2538],{"type":20,"value":488},{"type":14,"tag":32,"props":2540,"children":2541},{"class":118},[2542],{"type":20,"value":2349},{"type":14,"tag":32,"props":2544,"children":2545},{"class":308},[2546],{"type":20,"value":498},{"type":14,"tag":32,"props":2548,"children":2549},{"class":118},[2550],{"type":20,"value":121},{"type":14,"tag":32,"props":2552,"children":2553},{"class":124},[2554],{"type":20,"value":2555},"'../create'\n",{"type":14,"tag":32,"props":2557,"children":2558},{"class":107,"line":228},[2559,2563,2568,2572,2576],{"type":14,"tag":32,"props":2560,"children":2561},{"class":308},[2562],{"type":20,"value":488},{"type":14,"tag":32,"props":2564,"children":2565},{"class":118},[2566],{"type":20,"value":2567}," { describe, expect, it } ",{"type":14,"tag":32,"props":2569,"children":2570},{"class":308},[2571],{"type":20,"value":498},{"type":14,"tag":32,"props":2573,"children":2574},{"class":118},[2575],{"type":20,"value":121},{"type":14,"tag":32,"props":2577,"children":2578},{"class":124},[2579],{"type":20,"value":507},{"type":14,"tag":32,"props":2581,"children":2582},{"class":107,"line":256},[2583,2587,2592,2596,2600],{"type":14,"tag":32,"props":2584,"children":2585},{"class":308},[2586],{"type":20,"value":488},{"type":14,"tag":32,"props":2588,"children":2589},{"class":118},[2590],{"type":20,"value":2591}," { readFileSync } ",{"type":14,"tag":32,"props":2593,"children":2594},{"class":308},[2595],{"type":20,"value":498},{"type":14,"tag":32,"props":2597,"children":2598},{"class":118},[2599],{"type":20,"value":121},{"type":14,"tag":32,"props":2601,"children":2602},{"class":124},[2603],{"type":20,"value":1634},{"type":14,"tag":32,"props":2605,"children":2606},{"class":107,"line":427},[2607],{"type":14,"tag":32,"props":2608,"children":2609},{},[2610],{"type":20,"value":470},{"type":14,"tag":32,"props":2612,"children":2613},{"class":107,"line":455},[2614,2618,2622,2627,2631,2635],{"type":14,"tag":32,"props":2615,"children":2616},{"class":112},[2617],{"type":20,"value":550},{"type":14,"tag":32,"props":2619,"children":2620},{"class":118},[2621],{"type":20,"value":334},{"type":14,"tag":32,"props":2623,"children":2624},{"class":124},[2625],{"type":20,"value":2626},"'bin scaffold module'",{"type":14,"tag":32,"props":2628,"children":2629},{"class":118},[2630],{"type":20,"value":564},{"type":14,"tag":32,"props":2632,"children":2633},{"class":308},[2634],{"type":20,"value":569},{"type":14,"tag":32,"props":2636,"children":2637},{"class":118},[2638],{"type":20,"value":574},{"type":14,"tag":32,"props":2640,"children":2641},{"class":107,"line":464},[2642],{"type":14,"tag":32,"props":2643,"children":2644},{},[2645],{"type":20,"value":470},{"type":14,"tag":32,"props":2647,"children":2648},{"class":107,"line":473},[2649,2653,2657,2661,2666,2670,2674],{"type":14,"tag":32,"props":2650,"children":2651},{"class":118},[2652],{"type":20,"value":200},{"type":14,"tag":32,"props":2654,"children":2655},{"class":112},[2656],{"type":20,"value":550},{"type":14,"tag":32,"props":2658,"children":2659},{"class":118},[2660],{"type":20,"value":334},{"type":14,"tag":32,"props":2662,"children":2663},{"class":124},[2664],{"type":20,"value":2665},"'create table error args'",{"type":14,"tag":32,"props":2667,"children":2668},{"class":118},[2669],{"type":20,"value":564},{"type":14,"tag":32,"props":2671,"children":2672},{"class":308},[2673],{"type":20,"value":569},{"type":14,"tag":32,"props":2675,"children":2676},{"class":118},[2677],{"type":20,"value":574},{"type":14,"tag":32,"props":2679,"children":2680},{"class":107,"line":482},[2681,2685,2689,2693,2698,2702,2706],{"type":14,"tag":32,"props":2682,"children":2683},{"class":118},[2684],{"type":20,"value":219},{"type":14,"tag":32,"props":2686,"children":2687},{"class":112},[2688],{"type":20,"value":1214},{"type":14,"tag":32,"props":2690,"children":2691},{"class":118},[2692],{"type":20,"value":334},{"type":14,"tag":32,"props":2694,"children":2695},{"class":124},[2696],{"type":20,"value":2697},"'error temp type'",{"type":14,"tag":32,"props":2699,"children":2700},{"class":118},[2701],{"type":20,"value":564},{"type":14,"tag":32,"props":2703,"children":2704},{"class":308},[2705],{"type":20,"value":569},{"type":14,"tag":32,"props":2707,"children":2708},{"class":118},[2709],{"type":20,"value":574},{"type":14,"tag":32,"props":2711,"children":2712},{"class":107,"line":510},[2713,2718,2722],{"type":14,"tag":32,"props":2714,"children":2715},{"class":118},[2716],{"type":20,"value":2717},"      ",{"type":14,"tag":32,"props":2719,"children":2720},{"class":308},[2721],{"type":20,"value":2435},{"type":14,"tag":32,"props":2723,"children":2724},{"class":118},[2725],{"type":20,"value":574},{"type":14,"tag":32,"props":2727,"children":2728},{"class":107,"line":536},[2729,2734,2738],{"type":14,"tag":32,"props":2730,"children":2731},{"class":118},[2732],{"type":20,"value":2733},"        ",{"type":14,"tag":32,"props":2735,"children":2736},{"class":112},[2737],{"type":20,"value":2048},{"type":14,"tag":32,"props":2739,"children":2740},{"class":118},[2741],{"type":20,"value":2742},"({\n",{"type":14,"tag":32,"props":2744,"children":2745},{"class":107,"line":544},[2746,2751,2756],{"type":14,"tag":32,"props":2747,"children":2748},{"class":118},[2749],{"type":20,"value":2750},"          type: ",{"type":14,"tag":32,"props":2752,"children":2753},{"class":124},[2754],{"type":20,"value":2755},"'dialog'",{"type":14,"tag":32,"props":2757,"children":2758},{"class":118},[2759],{"type":20,"value":253},{"type":14,"tag":32,"props":2761,"children":2762},{"class":107,"line":577},[2763,2768],{"type":14,"tag":32,"props":2764,"children":2765},{"class":118},[2766],{"type":20,"value":2767},"          path: ",{"type":14,"tag":32,"props":2769,"children":2770},{"class":124},[2771],{"type":20,"value":2772},"'/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/dialog.vue'\n",{"type":14,"tag":32,"props":2774,"children":2775},{"class":107,"line":610},[2776],{"type":14,"tag":32,"props":2777,"children":2778},{"class":118},[2779],{"type":20,"value":2780},"        })\n",{"type":14,"tag":32,"props":2782,"children":2783},{"class":107,"line":664},[2784,2789,2793],{"type":14,"tag":32,"props":2785,"children":2786},{"class":118},[2787],{"type":20,"value":2788},"      } ",{"type":14,"tag":32,"props":2790,"children":2791},{"class":308},[2792],{"type":20,"value":2468},{"type":14,"tag":32,"props":2794,"children":2795},{"class":118},[2796],{"type":20,"value":2473},{"type":14,"tag":32,"props":2798,"children":2799},{"class":107,"line":673},[2800,2804,2808,2813,2817,2821,2826],{"type":14,"tag":32,"props":2801,"children":2802},{"class":118},[2803],{"type":20,"value":2733},{"type":14,"tag":32,"props":2805,"children":2806},{"class":112},[2807],{"type":20,"value":620},{"type":14,"tag":32,"props":2809,"children":2810},{"class":118},[2811],{"type":20,"value":2812},"(e).",{"type":14,"tag":32,"props":2814,"children":2815},{"class":112},[2816],{"type":20,"value":647},{"type":14,"tag":32,"props":2818,"children":2819},{"class":118},[2820],{"type":20,"value":334},{"type":14,"tag":32,"props":2822,"children":2823},{"class":124},[2824],{"type":20,"value":2825},"'当前仅支持生成 table 类型'",{"type":14,"tag":32,"props":2827,"children":2828},{"class":118},[2829],{"type":20,"value":661},{"type":14,"tag":32,"props":2831,"children":2832},{"class":107,"line":1149},[2833,2837,2841,2845,2850,2854,2858,2862,2866,2870,2875,2879,2883],{"type":14,"tag":32,"props":2834,"children":2835},{"class":118},[2836],{"type":20,"value":2733},{"type":14,"tag":32,"props":2838,"children":2839},{"class":308},[2840],{"type":20,"value":371},{"type":14,"tag":32,"props":2842,"children":2843},{"class":118},[2844],{"type":20,"value":121},{"type":14,"tag":32,"props":2846,"children":2847},{"class":134},[2848],{"type":20,"value":2849},"product",{"type":14,"tag":32,"props":2851,"children":2852},{"class":118},[2853],{"type":20,"value":121},{"type":14,"tag":32,"props":2855,"children":2856},{"class":308},[2857],{"type":20,"value":389},{"type":14,"tag":32,"props":2859,"children":2860},{"class":118},[2861],{"type":20,"value":121},{"type":14,"tag":32,"props":2863,"children":2864},{"class":112},[2865],{"type":20,"value":1864},{"type":14,"tag":32,"props":2867,"children":2868},{"class":118},[2869],{"type":20,"value":334},{"type":14,"tag":32,"props":2871,"children":2872},{"class":124},[2873],{"type":20,"value":2874},"'/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/dialog.vue'",{"type":14,"tag":32,"props":2876,"children":2877},{"class":118},[2878],{"type":20,"value":1228},{"type":14,"tag":32,"props":2880,"children":2881},{"class":124},[2882],{"type":20,"value":1882},{"type":14,"tag":32,"props":2884,"children":2885},{"class":118},[2886],{"type":20,"value":661},{"type":14,"tag":32,"props":2888,"children":2889},{"class":107,"line":1174},[2890,2894,2898],{"type":14,"tag":32,"props":2891,"children":2892},{"class":118},[2893],{"type":20,"value":2733},{"type":14,"tag":32,"props":2895,"children":2896},{"class":112},[2897],{"type":20,"value":620},{"type":14,"tag":32,"props":2899,"children":2900},{"class":118},[2901],{"type":20,"value":2902},"(product).toBeUndefined\n",{"type":14,"tag":32,"props":2904,"children":2905},{"class":107,"line":1200},[2906],{"type":14,"tag":32,"props":2907,"children":2908},{"class":118},[2909],{"type":20,"value":2910},"      }\n",{"type":14,"tag":32,"props":2912,"children":2913},{"class":107,"line":1208},[2914],{"type":14,"tag":32,"props":2915,"children":2916},{"class":118},[2917],{"type":20,"value":2918},"    })\n",{"type":14,"tag":32,"props":2920,"children":2921},{"class":107,"line":1249},[2922],{"type":14,"tag":32,"props":2923,"children":2924},{"class":118},[2925],{"type":20,"value":670},{"type":14,"tag":32,"props":2927,"children":2928},{"class":107,"line":1297},[2929],{"type":14,"tag":32,"props":2930,"children":2931},{},[2932],{"type":20,"value":470},{"type":14,"tag":32,"props":2934,"children":2935},{"class":107,"line":1338},[2936,2940,2944,2948,2953,2957,2961],{"type":14,"tag":32,"props":2937,"children":2938},{"class":118},[2939],{"type":20,"value":200},{"type":14,"tag":32,"props":2941,"children":2942},{"class":112},[2943],{"type":20,"value":1214},{"type":14,"tag":32,"props":2945,"children":2946},{"class":118},[2947],{"type":20,"value":334},{"type":14,"tag":32,"props":2949,"children":2950},{"class":124},[2951],{"type":20,"value":2952},"'create table'",{"type":14,"tag":32,"props":2954,"children":2955},{"class":118},[2956],{"type":20,"value":564},{"type":14,"tag":32,"props":2958,"children":2959},{"class":308},[2960],{"type":20,"value":569},{"type":14,"tag":32,"props":2962,"children":2963},{"class":118},[2964],{"type":20,"value":574},{"type":14,"tag":32,"props":2966,"children":2967},{"class":107,"line":1372},[2968,2972,2976],{"type":14,"tag":32,"props":2969,"children":2970},{"class":118},[2971],{"type":20,"value":219},{"type":14,"tag":32,"props":2973,"children":2974},{"class":112},[2975],{"type":20,"value":2048},{"type":14,"tag":32,"props":2977,"children":2978},{"class":118},[2979],{"type":20,"value":2742},{"type":14,"tag":32,"props":2981,"children":2982},{"class":107,"line":1394},[2983,2988,2992],{"type":14,"tag":32,"props":2984,"children":2985},{"class":118},[2986],{"type":20,"value":2987},"      type: ",{"type":14,"tag":32,"props":2989,"children":2990},{"class":124},[2991],{"type":20,"value":1839},{"type":14,"tag":32,"props":2993,"children":2994},{"class":118},[2995],{"type":20,"value":253},{"type":14,"tag":32,"props":2997,"children":2998},{"class":107,"line":1421},[2999,3004],{"type":14,"tag":32,"props":3000,"children":3001},{"class":118},[3002],{"type":20,"value":3003},"      path: ",{"type":14,"tag":32,"props":3005,"children":3006},{"class":124},[3007],{"type":20,"value":3008},"'/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/table.vue'\n",{"type":14,"tag":32,"props":3010,"children":3011},{"class":107,"line":1454},[3012],{"type":14,"tag":32,"props":3013,"children":3014},{"class":118},[3015],{"type":20,"value":2918},{"type":14,"tag":32,"props":3017,"children":3018},{"class":107,"line":1462},[3019,3023,3027,3031,3036,3040,3044,3048,3052,3056,3061,3065,3069],{"type":14,"tag":32,"props":3020,"children":3021},{"class":118},[3022],{"type":20,"value":219},{"type":14,"tag":32,"props":3024,"children":3025},{"class":308},[3026],{"type":20,"value":371},{"type":14,"tag":32,"props":3028,"children":3029},{"class":118},[3030],{"type":20,"value":121},{"type":14,"tag":32,"props":3032,"children":3033},{"class":134},[3034],{"type":20,"value":3035},"temp",{"type":14,"tag":32,"props":3037,"children":3038},{"class":118},[3039],{"type":20,"value":121},{"type":14,"tag":32,"props":3041,"children":3042},{"class":308},[3043],{"type":20,"value":389},{"type":14,"tag":32,"props":3045,"children":3046},{"class":118},[3047],{"type":20,"value":121},{"type":14,"tag":32,"props":3049,"children":3050},{"class":112},[3051],{"type":20,"value":1864},{"type":14,"tag":32,"props":3053,"children":3054},{"class":118},[3055],{"type":20,"value":334},{"type":14,"tag":32,"props":3057,"children":3058},{"class":124},[3059],{"type":20,"value":3060},"'/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/dist/table'",{"type":14,"tag":32,"props":3062,"children":3063},{"class":118},[3064],{"type":20,"value":1228},{"type":14,"tag":32,"props":3066,"children":3067},{"class":124},[3068],{"type":20,"value":1882},{"type":14,"tag":32,"props":3070,"children":3071},{"class":118},[3072],{"type":20,"value":661},{"type":14,"tag":32,"props":3074,"children":3075},{"class":107,"line":1488},[3076,3080,3084,3088,3092,3096,3100,3104,3108,3112,3117,3121,3125],{"type":14,"tag":32,"props":3077,"children":3078},{"class":118},[3079],{"type":20,"value":219},{"type":14,"tag":32,"props":3081,"children":3082},{"class":308},[3083],{"type":20,"value":371},{"type":14,"tag":32,"props":3085,"children":3086},{"class":118},[3087],{"type":20,"value":121},{"type":14,"tag":32,"props":3089,"children":3090},{"class":134},[3091],{"type":20,"value":2849},{"type":14,"tag":32,"props":3093,"children":3094},{"class":118},[3095],{"type":20,"value":121},{"type":14,"tag":32,"props":3097,"children":3098},{"class":308},[3099],{"type":20,"value":389},{"type":14,"tag":32,"props":3101,"children":3102},{"class":118},[3103],{"type":20,"value":121},{"type":14,"tag":32,"props":3105,"children":3106},{"class":112},[3107],{"type":20,"value":1864},{"type":14,"tag":32,"props":3109,"children":3110},{"class":118},[3111],{"type":20,"value":334},{"type":14,"tag":32,"props":3113,"children":3114},{"class":124},[3115],{"type":20,"value":3116},"'/Users/ray-d-song/temp/SourceCode/vitest-tutorial-sourcecode/src/bin/__test__/table.vue'",{"type":14,"tag":32,"props":3118,"children":3119},{"class":118},[3120],{"type":20,"value":1228},{"type":14,"tag":32,"props":3122,"children":3123},{"class":124},[3124],{"type":20,"value":1882},{"type":14,"tag":32,"props":3126,"children":3127},{"class":118},[3128],{"type":20,"value":661},{"type":14,"tag":32,"props":3130,"children":3132},{"class":107,"line":3131},30,[3133,3137,3141,3146,3150],{"type":14,"tag":32,"props":3134,"children":3135},{"class":118},[3136],{"type":20,"value":219},{"type":14,"tag":32,"props":3138,"children":3139},{"class":112},[3140],{"type":20,"value":620},{"type":14,"tag":32,"props":3142,"children":3143},{"class":118},[3144],{"type":20,"value":3145},"(temp).",{"type":14,"tag":32,"props":3147,"children":3148},{"class":112},[3149],{"type":20,"value":647},{"type":14,"tag":32,"props":3151,"children":3152},{"class":118},[3153],{"type":20,"value":3154},"(product)\n",{"type":14,"tag":32,"props":3156,"children":3158},{"class":107,"line":3157},31,[3159],{"type":14,"tag":32,"props":3160,"children":3161},{"class":118},[3162],{"type":20,"value":670},{"type":14,"tag":32,"props":3164,"children":3166},{"class":107,"line":3165},32,[3167],{"type":14,"tag":32,"props":3168,"children":3169},{},[3170],{"type":20,"value":470},{"type":14,"tag":32,"props":3172,"children":3174},{"class":107,"line":3173},33,[3175],{"type":14,"tag":32,"props":3176,"children":3177},{"class":118},[3178],{"type":20,"value":679},{"type":14,"tag":26,"props":3180,"children":3181},{},[3182],{"type":14,"tag":693,"props":3183,"children":3186},{"alt":3184,"src":3185},"result","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312121120257.png",[],{"type":14,"tag":795,"props":3188,"children":3190},{"id":3189},"自定义-vue-指令",[3191],{"type":20,"value":3192},"自定义 Vue 指令",{"type":14,"tag":26,"props":3194,"children":3195},{},[3196],{"type":20,"value":3197},"自定义一个 v-debounce, 用于给按钮增加防抖效果",{"type":14,"tag":91,"props":3199,"children":3202},{"className":3200,"code":3201,"language":278,"meta":5},[276],"import _ from 'lodash'\n\nconst vDebounce = {\n  beforeMount(el: HTMLElement, binding: {value: () => void}) {\n    el.addEventListener('click', _.debounce(binding.value, 600))\n  }\n}\n\napp.directive('debounce', vDebounce)\n",[3203],{"type":14,"tag":99,"props":3204,"children":3205},{},[3206],{"type":14,"tag":91,"props":3207,"children":3208},{"__ignoreMap":5},[3209,3234,3241,3269,3352,3398,3405,3412,3419],{"type":14,"tag":32,"props":3210,"children":3211},{"class":107,"line":108},[3212,3216,3221,3225,3229],{"type":14,"tag":32,"props":3213,"children":3214},{"class":308},[3215],{"type":20,"value":488},{"type":14,"tag":32,"props":3217,"children":3218},{"class":118},[3219],{"type":20,"value":3220}," _ ",{"type":14,"tag":32,"props":3222,"children":3223},{"class":308},[3224],{"type":20,"value":498},{"type":14,"tag":32,"props":3226,"children":3227},{"class":118},[3228],{"type":20,"value":121},{"type":14,"tag":32,"props":3230,"children":3231},{"class":124},[3232],{"type":20,"value":3233},"'lodash'\n",{"type":14,"tag":32,"props":3235,"children":3236},{"class":107,"line":213},[3237],{"type":14,"tag":32,"props":3238,"children":3239},{},[3240],{"type":20,"value":470},{"type":14,"tag":32,"props":3242,"children":3243},{"class":107,"line":228},[3244,3248,3252,3257,3261,3265],{"type":14,"tag":32,"props":3245,"children":3246},{"class":308},[3247],{"type":20,"value":371},{"type":14,"tag":32,"props":3249,"children":3250},{"class":118},[3251],{"type":20,"value":121},{"type":14,"tag":32,"props":3253,"children":3254},{"class":134},[3255],{"type":20,"value":3256},"vDebounce",{"type":14,"tag":32,"props":3258,"children":3259},{"class":118},[3260],{"type":20,"value":121},{"type":14,"tag":32,"props":3262,"children":3263},{"class":308},[3264],{"type":20,"value":389},{"type":14,"tag":32,"props":3266,"children":3267},{"class":118},[3268],{"type":20,"value":574},{"type":14,"tag":32,"props":3270,"children":3271},{"class":107,"line":256},[3272,3276,3281,3285,3290,3294,3298,3303,3307,3312,3316,3321,3326,3330,3334,3338,3342,3347],{"type":14,"tag":32,"props":3273,"children":3274},{"class":118},[3275],{"type":20,"value":200},{"type":14,"tag":32,"props":3277,"children":3278},{"class":112},[3279],{"type":20,"value":3280},"beforeMount",{"type":14,"tag":32,"props":3282,"children":3283},{"class":118},[3284],{"type":20,"value":334},{"type":14,"tag":32,"props":3286,"children":3287},{"class":337},[3288],{"type":20,"value":3289},"el",{"type":14,"tag":32,"props":3291,"children":3292},{"class":308},[3293],{"type":20,"value":345},{"type":14,"tag":32,"props":3295,"children":3296},{"class":118},[3297],{"type":20,"value":121},{"type":14,"tag":32,"props":3299,"children":3300},{"class":112},[3301],{"type":20,"value":3302},"HTMLElement",{"type":14,"tag":32,"props":3304,"children":3305},{"class":118},[3306],{"type":20,"value":1228},{"type":14,"tag":32,"props":3308,"children":3309},{"class":337},[3310],{"type":20,"value":3311},"binding",{"type":14,"tag":32,"props":3313,"children":3314},{"class":308},[3315],{"type":20,"value":345},{"type":14,"tag":32,"props":3317,"children":3318},{"class":118},[3319],{"type":20,"value":3320}," {",{"type":14,"tag":32,"props":3322,"children":3323},{"class":112},[3324],{"type":20,"value":3325},"value",{"type":14,"tag":32,"props":3327,"children":3328},{"class":308},[3329],{"type":20,"value":345},{"type":14,"tag":32,"props":3331,"children":3332},{"class":118},[3333],{"type":20,"value":1238},{"type":14,"tag":32,"props":3335,"children":3336},{"class":308},[3337],{"type":20,"value":569},{"type":14,"tag":32,"props":3339,"children":3340},{"class":118},[3341],{"type":20,"value":121},{"type":14,"tag":32,"props":3343,"children":3344},{"class":134},[3345],{"type":20,"value":3346},"void",{"type":14,"tag":32,"props":3348,"children":3349},{"class":118},[3350],{"type":20,"value":3351},"}) {\n",{"type":14,"tag":32,"props":3353,"children":3354},{"class":107,"line":427},[3355,3360,3365,3369,3374,3379,3384,3389,3394],{"type":14,"tag":32,"props":3356,"children":3357},{"class":118},[3358],{"type":20,"value":3359},"    el.",{"type":14,"tag":32,"props":3361,"children":3362},{"class":112},[3363],{"type":20,"value":3364},"addEventListener",{"type":14,"tag":32,"props":3366,"children":3367},{"class":118},[3368],{"type":20,"value":334},{"type":14,"tag":32,"props":3370,"children":3371},{"class":124},[3372],{"type":20,"value":3373},"'click'",{"type":14,"tag":32,"props":3375,"children":3376},{"class":118},[3377],{"type":20,"value":3378},", _.",{"type":14,"tag":32,"props":3380,"children":3381},{"class":112},[3382],{"type":20,"value":3383},"debounce",{"type":14,"tag":32,"props":3385,"children":3386},{"class":118},[3387],{"type":20,"value":3388},"(binding.value, ",{"type":14,"tag":32,"props":3390,"children":3391},{"class":134},[3392],{"type":20,"value":3393},"600",{"type":14,"tag":32,"props":3395,"children":3396},{"class":118},[3397],{"type":20,"value":1735},{"type":14,"tag":32,"props":3399,"children":3400},{"class":107,"line":455},[3401],{"type":14,"tag":32,"props":3402,"children":3403},{"class":118},[3404],{"type":20,"value":1895},{"type":14,"tag":32,"props":3406,"children":3407},{"class":107,"line":464},[3408],{"type":14,"tag":32,"props":3409,"children":3410},{"class":118},[3411],{"type":20,"value":461},{"type":14,"tag":32,"props":3413,"children":3414},{"class":107,"line":473},[3415],{"type":14,"tag":32,"props":3416,"children":3417},{},[3418],{"type":20,"value":470},{"type":14,"tag":32,"props":3420,"children":3421},{"class":107,"line":482},[3422,3427,3432,3436,3441],{"type":14,"tag":32,"props":3423,"children":3424},{"class":118},[3425],{"type":20,"value":3426},"app.",{"type":14,"tag":32,"props":3428,"children":3429},{"class":112},[3430],{"type":20,"value":3431},"directive",{"type":14,"tag":32,"props":3433,"children":3434},{"class":118},[3435],{"type":20,"value":334},{"type":14,"tag":32,"props":3437,"children":3438},{"class":124},[3439],{"type":20,"value":3440},"'debounce'",{"type":14,"tag":32,"props":3442,"children":3443},{"class":118},[3444],{"type":20,"value":3445},", vDebounce)",{"type":14,"tag":26,"props":3447,"children":3448},{},[3449,3451,3456,3458,3463],{"type":20,"value":3450},"为了测试这个指令, 我们需要模拟",{"type":14,"tag":159,"props":3452,"children":3453},{},[3454],{"type":20,"value":3455},"组件挂载->用户点击->方法调用的过程",{"type":20,"value":3457},", 也就是我们需要调用部分组件测试的能力. ",{"type":14,"tag":159,"props":3459,"children":3460},{},[3461],{"type":20,"value":3462},"@vue/test-utils",{"type":20,"value":3464}," 是常用的 Vue 组件测试库.",{"type":14,"tag":91,"props":3466,"children":3469},{"className":3467,"code":3468,"language":96,"meta":5},[94],"pnpm install @vue/test-utils\n",[3470],{"type":14,"tag":99,"props":3471,"children":3472},{},[3473],{"type":14,"tag":91,"props":3474,"children":3475},{"__ignoreMap":5},[3476],{"type":14,"tag":32,"props":3477,"children":3478},{"class":107,"line":108},[3479,3483,3487,3492,3496],{"type":14,"tag":32,"props":3480,"children":3481},{"class":112},[3482],{"type":20,"value":115},{"type":14,"tag":32,"props":3484,"children":3485},{"class":118},[3486],{"type":20,"value":121},{"type":14,"tag":32,"props":3488,"children":3489},{"class":124},[3490],{"type":20,"value":3491},"install",{"type":14,"tag":32,"props":3493,"children":3494},{"class":118},[3495],{"type":20,"value":121},{"type":14,"tag":32,"props":3497,"children":3498},{"class":124},[3499],{"type":20,"value":3462},{"type":14,"tag":26,"props":3501,"children":3502},{},[3503],{"type":20,"value":3504},"vue-test-utils 兼容 jest 和 Vitest, 安装后可以直接使用. 下面是自定义指令的功能测试:",{"type":14,"tag":91,"props":3506,"children":3509},{"className":3507,"code":3508,"language":278,"meta":5},[276],"/** /src/utils/__test__/directives.test.ts */\nimport { describe, expect, it } from 'vitest'\nimport { defineComponent, nextTick, ref } from 'vue'\nimport { mount } from '@vue/test-utils'\nimport { vDebounce } from '../directives'\n\n// 使用 defineComponent 定义测试组件\n// 该 api 除了 template 作为字符串传递外\n// 还可以使用 tsx 获得更好的代码提示\nconst tc = defineComponent({\n  setup() {\n    const num = ref(0)\n    function add() {\n      num.value++\n    }\n    return {\n      num,\n      add  \n    }\n  },\n  template: '\u003Cbutton v-debounce=\"add\">num: {{num}}\u003C/button>'\n})\n\ndescribe('custom directives', async () => {\n  // vue-test-utils 的 mount api, 将组件实例化\n  it('debounce submit', async () => {\n    const wrapper = mount(tc, {\n      global: {\n        directives: {\n          debounce: vDebounce\n        }\n      }\n    })\n\n    // 每过 200 毫秒点击一次 button\n    const interval = setInterval(async () => {\n      // find api 查找目标元素\n      await wrapper.find('button').trigger('click')\n    }, 200)\n    // 阻塞 1000 秒, 让点击事件在 1 秒内执行 4 次\n    await new Promise(resolve => setTimeout(resolve, 1000))\n\n    clearInterval(interval)\n\n    // 阻塞 700 秒, 等待函数执行\n    await new Promise(resolve => setTimeout(resolve, 700))\n    // 确保组件重新渲染\n    await nextTick()\n    // 获取目标元素\n    const btn = wrapper.get('button')\n    // 对目标元素的文本进行断言\n    expect(btn.text()).toBe('num: 1')\n  })\n})\n",[3510],{"type":14,"tag":99,"props":3511,"children":3512},{},[3513],{"type":14,"tag":91,"props":3514,"children":3515},{"__ignoreMap":5},[3516,3524,3547,3571,3596,3621,3628,3636,3644,3652,3689,3705,3754,3777,3790,3798,3813,3821,3829,3836,3844,3857,3865,3872,3908,3920,3960,4002,4010,4018,4026,4034,4041,4048,4056,4069,4127,4140,4193,4211,4224,4294,4302,4320,4328,4341,4406,4419,4443,4456,4506,4519,4562,4570],{"type":14,"tag":32,"props":3517,"children":3518},{"class":107,"line":108},[3519],{"type":14,"tag":32,"props":3520,"children":3521},{"class":291},[3522],{"type":20,"value":3523},"/** /src/utils/__test__/directives.test.ts */\n",{"type":14,"tag":32,"props":3525,"children":3526},{"class":107,"line":213},[3527,3531,3535,3539,3543],{"type":14,"tag":32,"props":3528,"children":3529},{"class":308},[3530],{"type":20,"value":488},{"type":14,"tag":32,"props":3532,"children":3533},{"class":118},[3534],{"type":20,"value":2567},{"type":14,"tag":32,"props":3536,"children":3537},{"class":308},[3538],{"type":20,"value":498},{"type":14,"tag":32,"props":3540,"children":3541},{"class":118},[3542],{"type":20,"value":121},{"type":14,"tag":32,"props":3544,"children":3545},{"class":124},[3546],{"type":20,"value":507},{"type":14,"tag":32,"props":3548,"children":3549},{"class":107,"line":228},[3550,3554,3559,3563,3567],{"type":14,"tag":32,"props":3551,"children":3552},{"class":308},[3553],{"type":20,"value":488},{"type":14,"tag":32,"props":3555,"children":3556},{"class":118},[3557],{"type":20,"value":3558}," { defineComponent, nextTick, ref } ",{"type":14,"tag":32,"props":3560,"children":3561},{"class":308},[3562],{"type":20,"value":498},{"type":14,"tag":32,"props":3564,"children":3565},{"class":118},[3566],{"type":20,"value":121},{"type":14,"tag":32,"props":3568,"children":3569},{"class":124},[3570],{"type":20,"value":862},{"type":14,"tag":32,"props":3572,"children":3573},{"class":107,"line":256},[3574,3578,3583,3587,3591],{"type":14,"tag":32,"props":3575,"children":3576},{"class":308},[3577],{"type":20,"value":488},{"type":14,"tag":32,"props":3579,"children":3580},{"class":118},[3581],{"type":20,"value":3582}," { mount } ",{"type":14,"tag":32,"props":3584,"children":3585},{"class":308},[3586],{"type":20,"value":498},{"type":14,"tag":32,"props":3588,"children":3589},{"class":118},[3590],{"type":20,"value":121},{"type":14,"tag":32,"props":3592,"children":3593},{"class":124},[3594],{"type":20,"value":3595},"'@vue/test-utils'\n",{"type":14,"tag":32,"props":3597,"children":3598},{"class":107,"line":427},[3599,3603,3608,3612,3616],{"type":14,"tag":32,"props":3600,"children":3601},{"class":308},[3602],{"type":20,"value":488},{"type":14,"tag":32,"props":3604,"children":3605},{"class":118},[3606],{"type":20,"value":3607}," { vDebounce } ",{"type":14,"tag":32,"props":3609,"children":3610},{"class":308},[3611],{"type":20,"value":498},{"type":14,"tag":32,"props":3613,"children":3614},{"class":118},[3615],{"type":20,"value":121},{"type":14,"tag":32,"props":3617,"children":3618},{"class":124},[3619],{"type":20,"value":3620},"'../directives'\n",{"type":14,"tag":32,"props":3622,"children":3623},{"class":107,"line":455},[3624],{"type":14,"tag":32,"props":3625,"children":3626},{},[3627],{"type":20,"value":470},{"type":14,"tag":32,"props":3629,"children":3630},{"class":107,"line":464},[3631],{"type":14,"tag":32,"props":3632,"children":3633},{"class":291},[3634],{"type":20,"value":3635},"// 使用 defineComponent 定义测试组件\n",{"type":14,"tag":32,"props":3637,"children":3638},{"class":107,"line":473},[3639],{"type":14,"tag":32,"props":3640,"children":3641},{"class":291},[3642],{"type":20,"value":3643},"// 该 api 除了 template 作为字符串传递外\n",{"type":14,"tag":32,"props":3645,"children":3646},{"class":107,"line":482},[3647],{"type":14,"tag":32,"props":3648,"children":3649},{"class":291},[3650],{"type":20,"value":3651},"// 还可以使用 tsx 获得更好的代码提示\n",{"type":14,"tag":32,"props":3653,"children":3654},{"class":107,"line":510},[3655,3659,3663,3668,3672,3676,3680,3685],{"type":14,"tag":32,"props":3656,"children":3657},{"class":308},[3658],{"type":20,"value":371},{"type":14,"tag":32,"props":3660,"children":3661},{"class":118},[3662],{"type":20,"value":121},{"type":14,"tag":32,"props":3664,"children":3665},{"class":134},[3666],{"type":20,"value":3667},"tc",{"type":14,"tag":32,"props":3669,"children":3670},{"class":118},[3671],{"type":20,"value":121},{"type":14,"tag":32,"props":3673,"children":3674},{"class":308},[3675],{"type":20,"value":389},{"type":14,"tag":32,"props":3677,"children":3678},{"class":118},[3679],{"type":20,"value":121},{"type":14,"tag":32,"props":3681,"children":3682},{"class":112},[3683],{"type":20,"value":3684},"defineComponent",{"type":14,"tag":32,"props":3686,"children":3687},{"class":118},[3688],{"type":20,"value":2742},{"type":14,"tag":32,"props":3690,"children":3691},{"class":107,"line":536},[3692,3696,3701],{"type":14,"tag":32,"props":3693,"children":3694},{"class":118},[3695],{"type":20,"value":200},{"type":14,"tag":32,"props":3697,"children":3698},{"class":112},[3699],{"type":20,"value":3700},"setup",{"type":14,"tag":32,"props":3702,"children":3703},{"class":118},[3704],{"type":20,"value":1662},{"type":14,"tag":32,"props":3706,"children":3707},{"class":107,"line":544},[3708,3712,3716,3720,3725,3729,3733,3737,3741,3745,3750],{"type":14,"tag":32,"props":3709,"children":3710},{"class":118},[3711],{"type":20,"value":219},{"type":14,"tag":32,"props":3713,"children":3714},{"class":308},[3715],{"type":20,"value":371},{"type":14,"tag":32,"props":3717,"children":3718},{"class":118},[3719],{"type":20,"value":121},{"type":14,"tag":32,"props":3721,"children":3722},{"class":134},[3723],{"type":20,"value":3724},"num",{"type":14,"tag":32,"props":3726,"children":3727},{"class":118},[3728],{"type":20,"value":121},{"type":14,"tag":32,"props":3730,"children":3731},{"class":308},[3732],{"type":20,"value":389},{"type":14,"tag":32,"props":3734,"children":3735},{"class":118},[3736],{"type":20,"value":121},{"type":14,"tag":32,"props":3738,"children":3739},{"class":112},[3740],{"type":20,"value":981},{"type":14,"tag":32,"props":3742,"children":3743},{"class":118},[3744],{"type":20,"value":334},{"type":14,"tag":32,"props":3746,"children":3747},{"class":134},[3748],{"type":20,"value":3749},"0",{"type":14,"tag":32,"props":3751,"children":3752},{"class":118},[3753],{"type":20,"value":661},{"type":14,"tag":32,"props":3755,"children":3756},{"class":107,"line":577},[3757,3761,3765,3769,3773],{"type":14,"tag":32,"props":3758,"children":3759},{"class":118},[3760],{"type":20,"value":219},{"type":14,"tag":32,"props":3762,"children":3763},{"class":308},[3764],{"type":20,"value":320},{"type":14,"tag":32,"props":3766,"children":3767},{"class":118},[3768],{"type":20,"value":121},{"type":14,"tag":32,"props":3770,"children":3771},{"class":112},[3772],{"type":20,"value":127},{"type":14,"tag":32,"props":3774,"children":3775},{"class":118},[3776],{"type":20,"value":1662},{"type":14,"tag":32,"props":3778,"children":3779},{"class":107,"line":610},[3780,3785],{"type":14,"tag":32,"props":3781,"children":3782},{"class":118},[3783],{"type":20,"value":3784},"      num.value",{"type":14,"tag":32,"props":3786,"children":3787},{"class":308},[3788],{"type":20,"value":3789},"++\n",{"type":14,"tag":32,"props":3791,"children":3792},{"class":107,"line":664},[3793],{"type":14,"tag":32,"props":3794,"children":3795},{"class":118},[3796],{"type":20,"value":3797},"    }\n",{"type":14,"tag":32,"props":3799,"children":3800},{"class":107,"line":673},[3801,3805,3809],{"type":14,"tag":32,"props":3802,"children":3803},{"class":118},[3804],{"type":20,"value":219},{"type":14,"tag":32,"props":3806,"children":3807},{"class":308},[3808],{"type":20,"value":437},{"type":14,"tag":32,"props":3810,"children":3811},{"class":118},[3812],{"type":20,"value":574},{"type":14,"tag":32,"props":3814,"children":3815},{"class":107,"line":1149},[3816],{"type":14,"tag":32,"props":3817,"children":3818},{"class":118},[3819],{"type":20,"value":3820},"      num,\n",{"type":14,"tag":32,"props":3822,"children":3823},{"class":107,"line":1174},[3824],{"type":14,"tag":32,"props":3825,"children":3826},{"class":118},[3827],{"type":20,"value":3828},"      add  \n",{"type":14,"tag":32,"props":3830,"children":3831},{"class":107,"line":1200},[3832],{"type":14,"tag":32,"props":3833,"children":3834},{"class":118},[3835],{"type":20,"value":3797},{"type":14,"tag":32,"props":3837,"children":3838},{"class":107,"line":1208},[3839],{"type":14,"tag":32,"props":3840,"children":3841},{"class":118},[3842],{"type":20,"value":3843},"  },\n",{"type":14,"tag":32,"props":3845,"children":3846},{"class":107,"line":1249},[3847,3852],{"type":14,"tag":32,"props":3848,"children":3849},{"class":118},[3850],{"type":20,"value":3851},"  template: ",{"type":14,"tag":32,"props":3853,"children":3854},{"class":124},[3855],{"type":20,"value":3856},"'\u003Cbutton v-debounce=\"add\">num: {{num}}\u003C/button>'\n",{"type":14,"tag":32,"props":3858,"children":3859},{"class":107,"line":1297},[3860],{"type":14,"tag":32,"props":3861,"children":3862},{"class":118},[3863],{"type":20,"value":3864},"})\n",{"type":14,"tag":32,"props":3866,"children":3867},{"class":107,"line":1338},[3868],{"type":14,"tag":32,"props":3869,"children":3870},{},[3871],{"type":20,"value":470},{"type":14,"tag":32,"props":3873,"children":3874},{"class":107,"line":1372},[3875,3879,3883,3888,3892,3896,3900,3904],{"type":14,"tag":32,"props":3876,"children":3877},{"class":112},[3878],{"type":20,"value":550},{"type":14,"tag":32,"props":3880,"children":3881},{"class":118},[3882],{"type":20,"value":334},{"type":14,"tag":32,"props":3884,"children":3885},{"class":124},[3886],{"type":20,"value":3887},"'custom directives'",{"type":14,"tag":32,"props":3889,"children":3890},{"class":118},[3891],{"type":20,"value":1228},{"type":14,"tag":32,"props":3893,"children":3894},{"class":308},[3895],{"type":20,"value":1233},{"type":14,"tag":32,"props":3897,"children":3898},{"class":118},[3899],{"type":20,"value":1238},{"type":14,"tag":32,"props":3901,"children":3902},{"class":308},[3903],{"type":20,"value":569},{"type":14,"tag":32,"props":3905,"children":3906},{"class":118},[3907],{"type":20,"value":574},{"type":14,"tag":32,"props":3909,"children":3910},{"class":107,"line":1394},[3911,3915],{"type":14,"tag":32,"props":3912,"children":3913},{"class":118},[3914],{"type":20,"value":200},{"type":14,"tag":32,"props":3916,"children":3917},{"class":291},[3918],{"type":20,"value":3919},"// vue-test-utils 的 mount api, 将组件实例化\n",{"type":14,"tag":32,"props":3921,"children":3922},{"class":107,"line":1421},[3923,3927,3931,3935,3940,3944,3948,3952,3956],{"type":14,"tag":32,"props":3924,"children":3925},{"class":118},[3926],{"type":20,"value":200},{"type":14,"tag":32,"props":3928,"children":3929},{"class":112},[3930],{"type":20,"value":1214},{"type":14,"tag":32,"props":3932,"children":3933},{"class":118},[3934],{"type":20,"value":334},{"type":14,"tag":32,"props":3936,"children":3937},{"class":124},[3938],{"type":20,"value":3939},"'debounce submit'",{"type":14,"tag":32,"props":3941,"children":3942},{"class":118},[3943],{"type":20,"value":1228},{"type":14,"tag":32,"props":3945,"children":3946},{"class":308},[3947],{"type":20,"value":1233},{"type":14,"tag":32,"props":3949,"children":3950},{"class":118},[3951],{"type":20,"value":1238},{"type":14,"tag":32,"props":3953,"children":3954},{"class":308},[3955],{"type":20,"value":569},{"type":14,"tag":32,"props":3957,"children":3958},{"class":118},[3959],{"type":20,"value":574},{"type":14,"tag":32,"props":3961,"children":3962},{"class":107,"line":1454},[3963,3967,3971,3975,3980,3984,3988,3992,3997],{"type":14,"tag":32,"props":3964,"children":3965},{"class":118},[3966],{"type":20,"value":219},{"type":14,"tag":32,"props":3968,"children":3969},{"class":308},[3970],{"type":20,"value":371},{"type":14,"tag":32,"props":3972,"children":3973},{"class":118},[3974],{"type":20,"value":121},{"type":14,"tag":32,"props":3976,"children":3977},{"class":134},[3978],{"type":20,"value":3979},"wrapper",{"type":14,"tag":32,"props":3981,"children":3982},{"class":118},[3983],{"type":20,"value":121},{"type":14,"tag":32,"props":3985,"children":3986},{"class":308},[3987],{"type":20,"value":389},{"type":14,"tag":32,"props":3989,"children":3990},{"class":118},[3991],{"type":20,"value":121},{"type":14,"tag":32,"props":3993,"children":3994},{"class":112},[3995],{"type":20,"value":3996},"mount",{"type":14,"tag":32,"props":3998,"children":3999},{"class":118},[4000],{"type":20,"value":4001},"(tc, {\n",{"type":14,"tag":32,"props":4003,"children":4004},{"class":107,"line":1462},[4005],{"type":14,"tag":32,"props":4006,"children":4007},{"class":118},[4008],{"type":20,"value":4009},"      global: {\n",{"type":14,"tag":32,"props":4011,"children":4012},{"class":107,"line":1488},[4013],{"type":14,"tag":32,"props":4014,"children":4015},{"class":118},[4016],{"type":20,"value":4017},"        directives: {\n",{"type":14,"tag":32,"props":4019,"children":4020},{"class":107,"line":3131},[4021],{"type":14,"tag":32,"props":4022,"children":4023},{"class":118},[4024],{"type":20,"value":4025},"          debounce: vDebounce\n",{"type":14,"tag":32,"props":4027,"children":4028},{"class":107,"line":3157},[4029],{"type":14,"tag":32,"props":4030,"children":4031},{"class":118},[4032],{"type":20,"value":4033},"        }\n",{"type":14,"tag":32,"props":4035,"children":4036},{"class":107,"line":3165},[4037],{"type":14,"tag":32,"props":4038,"children":4039},{"class":118},[4040],{"type":20,"value":2910},{"type":14,"tag":32,"props":4042,"children":4043},{"class":107,"line":3173},[4044],{"type":14,"tag":32,"props":4045,"children":4046},{"class":118},[4047],{"type":20,"value":2918},{"type":14,"tag":32,"props":4049,"children":4051},{"class":107,"line":4050},34,[4052],{"type":14,"tag":32,"props":4053,"children":4054},{},[4055],{"type":20,"value":470},{"type":14,"tag":32,"props":4057,"children":4059},{"class":107,"line":4058},35,[4060,4064],{"type":14,"tag":32,"props":4061,"children":4062},{"class":118},[4063],{"type":20,"value":219},{"type":14,"tag":32,"props":4065,"children":4066},{"class":291},[4067],{"type":20,"value":4068},"// 每过 200 毫秒点击一次 button\n",{"type":14,"tag":32,"props":4070,"children":4072},{"class":107,"line":4071},36,[4073,4077,4081,4085,4090,4094,4098,4102,4107,4111,4115,4119,4123],{"type":14,"tag":32,"props":4074,"children":4075},{"class":118},[4076],{"type":20,"value":219},{"type":14,"tag":32,"props":4078,"children":4079},{"class":308},[4080],{"type":20,"value":371},{"type":14,"tag":32,"props":4082,"children":4083},{"class":118},[4084],{"type":20,"value":121},{"type":14,"tag":32,"props":4086,"children":4087},{"class":134},[4088],{"type":20,"value":4089},"interval",{"type":14,"tag":32,"props":4091,"children":4092},{"class":118},[4093],{"type":20,"value":121},{"type":14,"tag":32,"props":4095,"children":4096},{"class":308},[4097],{"type":20,"value":389},{"type":14,"tag":32,"props":4099,"children":4100},{"class":118},[4101],{"type":20,"value":121},{"type":14,"tag":32,"props":4103,"children":4104},{"class":112},[4105],{"type":20,"value":4106},"setInterval",{"type":14,"tag":32,"props":4108,"children":4109},{"class":118},[4110],{"type":20,"value":334},{"type":14,"tag":32,"props":4112,"children":4113},{"class":308},[4114],{"type":20,"value":1233},{"type":14,"tag":32,"props":4116,"children":4117},{"class":118},[4118],{"type":20,"value":1238},{"type":14,"tag":32,"props":4120,"children":4121},{"class":308},[4122],{"type":20,"value":569},{"type":14,"tag":32,"props":4124,"children":4125},{"class":118},[4126],{"type":20,"value":574},{"type":14,"tag":32,"props":4128,"children":4130},{"class":107,"line":4129},37,[4131,4135],{"type":14,"tag":32,"props":4132,"children":4133},{"class":118},[4134],{"type":20,"value":2717},{"type":14,"tag":32,"props":4136,"children":4137},{"class":291},[4138],{"type":20,"value":4139},"// find api 查找目标元素\n",{"type":14,"tag":32,"props":4141,"children":4143},{"class":107,"line":4142},38,[4144,4148,4152,4157,4162,4166,4171,4176,4181,4185,4189],{"type":14,"tag":32,"props":4145,"children":4146},{"class":118},[4147],{"type":20,"value":2717},{"type":14,"tag":32,"props":4149,"children":4150},{"class":308},[4151],{"type":20,"value":1404},{"type":14,"tag":32,"props":4153,"children":4154},{"class":118},[4155],{"type":20,"value":4156}," wrapper.",{"type":14,"tag":32,"props":4158,"children":4159},{"class":112},[4160],{"type":20,"value":4161},"find",{"type":14,"tag":32,"props":4163,"children":4164},{"class":118},[4165],{"type":20,"value":334},{"type":14,"tag":32,"props":4167,"children":4168},{"class":124},[4169],{"type":20,"value":4170},"'button'",{"type":14,"tag":32,"props":4172,"children":4173},{"class":118},[4174],{"type":20,"value":4175},").",{"type":14,"tag":32,"props":4177,"children":4178},{"class":112},[4179],{"type":20,"value":4180},"trigger",{"type":14,"tag":32,"props":4182,"children":4183},{"class":118},[4184],{"type":20,"value":334},{"type":14,"tag":32,"props":4186,"children":4187},{"class":124},[4188],{"type":20,"value":3373},{"type":14,"tag":32,"props":4190,"children":4191},{"class":118},[4192],{"type":20,"value":661},{"type":14,"tag":32,"props":4194,"children":4196},{"class":107,"line":4195},39,[4197,4202,4207],{"type":14,"tag":32,"props":4198,"children":4199},{"class":118},[4200],{"type":20,"value":4201},"    }, ",{"type":14,"tag":32,"props":4203,"children":4204},{"class":134},[4205],{"type":20,"value":4206},"200",{"type":14,"tag":32,"props":4208,"children":4209},{"class":118},[4210],{"type":20,"value":661},{"type":14,"tag":32,"props":4212,"children":4214},{"class":107,"line":4213},40,[4215,4219],{"type":14,"tag":32,"props":4216,"children":4217},{"class":118},[4218],{"type":20,"value":219},{"type":14,"tag":32,"props":4220,"children":4221},{"class":291},[4222],{"type":20,"value":4223},"// 阻塞 1000 秒, 让点击事件在 1 秒内执行 4 次\n",{"type":14,"tag":32,"props":4225,"children":4227},{"class":107,"line":4226},41,[4228,4232,4236,4240,4245,4249,4254,4258,4263,4267,4271,4275,4280,4285,4290],{"type":14,"tag":32,"props":4229,"children":4230},{"class":118},[4231],{"type":20,"value":219},{"type":14,"tag":32,"props":4233,"children":4234},{"class":308},[4235],{"type":20,"value":1404},{"type":14,"tag":32,"props":4237,"children":4238},{"class":118},[4239],{"type":20,"value":121},{"type":14,"tag":32,"props":4241,"children":4242},{"class":308},[4243],{"type":20,"value":4244},"new",{"type":14,"tag":32,"props":4246,"children":4247},{"class":118},[4248],{"type":20,"value":121},{"type":14,"tag":32,"props":4250,"children":4251},{"class":134},[4252],{"type":20,"value":4253},"Promise",{"type":14,"tag":32,"props":4255,"children":4256},{"class":118},[4257],{"type":20,"value":334},{"type":14,"tag":32,"props":4259,"children":4260},{"class":337},[4261],{"type":20,"value":4262},"resolve",{"type":14,"tag":32,"props":4264,"children":4265},{"class":118},[4266],{"type":20,"value":121},{"type":14,"tag":32,"props":4268,"children":4269},{"class":308},[4270],{"type":20,"value":569},{"type":14,"tag":32,"props":4272,"children":4273},{"class":118},[4274],{"type":20,"value":121},{"type":14,"tag":32,"props":4276,"children":4277},{"class":112},[4278],{"type":20,"value":4279},"setTimeout",{"type":14,"tag":32,"props":4281,"children":4282},{"class":118},[4283],{"type":20,"value":4284},"(resolve, ",{"type":14,"tag":32,"props":4286,"children":4287},{"class":134},[4288],{"type":20,"value":4289},"1000",{"type":14,"tag":32,"props":4291,"children":4292},{"class":118},[4293],{"type":20,"value":1735},{"type":14,"tag":32,"props":4295,"children":4297},{"class":107,"line":4296},42,[4298],{"type":14,"tag":32,"props":4299,"children":4300},{},[4301],{"type":20,"value":470},{"type":14,"tag":32,"props":4303,"children":4305},{"class":107,"line":4304},43,[4306,4310,4315],{"type":14,"tag":32,"props":4307,"children":4308},{"class":118},[4309],{"type":20,"value":219},{"type":14,"tag":32,"props":4311,"children":4312},{"class":112},[4313],{"type":20,"value":4314},"clearInterval",{"type":14,"tag":32,"props":4316,"children":4317},{"class":118},[4318],{"type":20,"value":4319},"(interval)\n",{"type":14,"tag":32,"props":4321,"children":4323},{"class":107,"line":4322},44,[4324],{"type":14,"tag":32,"props":4325,"children":4326},{},[4327],{"type":20,"value":470},{"type":14,"tag":32,"props":4329,"children":4331},{"class":107,"line":4330},45,[4332,4336],{"type":14,"tag":32,"props":4333,"children":4334},{"class":118},[4335],{"type":20,"value":219},{"type":14,"tag":32,"props":4337,"children":4338},{"class":291},[4339],{"type":20,"value":4340},"// 阻塞 700 秒, 等待函数执行\n",{"type":14,"tag":32,"props":4342,"children":4344},{"class":107,"line":4343},46,[4345,4349,4353,4357,4361,4365,4369,4373,4377,4381,4385,4389,4393,4397,4402],{"type":14,"tag":32,"props":4346,"children":4347},{"class":118},[4348],{"type":20,"value":219},{"type":14,"tag":32,"props":4350,"children":4351},{"class":308},[4352],{"type":20,"value":1404},{"type":14,"tag":32,"props":4354,"children":4355},{"class":118},[4356],{"type":20,"value":121},{"type":14,"tag":32,"props":4358,"children":4359},{"class":308},[4360],{"type":20,"value":4244},{"type":14,"tag":32,"props":4362,"children":4363},{"class":118},[4364],{"type":20,"value":121},{"type":14,"tag":32,"props":4366,"children":4367},{"class":134},[4368],{"type":20,"value":4253},{"type":14,"tag":32,"props":4370,"children":4371},{"class":118},[4372],{"type":20,"value":334},{"type":14,"tag":32,"props":4374,"children":4375},{"class":337},[4376],{"type":20,"value":4262},{"type":14,"tag":32,"props":4378,"children":4379},{"class":118},[4380],{"type":20,"value":121},{"type":14,"tag":32,"props":4382,"children":4383},{"class":308},[4384],{"type":20,"value":569},{"type":14,"tag":32,"props":4386,"children":4387},{"class":118},[4388],{"type":20,"value":121},{"type":14,"tag":32,"props":4390,"children":4391},{"class":112},[4392],{"type":20,"value":4279},{"type":14,"tag":32,"props":4394,"children":4395},{"class":118},[4396],{"type":20,"value":4284},{"type":14,"tag":32,"props":4398,"children":4399},{"class":134},[4400],{"type":20,"value":4401},"700",{"type":14,"tag":32,"props":4403,"children":4404},{"class":118},[4405],{"type":20,"value":1735},{"type":14,"tag":32,"props":4407,"children":4409},{"class":107,"line":4408},47,[4410,4414],{"type":14,"tag":32,"props":4411,"children":4412},{"class":118},[4413],{"type":20,"value":219},{"type":14,"tag":32,"props":4415,"children":4416},{"class":291},[4417],{"type":20,"value":4418},"// 确保组件重新渲染\n",{"type":14,"tag":32,"props":4420,"children":4422},{"class":107,"line":4421},48,[4423,4427,4431,4435,4439],{"type":14,"tag":32,"props":4424,"children":4425},{"class":118},[4426],{"type":20,"value":219},{"type":14,"tag":32,"props":4428,"children":4429},{"class":308},[4430],{"type":20,"value":1404},{"type":14,"tag":32,"props":4432,"children":4433},{"class":118},[4434],{"type":20,"value":121},{"type":14,"tag":32,"props":4436,"children":4437},{"class":112},[4438],{"type":20,"value":1413},{"type":14,"tag":32,"props":4440,"children":4441},{"class":118},[4442],{"type":20,"value":1418},{"type":14,"tag":32,"props":4444,"children":4446},{"class":107,"line":4445},49,[4447,4451],{"type":14,"tag":32,"props":4448,"children":4449},{"class":118},[4450],{"type":20,"value":219},{"type":14,"tag":32,"props":4452,"children":4453},{"class":291},[4454],{"type":20,"value":4455},"// 获取目标元素\n",{"type":14,"tag":32,"props":4457,"children":4459},{"class":107,"line":4458},50,[4460,4464,4468,4472,4477,4481,4485,4489,4494,4498,4502],{"type":14,"tag":32,"props":4461,"children":4462},{"class":118},[4463],{"type":20,"value":219},{"type":14,"tag":32,"props":4465,"children":4466},{"class":308},[4467],{"type":20,"value":371},{"type":14,"tag":32,"props":4469,"children":4470},{"class":118},[4471],{"type":20,"value":121},{"type":14,"tag":32,"props":4473,"children":4474},{"class":134},[4475],{"type":20,"value":4476},"btn",{"type":14,"tag":32,"props":4478,"children":4479},{"class":118},[4480],{"type":20,"value":121},{"type":14,"tag":32,"props":4482,"children":4483},{"class":308},[4484],{"type":20,"value":389},{"type":14,"tag":32,"props":4486,"children":4487},{"class":118},[4488],{"type":20,"value":4156},{"type":14,"tag":32,"props":4490,"children":4491},{"class":112},[4492],{"type":20,"value":4493},"get",{"type":14,"tag":32,"props":4495,"children":4496},{"class":118},[4497],{"type":20,"value":334},{"type":14,"tag":32,"props":4499,"children":4500},{"class":124},[4501],{"type":20,"value":4170},{"type":14,"tag":32,"props":4503,"children":4504},{"class":118},[4505],{"type":20,"value":661},{"type":14,"tag":32,"props":4507,"children":4509},{"class":107,"line":4508},51,[4510,4514],{"type":14,"tag":32,"props":4511,"children":4512},{"class":118},[4513],{"type":20,"value":219},{"type":14,"tag":32,"props":4515,"children":4516},{"class":291},[4517],{"type":20,"value":4518},"// 对目标元素的文本进行断言\n",{"type":14,"tag":32,"props":4520,"children":4522},{"class":107,"line":4521},52,[4523,4527,4531,4536,4540,4545,4549,4553,4558],{"type":14,"tag":32,"props":4524,"children":4525},{"class":118},[4526],{"type":20,"value":219},{"type":14,"tag":32,"props":4528,"children":4529},{"class":112},[4530],{"type":20,"value":620},{"type":14,"tag":32,"props":4532,"children":4533},{"class":118},[4534],{"type":20,"value":4535},"(btn.",{"type":14,"tag":32,"props":4537,"children":4538},{"class":112},[4539],{"type":20,"value":20},{"type":14,"tag":32,"props":4541,"children":4542},{"class":118},[4543],{"type":20,"value":4544},"()).",{"type":14,"tag":32,"props":4546,"children":4547},{"class":112},[4548],{"type":20,"value":647},{"type":14,"tag":32,"props":4550,"children":4551},{"class":118},[4552],{"type":20,"value":334},{"type":14,"tag":32,"props":4554,"children":4555},{"class":124},[4556],{"type":20,"value":4557},"'num: 1'",{"type":14,"tag":32,"props":4559,"children":4560},{"class":118},[4561],{"type":20,"value":661},{"type":14,"tag":32,"props":4563,"children":4565},{"class":107,"line":4564},53,[4566],{"type":14,"tag":32,"props":4567,"children":4568},{"class":118},[4569],{"type":20,"value":670},{"type":14,"tag":32,"props":4571,"children":4573},{"class":107,"line":4572},54,[4574],{"type":14,"tag":32,"props":4575,"children":4576},{"class":118},[4577],{"type":20,"value":679},{"type":14,"tag":795,"props":4579,"children":4581},{"id":4580},"store",[4582],{"type":20,"value":4580},{"type":14,"tag":26,"props":4584,"children":4585},{},[4586,4588,4591],{"type":20,"value":4587},"大型的前端项目基本都会用到全局的状态管理库, Vue3 最流行的是 Pinia.",{"type":14,"tag":153,"props":4589,"children":4590},{},[],{"type":20,"value":4592},"\nPinia 提供了可用于测试的 api.",{"type":14,"tag":91,"props":4594,"children":4597},{"className":4595,"code":4596,"language":278,"meta":5},[276],"import { createPinia, setActivePinia } from 'pinia'\nimport { beforeEach, describe, expect, it } from 'vitest'\nimport { useCounterStore } from '../counter'\n\ndescribe('Counter Store', () => {\n  beforeEach(() => {\n    setActivePinia(createPinia())\n  })\n\n  it('increments', () => {\n    const counter = useCounterStore()\n    expect(counter.count).toBe(0)\n    counter.increment()\n    expect(counter.count).toBe(1)\n  })\n})\n",[4598],{"type":14,"tag":99,"props":4599,"children":4600},{},[4601],{"type":14,"tag":91,"props":4602,"children":4603},{"__ignoreMap":5},[4604,4629,4653,4678,4685,4713,4738,4764,4771,4778,4810,4851,4883,4900,4931,4938],{"type":14,"tag":32,"props":4605,"children":4606},{"class":107,"line":108},[4607,4611,4616,4620,4624],{"type":14,"tag":32,"props":4608,"children":4609},{"class":308},[4610],{"type":20,"value":488},{"type":14,"tag":32,"props":4612,"children":4613},{"class":118},[4614],{"type":20,"value":4615}," { createPinia, setActivePinia } ",{"type":14,"tag":32,"props":4617,"children":4618},{"class":308},[4619],{"type":20,"value":498},{"type":14,"tag":32,"props":4621,"children":4622},{"class":118},[4623],{"type":20,"value":121},{"type":14,"tag":32,"props":4625,"children":4626},{"class":124},[4627],{"type":20,"value":4628},"'pinia'\n",{"type":14,"tag":32,"props":4630,"children":4631},{"class":107,"line":213},[4632,4636,4641,4645,4649],{"type":14,"tag":32,"props":4633,"children":4634},{"class":308},[4635],{"type":20,"value":488},{"type":14,"tag":32,"props":4637,"children":4638},{"class":118},[4639],{"type":20,"value":4640}," { beforeEach, describe, expect, it } ",{"type":14,"tag":32,"props":4642,"children":4643},{"class":308},[4644],{"type":20,"value":498},{"type":14,"tag":32,"props":4646,"children":4647},{"class":118},[4648],{"type":20,"value":121},{"type":14,"tag":32,"props":4650,"children":4651},{"class":124},[4652],{"type":20,"value":507},{"type":14,"tag":32,"props":4654,"children":4655},{"class":107,"line":228},[4656,4660,4665,4669,4673],{"type":14,"tag":32,"props":4657,"children":4658},{"class":308},[4659],{"type":20,"value":488},{"type":14,"tag":32,"props":4661,"children":4662},{"class":118},[4663],{"type":20,"value":4664}," { useCounterStore } ",{"type":14,"tag":32,"props":4666,"children":4667},{"class":308},[4668],{"type":20,"value":498},{"type":14,"tag":32,"props":4670,"children":4671},{"class":118},[4672],{"type":20,"value":121},{"type":14,"tag":32,"props":4674,"children":4675},{"class":124},[4676],{"type":20,"value":4677},"'../counter'\n",{"type":14,"tag":32,"props":4679,"children":4680},{"class":107,"line":256},[4681],{"type":14,"tag":32,"props":4682,"children":4683},{},[4684],{"type":20,"value":470},{"type":14,"tag":32,"props":4686,"children":4687},{"class":107,"line":427},[4688,4692,4696,4701,4705,4709],{"type":14,"tag":32,"props":4689,"children":4690},{"class":112},[4691],{"type":20,"value":550},{"type":14,"tag":32,"props":4693,"children":4694},{"class":118},[4695],{"type":20,"value":334},{"type":14,"tag":32,"props":4697,"children":4698},{"class":124},[4699],{"type":20,"value":4700},"'Counter Store'",{"type":14,"tag":32,"props":4702,"children":4703},{"class":118},[4704],{"type":20,"value":564},{"type":14,"tag":32,"props":4706,"children":4707},{"class":308},[4708],{"type":20,"value":569},{"type":14,"tag":32,"props":4710,"children":4711},{"class":118},[4712],{"type":20,"value":574},{"type":14,"tag":32,"props":4714,"children":4715},{"class":107,"line":455},[4716,4720,4725,4730,4734],{"type":14,"tag":32,"props":4717,"children":4718},{"class":118},[4719],{"type":20,"value":200},{"type":14,"tag":32,"props":4721,"children":4722},{"class":112},[4723],{"type":20,"value":4724},"beforeEach",{"type":14,"tag":32,"props":4726,"children":4727},{"class":118},[4728],{"type":20,"value":4729},"(() ",{"type":14,"tag":32,"props":4731,"children":4732},{"class":308},[4733],{"type":20,"value":569},{"type":14,"tag":32,"props":4735,"children":4736},{"class":118},[4737],{"type":20,"value":574},{"type":14,"tag":32,"props":4739,"children":4740},{"class":107,"line":464},[4741,4745,4750,4754,4759],{"type":14,"tag":32,"props":4742,"children":4743},{"class":118},[4744],{"type":20,"value":219},{"type":14,"tag":32,"props":4746,"children":4747},{"class":112},[4748],{"type":20,"value":4749},"setActivePinia",{"type":14,"tag":32,"props":4751,"children":4752},{"class":118},[4753],{"type":20,"value":334},{"type":14,"tag":32,"props":4755,"children":4756},{"class":112},[4757],{"type":20,"value":4758},"createPinia",{"type":14,"tag":32,"props":4760,"children":4761},{"class":118},[4762],{"type":20,"value":4763},"())\n",{"type":14,"tag":32,"props":4765,"children":4766},{"class":107,"line":473},[4767],{"type":14,"tag":32,"props":4768,"children":4769},{"class":118},[4770],{"type":20,"value":670},{"type":14,"tag":32,"props":4772,"children":4773},{"class":107,"line":482},[4774],{"type":14,"tag":32,"props":4775,"children":4776},{},[4777],{"type":20,"value":470},{"type":14,"tag":32,"props":4779,"children":4780},{"class":107,"line":510},[4781,4785,4789,4793,4798,4802,4806],{"type":14,"tag":32,"props":4782,"children":4783},{"class":118},[4784],{"type":20,"value":200},{"type":14,"tag":32,"props":4786,"children":4787},{"class":112},[4788],{"type":20,"value":1214},{"type":14,"tag":32,"props":4790,"children":4791},{"class":118},[4792],{"type":20,"value":334},{"type":14,"tag":32,"props":4794,"children":4795},{"class":124},[4796],{"type":20,"value":4797},"'increments'",{"type":14,"tag":32,"props":4799,"children":4800},{"class":118},[4801],{"type":20,"value":564},{"type":14,"tag":32,"props":4803,"children":4804},{"class":308},[4805],{"type":20,"value":569},{"type":14,"tag":32,"props":4807,"children":4808},{"class":118},[4809],{"type":20,"value":574},{"type":14,"tag":32,"props":4811,"children":4812},{"class":107,"line":536},[4813,4817,4821,4825,4830,4834,4838,4842,4847],{"type":14,"tag":32,"props":4814,"children":4815},{"class":118},[4816],{"type":20,"value":219},{"type":14,"tag":32,"props":4818,"children":4819},{"class":308},[4820],{"type":20,"value":371},{"type":14,"tag":32,"props":4822,"children":4823},{"class":118},[4824],{"type":20,"value":121},{"type":14,"tag":32,"props":4826,"children":4827},{"class":134},[4828],{"type":20,"value":4829},"counter",{"type":14,"tag":32,"props":4831,"children":4832},{"class":118},[4833],{"type":20,"value":121},{"type":14,"tag":32,"props":4835,"children":4836},{"class":308},[4837],{"type":20,"value":389},{"type":14,"tag":32,"props":4839,"children":4840},{"class":118},[4841],{"type":20,"value":121},{"type":14,"tag":32,"props":4843,"children":4844},{"class":112},[4845],{"type":20,"value":4846},"useCounterStore",{"type":14,"tag":32,"props":4848,"children":4849},{"class":118},[4850],{"type":20,"value":1418},{"type":14,"tag":32,"props":4852,"children":4853},{"class":107,"line":544},[4854,4858,4862,4867,4871,4875,4879],{"type":14,"tag":32,"props":4855,"children":4856},{"class":118},[4857],{"type":20,"value":219},{"type":14,"tag":32,"props":4859,"children":4860},{"class":112},[4861],{"type":20,"value":620},{"type":14,"tag":32,"props":4863,"children":4864},{"class":118},[4865],{"type":20,"value":4866},"(counter.count).",{"type":14,"tag":32,"props":4868,"children":4869},{"class":112},[4870],{"type":20,"value":647},{"type":14,"tag":32,"props":4872,"children":4873},{"class":118},[4874],{"type":20,"value":334},{"type":14,"tag":32,"props":4876,"children":4877},{"class":134},[4878],{"type":20,"value":3749},{"type":14,"tag":32,"props":4880,"children":4881},{"class":118},[4882],{"type":20,"value":661},{"type":14,"tag":32,"props":4884,"children":4885},{"class":107,"line":577},[4886,4891,4896],{"type":14,"tag":32,"props":4887,"children":4888},{"class":118},[4889],{"type":20,"value":4890},"    counter.",{"type":14,"tag":32,"props":4892,"children":4893},{"class":112},[4894],{"type":20,"value":4895},"increment",{"type":14,"tag":32,"props":4897,"children":4898},{"class":118},[4899],{"type":20,"value":1418},{"type":14,"tag":32,"props":4901,"children":4902},{"class":107,"line":610},[4903,4907,4911,4915,4919,4923,4927],{"type":14,"tag":32,"props":4904,"children":4905},{"class":118},[4906],{"type":20,"value":219},{"type":14,"tag":32,"props":4908,"children":4909},{"class":112},[4910],{"type":20,"value":620},{"type":14,"tag":32,"props":4912,"children":4913},{"class":118},[4914],{"type":20,"value":4866},{"type":14,"tag":32,"props":4916,"children":4917},{"class":112},[4918],{"type":20,"value":647},{"type":14,"tag":32,"props":4920,"children":4921},{"class":118},[4922],{"type":20,"value":334},{"type":14,"tag":32,"props":4924,"children":4925},{"class":134},[4926],{"type":20,"value":409},{"type":14,"tag":32,"props":4928,"children":4929},{"class":118},[4930],{"type":20,"value":661},{"type":14,"tag":32,"props":4932,"children":4933},{"class":107,"line":664},[4934],{"type":14,"tag":32,"props":4935,"children":4936},{"class":118},[4937],{"type":20,"value":670},{"type":14,"tag":32,"props":4939,"children":4940},{"class":107,"line":673},[4941],{"type":14,"tag":32,"props":4942,"children":4943},{"class":118},[4944],{"type":20,"value":679},{"type":14,"tag":26,"props":4946,"children":4947},{},[4948,4950,4954,4956,4961,4963,4966,4968,4972],{"type":20,"value":4949},"这里引入了一个新的 api: ",{"type":14,"tag":159,"props":4951,"children":4952},{},[4953],{"type":20,"value":4724},{"type":20,"value":4955},", 这是一种",{"type":14,"tag":159,"props":4957,"children":4958},{},[4959],{"type":20,"value":4960},"测试生命周期钩子",{"type":20,"value":4962},", 传入的方法在每个测试用例之前执行.",{"type":14,"tag":153,"props":4964,"children":4965},{},[],{"type":20,"value":4967},"\n我们传入了 pinia 的 ",{"type":14,"tag":159,"props":4969,"children":4970},{},[4971],{"type":20,"value":4749},{"type":20,"value":4973}," api, 这是个 SSR 经常使用的 api, 用户设置一个激活的 Pinia 实例.",{"type":14,"tag":15,"props":4975,"children":4977},{"id":4976},"断言",[4978],{"type":20,"value":4976},{"type":14,"tag":26,"props":4980,"children":4981},{},[4982,4984,4987,4989,4993,4995,5000,5002,5005],{"type":20,"value":4983},"断言是单元测试的核心, 本质一堆用来判断结果的函数库.",{"type":14,"tag":153,"props":4985,"children":4986},{},[],{"type":20,"value":4988},"\n在上面的例子, 我们使用了",{"type":14,"tag":159,"props":4990,"children":4991},{},[4992],{"type":20,"value":647},{"type":20,"value":4994},"断言, 这是最常用的断言, 该断言用于判断值相等或者相同引用, 类似于",{"type":14,"tag":159,"props":4996,"children":4997},{},[4998],{"type":20,"value":4999},"Object.is",{"type":20,"value":5001},".",{"type":14,"tag":153,"props":5003,"children":5004},{},[],{"type":20,"value":5006},"\n以下为常用的几种断言:",{"type":14,"tag":5008,"props":5009,"children":5010},"table",{},[5011,5030],{"type":14,"tag":5012,"props":5013,"children":5014},"thead",{},[5015],{"type":14,"tag":5016,"props":5017,"children":5018},"tr",{},[5019,5025],{"type":14,"tag":5020,"props":5021,"children":5023},"th",{"align":5022},null,[5024],{"type":20,"value":4976},{"type":14,"tag":5020,"props":5026,"children":5027},{"align":5022},[5028],{"type":20,"value":5029},"功能",{"type":14,"tag":5031,"props":5032,"children":5033},"tbody",{},[5034,5048,5060,5073,5086,5099,5112,5125,5143,5156,5169,5182,5195,5208,5224],{"type":14,"tag":5016,"props":5035,"children":5036},{},[5037,5043],{"type":14,"tag":5038,"props":5039,"children":5040},"td",{"align":5022},[5041],{"type":20,"value":5042},"not",{"type":14,"tag":5038,"props":5044,"children":5045},{"align":5022},[5046],{"type":20,"value":5047},"取反",{"type":14,"tag":5016,"props":5049,"children":5050},{},[5051,5055],{"type":14,"tag":5038,"props":5052,"children":5053},{"align":5022},[5054],{"type":20,"value":647},{"type":14,"tag":5038,"props":5056,"children":5057},{"align":5022},[5058],{"type":20,"value":5059},"判断值或对象引用是否相同",{"type":14,"tag":5016,"props":5061,"children":5062},{},[5063,5068],{"type":14,"tag":5038,"props":5064,"children":5065},{"align":5022},[5066],{"type":20,"value":5067},"toEqual",{"type":14,"tag":5038,"props":5069,"children":5070},{"align":5022},[5071],{"type":20,"value":5072},"判断对象值是否相同",{"type":14,"tag":5016,"props":5074,"children":5075},{},[5076,5081],{"type":14,"tag":5038,"props":5077,"children":5078},{"align":5022},[5079],{"type":20,"value":5080},"toBeGreaterThan",{"type":14,"tag":5038,"props":5082,"children":5083},{"align":5022},[5084],{"type":20,"value":5085},"大于",{"type":14,"tag":5016,"props":5087,"children":5088},{},[5089,5094],{"type":14,"tag":5038,"props":5090,"children":5091},{"align":5022},[5092],{"type":20,"value":5093},"toBeGreaterThanOrEqual",{"type":14,"tag":5038,"props":5095,"children":5096},{"align":5022},[5097],{"type":20,"value":5098},"大于等于",{"type":14,"tag":5016,"props":5100,"children":5101},{},[5102,5107],{"type":14,"tag":5038,"props":5103,"children":5104},{"align":5022},[5105],{"type":20,"value":5106},"toBeLessThan",{"type":14,"tag":5038,"props":5108,"children":5109},{"align":5022},[5110],{"type":20,"value":5111},"小于",{"type":14,"tag":5016,"props":5113,"children":5114},{},[5115,5120],{"type":14,"tag":5038,"props":5116,"children":5117},{"align":5022},[5118],{"type":20,"value":5119},"toBeLessThanOrEqual",{"type":14,"tag":5038,"props":5121,"children":5122},{"align":5022},[5123],{"type":20,"value":5124},"小于等于",{"type":14,"tag":5016,"props":5126,"children":5127},{},[5128,5133],{"type":14,"tag":5038,"props":5129,"children":5130},{"align":5022},[5131],{"type":20,"value":5132},"soft",{"type":14,"tag":5038,"props":5134,"children":5135},{"align":5022},[5136,5141],{"type":14,"tag":159,"props":5137,"children":5138},{},[5139],{"type":20,"value":5140},"expect.soft",{"type":20,"value":5142}," 遇到某条用例失败也不会停止测试, 直到所有用例执行完毕展示所有错误",{"type":14,"tag":5016,"props":5144,"children":5145},{},[5146,5151],{"type":14,"tag":5038,"props":5147,"children":5148},{"align":5022},[5149],{"type":20,"value":5150},"toBeTypeOf",{"type":14,"tag":5038,"props":5152,"children":5153},{"align":5022},[5154],{"type":20,"value":5155},"断言类型是否相同",{"type":14,"tag":5016,"props":5157,"children":5158},{},[5159,5164],{"type":14,"tag":5038,"props":5160,"children":5161},{"align":5022},[5162],{"type":20,"value":5163},"toBeInstanceOf",{"type":14,"tag":5038,"props":5165,"children":5166},{"align":5022},[5167],{"type":20,"value":5168},"判断是否是目标类的实例",{"type":14,"tag":5016,"props":5170,"children":5171},{},[5172,5177],{"type":14,"tag":5038,"props":5173,"children":5174},{"align":5022},[5175],{"type":20,"value":5176},"toStrictEqual",{"type":14,"tag":5038,"props":5178,"children":5179},{"align":5022},[5180],{"type":20,"value":5181},"严格相等, 会检查具有 undefined 属性的 key、数组稀疏性、对象类型是否相等",{"type":14,"tag":5016,"props":5183,"children":5184},{},[5185,5190],{"type":14,"tag":5038,"props":5186,"children":5187},{"align":5022},[5188],{"type":20,"value":5189},"toContain",{"type":14,"tag":5038,"props":5191,"children":5192},{"align":5022},[5193],{"type":20,"value":5194},"检查数组元素和子串",{"type":14,"tag":5016,"props":5196,"children":5197},{},[5198,5203],{"type":14,"tag":5038,"props":5199,"children":5200},{"align":5022},[5201],{"type":20,"value":5202},"toThrowError",{"type":14,"tag":5038,"props":5204,"children":5205},{"align":5022},[5206],{"type":20,"value":5207},"检查函数调用过程中是否报错",{"type":14,"tag":5016,"props":5209,"children":5210},{},[5211,5216],{"type":14,"tag":5038,"props":5212,"children":5213},{"align":5022},[5214],{"type":20,"value":5215},"resolves",{"type":14,"tag":5038,"props":5217,"children":5218},{"align":5022},[5219],{"type":14,"tag":159,"props":5220,"children":5221},{},[5222],{"type":20,"value":5223},"expect(func()).resolves.toEqual",{"type":14,"tag":5016,"props":5225,"children":5226},{},[5227,5232],{"type":14,"tag":5038,"props":5228,"children":5229},{"align":5022},[5230],{"type":20,"value":5231},"rejects",{"type":14,"tag":5038,"props":5233,"children":5234},{"align":5022},[5235],{"type":14,"tag":159,"props":5236,"children":5237},{},[5238],{"type":20,"value":5239},"expect(func()).rejects.toThrow",{"type":14,"tag":15,"props":5241,"children":5243},{"id":5242},"mock",[5244],{"type":20,"value":5242},{"type":14,"tag":26,"props":5246,"children":5247},{},[5248,5250,5253,5255,5258,5260,5265,5267,5270,5272,5275,5277],{"type":20,"value":5249},"为了应对业务耦合, 做到仅测试功能代码, 我们可以使用 mock 工具进行数据模拟.",{"type":14,"tag":153,"props":5251,"children":5252},{},[],{"type":20,"value":5254},"\n最常见的场景是模拟请求, 一般情况下你可以自己用一个 Promise 来模拟请求结果, 但有些情况也许你需要更真实的场景.",{"type":14,"tag":153,"props":5256,"children":5257},{},[],{"type":20,"value":5259},"\n常用的 mock 工具, 例如 APIfox, 是通过接口定义来「启动一个真实的服务器返回假数据」. 而 Vitest 并不会启动真正的 node 服务器, 而是通过",{"type":14,"tag":159,"props":5261,"children":5262},{},[5263],{"type":20,"value":5264},"mswjs",{"type":20,"value":5266},"来拦截对应地址的请求.",{"type":14,"tag":153,"props":5268,"children":5269},{},[],{"type":20,"value":5271},"\n也就是说你可以很方便的去模拟「异常请求」的场景.",{"type":14,"tag":153,"props":5273,"children":5274},{},[],{"type":20,"value":5276},"\n首先安装 msw: ",{"type":14,"tag":159,"props":5278,"children":5279},{},[5280],{"type":20,"value":5281},"pnpm install msw",{"type":14,"tag":26,"props":5283,"children":5284},{},[5285,5287,5292,5294,5299],{"type":20,"value":5286},"假设我们需要请求",{"type":14,"tag":159,"props":5288,"children":5289},{},[5290],{"type":20,"value":5291},"https://thorn.mock/test",{"type":20,"value":5293},"这个接口, 获取",{"type":14,"tag":159,"props":5295,"children":5296},{},[5297],{"type":20,"value":5298},"{msg: 'hey'}",{"type":20,"value":5300},"的 json 数据, 以下是我们的测试用例.",{"type":14,"tag":91,"props":5302,"children":5305},{"className":5303,"code":5304,"language":278,"meta":5},[276],"/** /src/api/__test__/mock.test.ts */\nimport { describe, expect, it } from 'vitest'\n\ndescribe('mock', async () => {\n  it('mock api', async () => {\n    const response = await fetch('https://thorn.mock/test') \n    // 使用 toEqual 来比较对象值\n    expect(await response.json()).toEqual({\n      msg: 'hey'\n    })\n  })\n})\n",[5306],{"type":14,"tag":99,"props":5307,"children":5308},{},[5309],{"type":14,"tag":91,"props":5310,"children":5311},{"__ignoreMap":5},[5312,5320,5343,5350,5386,5426,5484,5496,5536,5549,5556,5563],{"type":14,"tag":32,"props":5313,"children":5314},{"class":107,"line":108},[5315],{"type":14,"tag":32,"props":5316,"children":5317},{"class":291},[5318],{"type":20,"value":5319},"/** /src/api/__test__/mock.test.ts */\n",{"type":14,"tag":32,"props":5321,"children":5322},{"class":107,"line":213},[5323,5327,5331,5335,5339],{"type":14,"tag":32,"props":5324,"children":5325},{"class":308},[5326],{"type":20,"value":488},{"type":14,"tag":32,"props":5328,"children":5329},{"class":118},[5330],{"type":20,"value":2567},{"type":14,"tag":32,"props":5332,"children":5333},{"class":308},[5334],{"type":20,"value":498},{"type":14,"tag":32,"props":5336,"children":5337},{"class":118},[5338],{"type":20,"value":121},{"type":14,"tag":32,"props":5340,"children":5341},{"class":124},[5342],{"type":20,"value":507},{"type":14,"tag":32,"props":5344,"children":5345},{"class":107,"line":228},[5346],{"type":14,"tag":32,"props":5347,"children":5348},{},[5349],{"type":20,"value":470},{"type":14,"tag":32,"props":5351,"children":5352},{"class":107,"line":256},[5353,5357,5361,5366,5370,5374,5378,5382],{"type":14,"tag":32,"props":5354,"children":5355},{"class":112},[5356],{"type":20,"value":550},{"type":14,"tag":32,"props":5358,"children":5359},{"class":118},[5360],{"type":20,"value":334},{"type":14,"tag":32,"props":5362,"children":5363},{"class":124},[5364],{"type":20,"value":5365},"'mock'",{"type":14,"tag":32,"props":5367,"children":5368},{"class":118},[5369],{"type":20,"value":1228},{"type":14,"tag":32,"props":5371,"children":5372},{"class":308},[5373],{"type":20,"value":1233},{"type":14,"tag":32,"props":5375,"children":5376},{"class":118},[5377],{"type":20,"value":1238},{"type":14,"tag":32,"props":5379,"children":5380},{"class":308},[5381],{"type":20,"value":569},{"type":14,"tag":32,"props":5383,"children":5384},{"class":118},[5385],{"type":20,"value":574},{"type":14,"tag":32,"props":5387,"children":5388},{"class":107,"line":427},[5389,5393,5397,5401,5406,5410,5414,5418,5422],{"type":14,"tag":32,"props":5390,"children":5391},{"class":118},[5392],{"type":20,"value":200},{"type":14,"tag":32,"props":5394,"children":5395},{"class":112},[5396],{"type":20,"value":1214},{"type":14,"tag":32,"props":5398,"children":5399},{"class":118},[5400],{"type":20,"value":334},{"type":14,"tag":32,"props":5402,"children":5403},{"class":124},[5404],{"type":20,"value":5405},"'mock api'",{"type":14,"tag":32,"props":5407,"children":5408},{"class":118},[5409],{"type":20,"value":1228},{"type":14,"tag":32,"props":5411,"children":5412},{"class":308},[5413],{"type":20,"value":1233},{"type":14,"tag":32,"props":5415,"children":5416},{"class":118},[5417],{"type":20,"value":1238},{"type":14,"tag":32,"props":5419,"children":5420},{"class":308},[5421],{"type":20,"value":569},{"type":14,"tag":32,"props":5423,"children":5424},{"class":118},[5425],{"type":20,"value":574},{"type":14,"tag":32,"props":5427,"children":5428},{"class":107,"line":455},[5429,5433,5437,5441,5446,5450,5454,5458,5462,5466,5471,5475,5480],{"type":14,"tag":32,"props":5430,"children":5431},{"class":118},[5432],{"type":20,"value":219},{"type":14,"tag":32,"props":5434,"children":5435},{"class":308},[5436],{"type":20,"value":371},{"type":14,"tag":32,"props":5438,"children":5439},{"class":118},[5440],{"type":20,"value":121},{"type":14,"tag":32,"props":5442,"children":5443},{"class":134},[5444],{"type":20,"value":5445},"response",{"type":14,"tag":32,"props":5447,"children":5448},{"class":118},[5449],{"type":20,"value":121},{"type":14,"tag":32,"props":5451,"children":5452},{"class":308},[5453],{"type":20,"value":389},{"type":14,"tag":32,"props":5455,"children":5456},{"class":118},[5457],{"type":20,"value":121},{"type":14,"tag":32,"props":5459,"children":5460},{"class":308},[5461],{"type":20,"value":1404},{"type":14,"tag":32,"props":5463,"children":5464},{"class":118},[5465],{"type":20,"value":121},{"type":14,"tag":32,"props":5467,"children":5468},{"class":112},[5469],{"type":20,"value":5470},"fetch",{"type":14,"tag":32,"props":5472,"children":5473},{"class":118},[5474],{"type":20,"value":334},{"type":14,"tag":32,"props":5476,"children":5477},{"class":124},[5478],{"type":20,"value":5479},"'https://thorn.mock/test'",{"type":14,"tag":32,"props":5481,"children":5482},{"class":118},[5483],{"type":20,"value":1887},{"type":14,"tag":32,"props":5485,"children":5486},{"class":107,"line":464},[5487,5491],{"type":14,"tag":32,"props":5488,"children":5489},{"class":118},[5490],{"type":20,"value":219},{"type":14,"tag":32,"props":5492,"children":5493},{"class":291},[5494],{"type":20,"value":5495},"// 使用 toEqual 来比较对象值\n",{"type":14,"tag":32,"props":5497,"children":5498},{"class":107,"line":473},[5499,5503,5507,5511,5515,5520,5524,5528,5532],{"type":14,"tag":32,"props":5500,"children":5501},{"class":118},[5502],{"type":20,"value":219},{"type":14,"tag":32,"props":5504,"children":5505},{"class":112},[5506],{"type":20,"value":620},{"type":14,"tag":32,"props":5508,"children":5509},{"class":118},[5510],{"type":20,"value":334},{"type":14,"tag":32,"props":5512,"children":5513},{"class":308},[5514],{"type":20,"value":1404},{"type":14,"tag":32,"props":5516,"children":5517},{"class":118},[5518],{"type":20,"value":5519}," response.",{"type":14,"tag":32,"props":5521,"children":5522},{"class":112},[5523],{"type":20,"value":185},{"type":14,"tag":32,"props":5525,"children":5526},{"class":118},[5527],{"type":20,"value":4544},{"type":14,"tag":32,"props":5529,"children":5530},{"class":112},[5531],{"type":20,"value":5067},{"type":14,"tag":32,"props":5533,"children":5534},{"class":118},[5535],{"type":20,"value":2742},{"type":14,"tag":32,"props":5537,"children":5538},{"class":107,"line":482},[5539,5544],{"type":14,"tag":32,"props":5540,"children":5541},{"class":118},[5542],{"type":20,"value":5543},"      msg: ",{"type":14,"tag":32,"props":5545,"children":5546},{"class":124},[5547],{"type":20,"value":5548},"'hey'\n",{"type":14,"tag":32,"props":5550,"children":5551},{"class":107,"line":510},[5552],{"type":14,"tag":32,"props":5553,"children":5554},{"class":118},[5555],{"type":20,"value":2918},{"type":14,"tag":32,"props":5557,"children":5558},{"class":107,"line":536},[5559],{"type":14,"tag":32,"props":5560,"children":5561},{"class":118},[5562],{"type":20,"value":670},{"type":14,"tag":32,"props":5564,"children":5565},{"class":107,"line":544},[5566],{"type":14,"tag":32,"props":5567,"children":5568},{"class":118},[5569],{"type":20,"value":679},{"type":14,"tag":26,"props":5571,"children":5572},{},[5573],{"type":20,"value":5574},"为了 mock 这个接口, 我们需要按照 msw 的语法编写一个 server.",{"type":14,"tag":91,"props":5576,"children":5579},{"className":5577,"code":5578,"language":278,"meta":5},[276],"/** /src/mocks/server.ts */\nimport { setupServer } from 'msw/node'\nimport { HttpHandler, HttpResponse, http } from 'msw'\n\nexport const handlers: Array\u003CHttpHandler> = [\n  http.get('https://thorn.mock/test', () => {\n    return HttpResponse.json({\n      msg: 'hey'\n    })\n  })\n]\n\nexport const server = setupServer(...handlers)\n",[5580],{"type":14,"tag":99,"props":5581,"children":5582},{},[5583],{"type":14,"tag":91,"props":5584,"children":5585},{"__ignoreMap":5},[5586,5594,5619,5644,5651,5712,5744,5768,5779,5786,5793,5801,5808],{"type":14,"tag":32,"props":5587,"children":5588},{"class":107,"line":108},[5589],{"type":14,"tag":32,"props":5590,"children":5591},{"class":291},[5592],{"type":20,"value":5593},"/** /src/mocks/server.ts */\n",{"type":14,"tag":32,"props":5595,"children":5596},{"class":107,"line":213},[5597,5601,5606,5610,5614],{"type":14,"tag":32,"props":5598,"children":5599},{"class":308},[5600],{"type":20,"value":488},{"type":14,"tag":32,"props":5602,"children":5603},{"class":118},[5604],{"type":20,"value":5605}," { setupServer } ",{"type":14,"tag":32,"props":5607,"children":5608},{"class":308},[5609],{"type":20,"value":498},{"type":14,"tag":32,"props":5611,"children":5612},{"class":118},[5613],{"type":20,"value":121},{"type":14,"tag":32,"props":5615,"children":5616},{"class":124},[5617],{"type":20,"value":5618},"'msw/node'\n",{"type":14,"tag":32,"props":5620,"children":5621},{"class":107,"line":228},[5622,5626,5631,5635,5639],{"type":14,"tag":32,"props":5623,"children":5624},{"class":308},[5625],{"type":20,"value":488},{"type":14,"tag":32,"props":5627,"children":5628},{"class":118},[5629],{"type":20,"value":5630}," { HttpHandler, HttpResponse, http } ",{"type":14,"tag":32,"props":5632,"children":5633},{"class":308},[5634],{"type":20,"value":498},{"type":14,"tag":32,"props":5636,"children":5637},{"class":118},[5638],{"type":20,"value":121},{"type":14,"tag":32,"props":5640,"children":5641},{"class":124},[5642],{"type":20,"value":5643},"'msw'\n",{"type":14,"tag":32,"props":5645,"children":5646},{"class":107,"line":256},[5647],{"type":14,"tag":32,"props":5648,"children":5649},{},[5650],{"type":20,"value":470},{"type":14,"tag":32,"props":5652,"children":5653},{"class":107,"line":427},[5654,5658,5662,5666,5670,5675,5679,5683,5688,5693,5698,5703,5707],{"type":14,"tag":32,"props":5655,"children":5656},{"class":308},[5657],{"type":20,"value":311},{"type":14,"tag":32,"props":5659,"children":5660},{"class":118},[5661],{"type":20,"value":121},{"type":14,"tag":32,"props":5663,"children":5664},{"class":308},[5665],{"type":20,"value":371},{"type":14,"tag":32,"props":5667,"children":5668},{"class":118},[5669],{"type":20,"value":121},{"type":14,"tag":32,"props":5671,"children":5672},{"class":134},[5673],{"type":20,"value":5674},"handlers",{"type":14,"tag":32,"props":5676,"children":5677},{"class":308},[5678],{"type":20,"value":345},{"type":14,"tag":32,"props":5680,"children":5681},{"class":118},[5682],{"type":20,"value":121},{"type":14,"tag":32,"props":5684,"children":5685},{"class":112},[5686],{"type":20,"value":5687},"Array",{"type":14,"tag":32,"props":5689,"children":5690},{"class":118},[5691],{"type":20,"value":5692},"\u003C",{"type":14,"tag":32,"props":5694,"children":5695},{"class":112},[5696],{"type":20,"value":5697},"HttpHandler",{"type":14,"tag":32,"props":5699,"children":5700},{"class":118},[5701],{"type":20,"value":5702},"> ",{"type":14,"tag":32,"props":5704,"children":5705},{"class":308},[5706],{"type":20,"value":389},{"type":14,"tag":32,"props":5708,"children":5709},{"class":118},[5710],{"type":20,"value":5711}," [\n",{"type":14,"tag":32,"props":5713,"children":5714},{"class":107,"line":455},[5715,5720,5724,5728,5732,5736,5740],{"type":14,"tag":32,"props":5716,"children":5717},{"class":118},[5718],{"type":20,"value":5719},"  http.",{"type":14,"tag":32,"props":5721,"children":5722},{"class":112},[5723],{"type":20,"value":4493},{"type":14,"tag":32,"props":5725,"children":5726},{"class":118},[5727],{"type":20,"value":334},{"type":14,"tag":32,"props":5729,"children":5730},{"class":124},[5731],{"type":20,"value":5479},{"type":14,"tag":32,"props":5733,"children":5734},{"class":118},[5735],{"type":20,"value":564},{"type":14,"tag":32,"props":5737,"children":5738},{"class":308},[5739],{"type":20,"value":569},{"type":14,"tag":32,"props":5741,"children":5742},{"class":118},[5743],{"type":20,"value":574},{"type":14,"tag":32,"props":5745,"children":5746},{"class":107,"line":464},[5747,5751,5755,5760,5764],{"type":14,"tag":32,"props":5748,"children":5749},{"class":118},[5750],{"type":20,"value":219},{"type":14,"tag":32,"props":5752,"children":5753},{"class":308},[5754],{"type":20,"value":437},{"type":14,"tag":32,"props":5756,"children":5757},{"class":118},[5758],{"type":20,"value":5759}," HttpResponse.",{"type":14,"tag":32,"props":5761,"children":5762},{"class":112},[5763],{"type":20,"value":185},{"type":14,"tag":32,"props":5765,"children":5766},{"class":118},[5767],{"type":20,"value":2742},{"type":14,"tag":32,"props":5769,"children":5770},{"class":107,"line":473},[5771,5775],{"type":14,"tag":32,"props":5772,"children":5773},{"class":118},[5774],{"type":20,"value":5543},{"type":14,"tag":32,"props":5776,"children":5777},{"class":124},[5778],{"type":20,"value":5548},{"type":14,"tag":32,"props":5780,"children":5781},{"class":107,"line":482},[5782],{"type":14,"tag":32,"props":5783,"children":5784},{"class":118},[5785],{"type":20,"value":2918},{"type":14,"tag":32,"props":5787,"children":5788},{"class":107,"line":510},[5789],{"type":14,"tag":32,"props":5790,"children":5791},{"class":118},[5792],{"type":20,"value":670},{"type":14,"tag":32,"props":5794,"children":5795},{"class":107,"line":536},[5796],{"type":14,"tag":32,"props":5797,"children":5798},{"class":118},[5799],{"type":20,"value":5800},"]\n",{"type":14,"tag":32,"props":5802,"children":5803},{"class":107,"line":544},[5804],{"type":14,"tag":32,"props":5805,"children":5806},{},[5807],{"type":20,"value":470},{"type":14,"tag":32,"props":5809,"children":5810},{"class":107,"line":577},[5811,5815,5819,5823,5827,5832,5836,5840,5844,5849,5853,5858],{"type":14,"tag":32,"props":5812,"children":5813},{"class":308},[5814],{"type":20,"value":311},{"type":14,"tag":32,"props":5816,"children":5817},{"class":118},[5818],{"type":20,"value":121},{"type":14,"tag":32,"props":5820,"children":5821},{"class":308},[5822],{"type":20,"value":371},{"type":14,"tag":32,"props":5824,"children":5825},{"class":118},[5826],{"type":20,"value":121},{"type":14,"tag":32,"props":5828,"children":5829},{"class":134},[5830],{"type":20,"value":5831},"server",{"type":14,"tag":32,"props":5833,"children":5834},{"class":118},[5835],{"type":20,"value":121},{"type":14,"tag":32,"props":5837,"children":5838},{"class":308},[5839],{"type":20,"value":389},{"type":14,"tag":32,"props":5841,"children":5842},{"class":118},[5843],{"type":20,"value":121},{"type":14,"tag":32,"props":5845,"children":5846},{"class":112},[5847],{"type":20,"value":5848},"setupServer",{"type":14,"tag":32,"props":5850,"children":5851},{"class":118},[5852],{"type":20,"value":334},{"type":14,"tag":32,"props":5854,"children":5855},{"class":308},[5856],{"type":20,"value":5857},"...",{"type":14,"tag":32,"props":5859,"children":5860},{"class":118},[5861],{"type":20,"value":5862},"handlers)",{"type":14,"tag":26,"props":5864,"children":5865},{},[5866,5868,5871,5873,5878],{"type":20,"value":5867},"理想状况下, 我们希望每一次测试开始都启动 mock 服务器, 测试结束将服务关掉, Vitest 提供了四个 api 来实现这个过程.",{"type":14,"tag":153,"props":5869,"children":5870},{},[],{"type":20,"value":5872},"\n在 Vitest.config.ts 中, 添加 setupFiles 选项, 该选项接受",{"type":14,"tag":159,"props":5874,"children":5875},{},[5876],{"type":20,"value":5877},"string|string[]",{"type":20,"value":5879},"作为文件路径, 写入的文件每次 Vitest 启动都会自动执行.",{"type":14,"tag":91,"props":5881,"children":5884},{"className":5882,"code":5883,"language":278,"meta":5},[276],"defineConfig({\n  test: {\n    // ...\n    setupFiles: './src/setup.ts'\n    // ...\n  }\n})\n",[5885],{"type":14,"tag":99,"props":5886,"children":5887},{},[5888],{"type":14,"tag":91,"props":5889,"children":5890},{"__ignoreMap":5},[5891,5903,5911,5923,5936,5947,5954],{"type":14,"tag":32,"props":5892,"children":5893},{"class":107,"line":108},[5894,5899],{"type":14,"tag":32,"props":5895,"children":5896},{"class":112},[5897],{"type":20,"value":5898},"defineConfig",{"type":14,"tag":32,"props":5900,"children":5901},{"class":118},[5902],{"type":20,"value":2742},{"type":14,"tag":32,"props":5904,"children":5905},{"class":107,"line":213},[5906],{"type":14,"tag":32,"props":5907,"children":5908},{"class":118},[5909],{"type":20,"value":5910},"  test: {\n",{"type":14,"tag":32,"props":5912,"children":5913},{"class":107,"line":228},[5914,5918],{"type":14,"tag":32,"props":5915,"children":5916},{"class":118},[5917],{"type":20,"value":219},{"type":14,"tag":32,"props":5919,"children":5920},{"class":291},[5921],{"type":20,"value":5922},"// ...\n",{"type":14,"tag":32,"props":5924,"children":5925},{"class":107,"line":256},[5926,5931],{"type":14,"tag":32,"props":5927,"children":5928},{"class":118},[5929],{"type":20,"value":5930},"    setupFiles: ",{"type":14,"tag":32,"props":5932,"children":5933},{"class":124},[5934],{"type":20,"value":5935},"'./src/setup.ts'\n",{"type":14,"tag":32,"props":5937,"children":5938},{"class":107,"line":427},[5939,5943],{"type":14,"tag":32,"props":5940,"children":5941},{"class":118},[5942],{"type":20,"value":219},{"type":14,"tag":32,"props":5944,"children":5945},{"class":291},[5946],{"type":20,"value":5922},{"type":14,"tag":32,"props":5948,"children":5949},{"class":107,"line":455},[5950],{"type":14,"tag":32,"props":5951,"children":5952},{"class":118},[5953],{"type":20,"value":1895},{"type":14,"tag":32,"props":5955,"children":5956},{"class":107,"line":464},[5957],{"type":14,"tag":32,"props":5958,"children":5959},{"class":118},[5960],{"type":20,"value":679},{"type":14,"tag":26,"props":5962,"children":5963},{},[5964],{"type":20,"value":5965},"在 setup.ts 文件中, 我们调用 Vitest 钩子:",{"type":14,"tag":91,"props":5967,"children":5970},{"className":5968,"code":5969,"language":278,"meta":5},[276],"import { server } from './mocks/server'\nimport { beforeAll, afterAll, afterEach } from 'vitest'\n\n// 在每一次测试开始前开启服务器\nbeforeAll(() => server.listen({ onUnhandledRequest: 'error' }))\n// 在每一次测试结束后关闭服务器\nafterAll(() => server.close())\n// 在每一个用例结束后重置 handlers\nafterEach(() => server.resetHandlers())\n",[5971],{"type":14,"tag":99,"props":5972,"children":5973},{},[5974],{"type":14,"tag":91,"props":5975,"children":5976},{"__ignoreMap":5},[5977,6002,6026,6033,6041,6082,6090,6119,6127],{"type":14,"tag":32,"props":5978,"children":5979},{"class":107,"line":108},[5980,5984,5989,5993,5997],{"type":14,"tag":32,"props":5981,"children":5982},{"class":308},[5983],{"type":20,"value":488},{"type":14,"tag":32,"props":5985,"children":5986},{"class":118},[5987],{"type":20,"value":5988}," { server } ",{"type":14,"tag":32,"props":5990,"children":5991},{"class":308},[5992],{"type":20,"value":498},{"type":14,"tag":32,"props":5994,"children":5995},{"class":118},[5996],{"type":20,"value":121},{"type":14,"tag":32,"props":5998,"children":5999},{"class":124},[6000],{"type":20,"value":6001},"'./mocks/server'\n",{"type":14,"tag":32,"props":6003,"children":6004},{"class":107,"line":213},[6005,6009,6014,6018,6022],{"type":14,"tag":32,"props":6006,"children":6007},{"class":308},[6008],{"type":20,"value":488},{"type":14,"tag":32,"props":6010,"children":6011},{"class":118},[6012],{"type":20,"value":6013}," { beforeAll, afterAll, afterEach } ",{"type":14,"tag":32,"props":6015,"children":6016},{"class":308},[6017],{"type":20,"value":498},{"type":14,"tag":32,"props":6019,"children":6020},{"class":118},[6021],{"type":20,"value":121},{"type":14,"tag":32,"props":6023,"children":6024},{"class":124},[6025],{"type":20,"value":507},{"type":14,"tag":32,"props":6027,"children":6028},{"class":107,"line":228},[6029],{"type":14,"tag":32,"props":6030,"children":6031},{},[6032],{"type":20,"value":470},{"type":14,"tag":32,"props":6034,"children":6035},{"class":107,"line":256},[6036],{"type":14,"tag":32,"props":6037,"children":6038},{"class":291},[6039],{"type":20,"value":6040},"// 在每一次测试开始前开启服务器\n",{"type":14,"tag":32,"props":6042,"children":6043},{"class":107,"line":427},[6044,6049,6053,6057,6062,6067,6072,6077],{"type":14,"tag":32,"props":6045,"children":6046},{"class":112},[6047],{"type":20,"value":6048},"beforeAll",{"type":14,"tag":32,"props":6050,"children":6051},{"class":118},[6052],{"type":20,"value":4729},{"type":14,"tag":32,"props":6054,"children":6055},{"class":308},[6056],{"type":20,"value":569},{"type":14,"tag":32,"props":6058,"children":6059},{"class":118},[6060],{"type":20,"value":6061}," server.",{"type":14,"tag":32,"props":6063,"children":6064},{"class":112},[6065],{"type":20,"value":6066},"listen",{"type":14,"tag":32,"props":6068,"children":6069},{"class":118},[6070],{"type":20,"value":6071},"({ onUnhandledRequest: ",{"type":14,"tag":32,"props":6073,"children":6074},{"class":124},[6075],{"type":20,"value":6076},"'error'",{"type":14,"tag":32,"props":6078,"children":6079},{"class":118},[6080],{"type":20,"value":6081}," }))\n",{"type":14,"tag":32,"props":6083,"children":6084},{"class":107,"line":455},[6085],{"type":14,"tag":32,"props":6086,"children":6087},{"class":291},[6088],{"type":20,"value":6089},"// 在每一次测试结束后关闭服务器\n",{"type":14,"tag":32,"props":6091,"children":6092},{"class":107,"line":464},[6093,6098,6102,6106,6110,6115],{"type":14,"tag":32,"props":6094,"children":6095},{"class":112},[6096],{"type":20,"value":6097},"afterAll",{"type":14,"tag":32,"props":6099,"children":6100},{"class":118},[6101],{"type":20,"value":4729},{"type":14,"tag":32,"props":6103,"children":6104},{"class":308},[6105],{"type":20,"value":569},{"type":14,"tag":32,"props":6107,"children":6108},{"class":118},[6109],{"type":20,"value":6061},{"type":14,"tag":32,"props":6111,"children":6112},{"class":112},[6113],{"type":20,"value":6114},"close",{"type":14,"tag":32,"props":6116,"children":6117},{"class":118},[6118],{"type":20,"value":4763},{"type":14,"tag":32,"props":6120,"children":6121},{"class":107,"line":473},[6122],{"type":14,"tag":32,"props":6123,"children":6124},{"class":291},[6125],{"type":20,"value":6126},"// 在每一个用例结束后重置 handlers\n",{"type":14,"tag":32,"props":6128,"children":6129},{"class":107,"line":482},[6130,6135,6139,6143,6147,6152],{"type":14,"tag":32,"props":6131,"children":6132},{"class":112},[6133],{"type":20,"value":6134},"afterEach",{"type":14,"tag":32,"props":6136,"children":6137},{"class":118},[6138],{"type":20,"value":4729},{"type":14,"tag":32,"props":6140,"children":6141},{"class":308},[6142],{"type":20,"value":569},{"type":14,"tag":32,"props":6144,"children":6145},{"class":118},[6146],{"type":20,"value":6061},{"type":14,"tag":32,"props":6148,"children":6149},{"class":112},[6150],{"type":20,"value":6151},"resetHandlers",{"type":14,"tag":32,"props":6153,"children":6154},{"class":118},[6155],{"type":20,"value":6156},"())",{"type":14,"tag":26,"props":6158,"children":6159},{},[6160,6162,6165,6170],{"type":20,"value":6161},"开启测试, 会显示测试已通过.",{"type":14,"tag":153,"props":6163,"children":6164},{},[],{"type":14,"tag":693,"props":6166,"children":6169},{"alt":6167,"src":6168},"unit test pass","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141529162.png",[],{"type":20,"value":6171},"\n请注意, 因为 msw 的作用是拦截请求而不是开启模拟服务器, 因此直接本地调用并不起作用.",{"type":14,"tag":15,"props":6173,"children":6175},{"id":6174},"异步测试",[6176],{"type":20,"value":6174},{"type":14,"tag":15,"props":6178,"children":6180},{"id":6179},"优化测试过程",[6181],{"type":20,"value":6179},{"type":14,"tag":795,"props":6183,"children":6185},{"id":6184},"内联测试",[6186],{"type":20,"value":6184},{"type":14,"tag":26,"props":6188,"children":6189},{},[6190,6192,6195],{"type":20,"value":6191},"就和内联样式表一样, 所谓内联测试就是将测试代码和源码写在一起.",{"type":14,"tag":153,"props":6193,"children":6194},{},[],{"type":20,"value":6196},"\n改造一下正则表达式的例子:",{"type":14,"tag":91,"props":6198,"children":6201},{"className":6199,"code":6200,"language":278,"meta":5},[276],"/** /src/reg/phone.ts */\nexport function regChinesePhoneNumber(phoneNumber: string) {\n  const regex = /^1[3456789]\\d{9}$/\n  return regex.test(phoneNumber)\n}\n\n// 内联测试应该放在源码的底部\n/**\n * 为了解决 ts 报错\n * 需要在 tsconfig.json 中添加\n * {\"compilerOptions\": {\"types\": [\"vitest/importMeta\"]}}\n */\nif(import.meta.vitest) {\n  const { it, expect } = import.meta.vitest\n  it('phone number belongs to Chinese', () => {\n    expect(regChinesePhoneNumber('41772566381')).toBe(false)\n  })\n}\n",[6202],{"type":14,"tag":99,"props":6203,"children":6204},{},[6205],{"type":14,"tag":91,"props":6206,"children":6207},{"__ignoreMap":5},[6208,6216,6263,6318,6341,6348,6355,6363,6371,6379,6387,6395,6403,6432,6488,6519,6568,6575],{"type":14,"tag":32,"props":6209,"children":6210},{"class":107,"line":108},[6211],{"type":14,"tag":32,"props":6212,"children":6213},{"class":291},[6214],{"type":20,"value":6215},"/** /src/reg/phone.ts */\n",{"type":14,"tag":32,"props":6217,"children":6218},{"class":107,"line":213},[6219,6223,6227,6231,6235,6239,6243,6247,6251,6255,6259],{"type":14,"tag":32,"props":6220,"children":6221},{"class":308},[6222],{"type":20,"value":311},{"type":14,"tag":32,"props":6224,"children":6225},{"class":118},[6226],{"type":20,"value":121},{"type":14,"tag":32,"props":6228,"children":6229},{"class":308},[6230],{"type":20,"value":320},{"type":14,"tag":32,"props":6232,"children":6233},{"class":118},[6234],{"type":20,"value":121},{"type":14,"tag":32,"props":6236,"children":6237},{"class":112},[6238],{"type":20,"value":329},{"type":14,"tag":32,"props":6240,"children":6241},{"class":118},[6242],{"type":20,"value":334},{"type":14,"tag":32,"props":6244,"children":6245},{"class":337},[6246],{"type":20,"value":340},{"type":14,"tag":32,"props":6248,"children":6249},{"class":308},[6250],{"type":20,"value":345},{"type":14,"tag":32,"props":6252,"children":6253},{"class":118},[6254],{"type":20,"value":121},{"type":14,"tag":32,"props":6256,"children":6257},{"class":134},[6258],{"type":20,"value":354},{"type":14,"tag":32,"props":6260,"children":6261},{"class":118},[6262],{"type":20,"value":359},{"type":14,"tag":32,"props":6264,"children":6265},{"class":107,"line":228},[6266,6270,6274,6278,6282,6286,6290,6294,6298,6302,6306,6310,6314],{"type":14,"tag":32,"props":6267,"children":6268},{"class":118},[6269],{"type":20,"value":200},{"type":14,"tag":32,"props":6271,"children":6272},{"class":308},[6273],{"type":20,"value":371},{"type":14,"tag":32,"props":6275,"children":6276},{"class":118},[6277],{"type":20,"value":121},{"type":14,"tag":32,"props":6279,"children":6280},{"class":134},[6281],{"type":20,"value":380},{"type":14,"tag":32,"props":6283,"children":6284},{"class":118},[6285],{"type":20,"value":121},{"type":14,"tag":32,"props":6287,"children":6288},{"class":308},[6289],{"type":20,"value":389},{"type":14,"tag":32,"props":6291,"children":6292},{"class":392},[6293],{"type":20,"value":121},{"type":14,"tag":32,"props":6295,"children":6296},{"class":124},[6297],{"type":20,"value":399},{"type":14,"tag":32,"props":6299,"children":6300},{"class":308},[6301],{"type":20,"value":404},{"type":14,"tag":32,"props":6303,"children":6304},{"class":392},[6305],{"type":20,"value":409},{"type":14,"tag":32,"props":6307,"children":6308},{"class":134},[6309],{"type":20,"value":414},{"type":14,"tag":32,"props":6311,"children":6312},{"class":308},[6313],{"type":20,"value":419},{"type":14,"tag":32,"props":6315,"children":6316},{"class":124},[6317],{"type":20,"value":424},{"type":14,"tag":32,"props":6319,"children":6320},{"class":107,"line":256},[6321,6325,6329,6333,6337],{"type":14,"tag":32,"props":6322,"children":6323},{"class":118},[6324],{"type":20,"value":200},{"type":14,"tag":32,"props":6326,"children":6327},{"class":308},[6328],{"type":20,"value":437},{"type":14,"tag":32,"props":6330,"children":6331},{"class":118},[6332],{"type":20,"value":442},{"type":14,"tag":32,"props":6334,"children":6335},{"class":112},[6336],{"type":20,"value":447},{"type":14,"tag":32,"props":6338,"children":6339},{"class":118},[6340],{"type":20,"value":452},{"type":14,"tag":32,"props":6342,"children":6343},{"class":107,"line":427},[6344],{"type":14,"tag":32,"props":6345,"children":6346},{"class":118},[6347],{"type":20,"value":461},{"type":14,"tag":32,"props":6349,"children":6350},{"class":107,"line":455},[6351],{"type":14,"tag":32,"props":6352,"children":6353},{},[6354],{"type":20,"value":470},{"type":14,"tag":32,"props":6356,"children":6357},{"class":107,"line":464},[6358],{"type":14,"tag":32,"props":6359,"children":6360},{"class":291},[6361],{"type":20,"value":6362},"// 内联测试应该放在源码的底部\n",{"type":14,"tag":32,"props":6364,"children":6365},{"class":107,"line":473},[6366],{"type":14,"tag":32,"props":6367,"children":6368},{"class":291},[6369],{"type":20,"value":6370},"/**\n",{"type":14,"tag":32,"props":6372,"children":6373},{"class":107,"line":482},[6374],{"type":14,"tag":32,"props":6375,"children":6376},{"class":291},[6377],{"type":20,"value":6378}," * 为了解决 ts 报错\n",{"type":14,"tag":32,"props":6380,"children":6381},{"class":107,"line":510},[6382],{"type":14,"tag":32,"props":6383,"children":6384},{"class":291},[6385],{"type":20,"value":6386}," * 需要在 tsconfig.json 中添加\n",{"type":14,"tag":32,"props":6388,"children":6389},{"class":107,"line":536},[6390],{"type":14,"tag":32,"props":6391,"children":6392},{"class":291},[6393],{"type":20,"value":6394}," * {\"compilerOptions\": {\"types\": [\"vitest/importMeta\"]}}\n",{"type":14,"tag":32,"props":6396,"children":6397},{"class":107,"line":544},[6398],{"type":14,"tag":32,"props":6399,"children":6400},{"class":291},[6401],{"type":20,"value":6402}," */\n",{"type":14,"tag":32,"props":6404,"children":6405},{"class":107,"line":577},[6406,6410,6414,6418,6422,6427],{"type":14,"tag":32,"props":6407,"children":6408},{"class":308},[6409],{"type":20,"value":1820},{"type":14,"tag":32,"props":6411,"children":6412},{"class":118},[6413],{"type":20,"value":334},{"type":14,"tag":32,"props":6415,"children":6416},{"class":308},[6417],{"type":20,"value":488},{"type":14,"tag":32,"props":6419,"children":6420},{"class":118},[6421],{"type":20,"value":5001},{"type":14,"tag":32,"props":6423,"children":6424},{"class":134},[6425],{"type":20,"value":6426},"meta",{"type":14,"tag":32,"props":6428,"children":6429},{"class":118},[6430],{"type":20,"value":6431},".vitest) {\n",{"type":14,"tag":32,"props":6433,"children":6434},{"class":107,"line":610},[6435,6439,6443,6447,6451,6455,6459,6463,6467,6471,6475,6479,6483],{"type":14,"tag":32,"props":6436,"children":6437},{"class":118},[6438],{"type":20,"value":200},{"type":14,"tag":32,"props":6440,"children":6441},{"class":308},[6442],{"type":20,"value":371},{"type":14,"tag":32,"props":6444,"children":6445},{"class":118},[6446],{"type":20,"value":1751},{"type":14,"tag":32,"props":6448,"children":6449},{"class":134},[6450],{"type":20,"value":1214},{"type":14,"tag":32,"props":6452,"children":6453},{"class":118},[6454],{"type":20,"value":1228},{"type":14,"tag":32,"props":6456,"children":6457},{"class":134},[6458],{"type":20,"value":620},{"type":14,"tag":32,"props":6460,"children":6461},{"class":118},[6462],{"type":20,"value":1769},{"type":14,"tag":32,"props":6464,"children":6465},{"class":308},[6466],{"type":20,"value":389},{"type":14,"tag":32,"props":6468,"children":6469},{"class":118},[6470],{"type":20,"value":121},{"type":14,"tag":32,"props":6472,"children":6473},{"class":308},[6474],{"type":20,"value":488},{"type":14,"tag":32,"props":6476,"children":6477},{"class":118},[6478],{"type":20,"value":5001},{"type":14,"tag":32,"props":6480,"children":6481},{"class":134},[6482],{"type":20,"value":6426},{"type":14,"tag":32,"props":6484,"children":6485},{"class":118},[6486],{"type":20,"value":6487},".vitest\n",{"type":14,"tag":32,"props":6489,"children":6490},{"class":107,"line":664},[6491,6495,6499,6503,6507,6511,6515],{"type":14,"tag":32,"props":6492,"children":6493},{"class":118},[6494],{"type":20,"value":200},{"type":14,"tag":32,"props":6496,"children":6497},{"class":112},[6498],{"type":20,"value":1214},{"type":14,"tag":32,"props":6500,"children":6501},{"class":118},[6502],{"type":20,"value":334},{"type":14,"tag":32,"props":6504,"children":6505},{"class":124},[6506],{"type":20,"value":595},{"type":14,"tag":32,"props":6508,"children":6509},{"class":118},[6510],{"type":20,"value":564},{"type":14,"tag":32,"props":6512,"children":6513},{"class":308},[6514],{"type":20,"value":569},{"type":14,"tag":32,"props":6516,"children":6517},{"class":118},[6518],{"type":20,"value":574},{"type":14,"tag":32,"props":6520,"children":6521},{"class":107,"line":673},[6522,6526,6530,6534,6538,6542,6547,6551,6555,6559,6564],{"type":14,"tag":32,"props":6523,"children":6524},{"class":118},[6525],{"type":20,"value":219},{"type":14,"tag":32,"props":6527,"children":6528},{"class":112},[6529],{"type":20,"value":620},{"type":14,"tag":32,"props":6531,"children":6532},{"class":118},[6533],{"type":20,"value":334},{"type":14,"tag":32,"props":6535,"children":6536},{"class":112},[6537],{"type":20,"value":329},{"type":14,"tag":32,"props":6539,"children":6540},{"class":118},[6541],{"type":20,"value":334},{"type":14,"tag":32,"props":6543,"children":6544},{"class":124},[6545],{"type":20,"value":6546},"'41772566381'",{"type":14,"tag":32,"props":6548,"children":6549},{"class":118},[6550],{"type":20,"value":642},{"type":14,"tag":32,"props":6552,"children":6553},{"class":112},[6554],{"type":20,"value":647},{"type":14,"tag":32,"props":6556,"children":6557},{"class":118},[6558],{"type":20,"value":334},{"type":14,"tag":32,"props":6560,"children":6561},{"class":134},[6562],{"type":20,"value":6563},"false",{"type":14,"tag":32,"props":6565,"children":6566},{"class":118},[6567],{"type":20,"value":661},{"type":14,"tag":32,"props":6569,"children":6570},{"class":107,"line":1149},[6571],{"type":14,"tag":32,"props":6572,"children":6573},{"class":118},[6574],{"type":20,"value":670},{"type":14,"tag":32,"props":6576,"children":6577},{"class":107,"line":1174},[6578],{"type":14,"tag":32,"props":6579,"children":6580},{"class":118},[6581],{"type":20,"value":2497},{"type":14,"tag":26,"props":6583,"children":6584},{},[6585,6587,6592],{"type":20,"value":6586},"随后更新一下",{"type":14,"tag":159,"props":6588,"children":6589},{},[6590],{"type":20,"value":6591},"vitest.config.ts",{"type":20,"value":5001},{"type":14,"tag":91,"props":6594,"children":6597},{"className":6595,"code":6596,"language":278,"meta":5},[276],"export default defineConfig({\n  test: {\n    includeSource: ['src/**/*.{js,ts}'], \n  }\n})\n",[6598],{"type":14,"tag":99,"props":6599,"children":6600},{},[6601],{"type":14,"tag":91,"props":6602,"children":6603},{"__ignoreMap":5},[6604,6631,6638,6656,6663],{"type":14,"tag":32,"props":6605,"children":6606},{"class":107,"line":108},[6607,6611,6615,6619,6623,6627],{"type":14,"tag":32,"props":6608,"children":6609},{"class":308},[6610],{"type":20,"value":311},{"type":14,"tag":32,"props":6612,"children":6613},{"class":118},[6614],{"type":20,"value":121},{"type":14,"tag":32,"props":6616,"children":6617},{"class":308},[6618],{"type":20,"value":2317},{"type":14,"tag":32,"props":6620,"children":6621},{"class":118},[6622],{"type":20,"value":121},{"type":14,"tag":32,"props":6624,"children":6625},{"class":112},[6626],{"type":20,"value":5898},{"type":14,"tag":32,"props":6628,"children":6629},{"class":118},[6630],{"type":20,"value":2742},{"type":14,"tag":32,"props":6632,"children":6633},{"class":107,"line":213},[6634],{"type":14,"tag":32,"props":6635,"children":6636},{"class":118},[6637],{"type":20,"value":5910},{"type":14,"tag":32,"props":6639,"children":6640},{"class":107,"line":228},[6641,6646,6651],{"type":14,"tag":32,"props":6642,"children":6643},{"class":118},[6644],{"type":20,"value":6645},"    includeSource: [",{"type":14,"tag":32,"props":6647,"children":6648},{"class":124},[6649],{"type":20,"value":6650},"'src/**/*.{js,ts}'",{"type":14,"tag":32,"props":6652,"children":6653},{"class":118},[6654],{"type":20,"value":6655},"], \n",{"type":14,"tag":32,"props":6657,"children":6658},{"class":107,"line":256},[6659],{"type":14,"tag":32,"props":6660,"children":6661},{"class":118},[6662],{"type":20,"value":1895},{"type":14,"tag":32,"props":6664,"children":6665},{"class":107,"line":427},[6666],{"type":14,"tag":32,"props":6667,"children":6668},{"class":118},[6669],{"type":20,"value":679},{"type":14,"tag":26,"props":6671,"children":6672},{},[6673,6675,6680,6682,6685,6690],{"type":20,"value":6674},"可以看到新运行的用例增加了一个非",{"type":14,"tag":159,"props":6676,"children":6677},{},[6678],{"type":20,"value":6679},"test.ts",{"type":20,"value":6681},"结尾的文件.",{"type":14,"tag":153,"props":6683,"children":6684},{},[],{"type":14,"tag":693,"props":6686,"children":6689},{"alt":6687,"src":6688},"in source test","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141609782.png",[],{"type":20,"value":6691},"\n这样做的缺点是会造成打包后的代码体积膨胀, 但我们可以做一些处理让代码块作为不会被执行的区块被 tree-shake 掉.",{"type":14,"tag":91,"props":6693,"children":6696},{"className":6694,"code":6695,"language":278,"meta":5},[276],"/** vite.config.ts */\nexport default defineConfig({\n  define: {\n    'import.meta.vitest': 'undefined', \n  }, \n})\n",[6697],{"type":14,"tag":99,"props":6698,"children":6699},{},[6700],{"type":14,"tag":91,"props":6701,"children":6702},{"__ignoreMap":5},[6703,6711,6738,6746,6772,6780],{"type":14,"tag":32,"props":6704,"children":6705},{"class":107,"line":108},[6706],{"type":14,"tag":32,"props":6707,"children":6708},{"class":291},[6709],{"type":20,"value":6710},"/** vite.config.ts */\n",{"type":14,"tag":32,"props":6712,"children":6713},{"class":107,"line":213},[6714,6718,6722,6726,6730,6734],{"type":14,"tag":32,"props":6715,"children":6716},{"class":308},[6717],{"type":20,"value":311},{"type":14,"tag":32,"props":6719,"children":6720},{"class":118},[6721],{"type":20,"value":121},{"type":14,"tag":32,"props":6723,"children":6724},{"class":308},[6725],{"type":20,"value":2317},{"type":14,"tag":32,"props":6727,"children":6728},{"class":118},[6729],{"type":20,"value":121},{"type":14,"tag":32,"props":6731,"children":6732},{"class":112},[6733],{"type":20,"value":5898},{"type":14,"tag":32,"props":6735,"children":6736},{"class":118},[6737],{"type":20,"value":2742},{"type":14,"tag":32,"props":6739,"children":6740},{"class":107,"line":228},[6741],{"type":14,"tag":32,"props":6742,"children":6743},{"class":118},[6744],{"type":20,"value":6745},"  define: {\n",{"type":14,"tag":32,"props":6747,"children":6748},{"class":107,"line":256},[6749,6753,6758,6762,6767],{"type":14,"tag":32,"props":6750,"children":6751},{"class":118},[6752],{"type":20,"value":219},{"type":14,"tag":32,"props":6754,"children":6755},{"class":124},[6756],{"type":20,"value":6757},"'import.meta.vitest'",{"type":14,"tag":32,"props":6759,"children":6760},{"class":118},[6761],{"type":20,"value":243},{"type":14,"tag":32,"props":6763,"children":6764},{"class":124},[6765],{"type":20,"value":6766},"'undefined'",{"type":14,"tag":32,"props":6768,"children":6769},{"class":118},[6770],{"type":20,"value":6771},", \n",{"type":14,"tag":32,"props":6773,"children":6774},{"class":107,"line":427},[6775],{"type":14,"tag":32,"props":6776,"children":6777},{"class":118},[6778],{"type":20,"value":6779},"  }, \n",{"type":14,"tag":32,"props":6781,"children":6782},{"class":107,"line":455},[6783],{"type":14,"tag":32,"props":6784,"children":6785},{"class":118},[6786],{"type":20,"value":679},{"type":14,"tag":795,"props":6788,"children":6790},{"id":6789},"类型测试-experimental",[6791],{"type":20,"value":6792},"类型测试 (Experimental)",{"type":14,"tag":26,"props":6794,"children":6795},{},[6796,6798,6801],{"type":20,"value":6797},"ts 的类型在编译后会被擦除, 也就是说无论类型代码写的有多完备, 对真正运行的 js 代码并不会有影响. 但通过类型测试可以促使类型代码更sound, 以此提高 ts 项目的强健性.",{"type":14,"tag":153,"props":6799,"children":6800},{},[],{"type":20,"value":6802},"\n不过总的来说类型测试并不常用, 此处仅介绍一下一般流程.",{"type":14,"tag":91,"props":6804,"children":6807},{"className":6805,"code":6806,"language":278,"meta":5},[276],"/** /src/types/MPick.d.ts */\n// 实现一个自己的 Pick 方法\nexport type MPick\u003CT, K extends keyof T> = {\n  [P in K]: T[P]\n}\n\n/** /src/types/__test__/MPick.test-d.ts */\n\n// vitest 会自动扫描 .test-d.ts 命令的文件\nimport { expectTypeOf, test } from 'vitest'\nimport type { MPick } from '../MPick'\n\ntest('test mock Pick', () => {\n  interface Foo {\n    a: string\n    b: number\n  }\n  type Bar = MPick\u003CFoo, 'a'>\n  interface Exp {\n    a: string\n  }\n  expectTypeOf\u003CBar>().toEqualTypeOf\u003CExp>()\n})\n",[6808],{"type":14,"tag":99,"props":6809,"children":6810},{},[6811],{"type":14,"tag":91,"props":6812,"children":6813},{"__ignoreMap":5},[6814,6822,6830,6910,6970,6977,6984,6992,6999,7007,7031,7064,7071,7099,7124,7149,7174,7181,7239,7263,7286,7293,7336],{"type":14,"tag":32,"props":6815,"children":6816},{"class":107,"line":108},[6817],{"type":14,"tag":32,"props":6818,"children":6819},{"class":291},[6820],{"type":20,"value":6821},"/** /src/types/MPick.d.ts */\n",{"type":14,"tag":32,"props":6823,"children":6824},{"class":107,"line":213},[6825],{"type":14,"tag":32,"props":6826,"children":6827},{"class":291},[6828],{"type":20,"value":6829},"// 实现一个自己的 Pick 方法\n",{"type":14,"tag":32,"props":6831,"children":6832},{"class":107,"line":228},[6833,6837,6841,6845,6849,6854,6858,6863,6867,6872,6876,6881,6885,6890,6894,6898,6902,6906],{"type":14,"tag":32,"props":6834,"children":6835},{"class":308},[6836],{"type":20,"value":311},{"type":14,"tag":32,"props":6838,"children":6839},{"class":118},[6840],{"type":20,"value":121},{"type":14,"tag":32,"props":6842,"children":6843},{"class":308},[6844],{"type":20,"value":844},{"type":14,"tag":32,"props":6846,"children":6847},{"class":118},[6848],{"type":20,"value":121},{"type":14,"tag":32,"props":6850,"children":6851},{"class":112},[6852],{"type":20,"value":6853},"MPick",{"type":14,"tag":32,"props":6855,"children":6856},{"class":118},[6857],{"type":20,"value":5692},{"type":14,"tag":32,"props":6859,"children":6860},{"class":112},[6861],{"type":20,"value":6862},"T",{"type":14,"tag":32,"props":6864,"children":6865},{"class":118},[6866],{"type":20,"value":1228},{"type":14,"tag":32,"props":6868,"children":6869},{"class":112},[6870],{"type":20,"value":6871},"K",{"type":14,"tag":32,"props":6873,"children":6874},{"class":118},[6875],{"type":20,"value":121},{"type":14,"tag":32,"props":6877,"children":6878},{"class":308},[6879],{"type":20,"value":6880},"extends",{"type":14,"tag":32,"props":6882,"children":6883},{"class":118},[6884],{"type":20,"value":121},{"type":14,"tag":32,"props":6886,"children":6887},{"class":308},[6888],{"type":20,"value":6889},"keyof",{"type":14,"tag":32,"props":6891,"children":6892},{"class":118},[6893],{"type":20,"value":121},{"type":14,"tag":32,"props":6895,"children":6896},{"class":112},[6897],{"type":20,"value":6862},{"type":14,"tag":32,"props":6899,"children":6900},{"class":118},[6901],{"type":20,"value":5702},{"type":14,"tag":32,"props":6903,"children":6904},{"class":308},[6905],{"type":20,"value":389},{"type":14,"tag":32,"props":6907,"children":6908},{"class":118},[6909],{"type":20,"value":574},{"type":14,"tag":32,"props":6911,"children":6912},{"class":107,"line":256},[6913,6918,6923,6927,6932,6936,6940,6945,6949,6953,6957,6962,6966],{"type":14,"tag":32,"props":6914,"children":6915},{"class":118},[6916],{"type":20,"value":6917},"  [",{"type":14,"tag":32,"props":6919,"children":6920},{"class":112},[6921],{"type":20,"value":6922},"P",{"type":14,"tag":32,"props":6924,"children":6925},{"class":118},[6926],{"type":20,"value":121},{"type":14,"tag":32,"props":6928,"children":6929},{"class":308},[6930],{"type":20,"value":6931},"in",{"type":14,"tag":32,"props":6933,"children":6934},{"class":118},[6935],{"type":20,"value":121},{"type":14,"tag":32,"props":6937,"children":6938},{"class":112},[6939],{"type":20,"value":6871},{"type":14,"tag":32,"props":6941,"children":6942},{"class":118},[6943],{"type":20,"value":6944},"]",{"type":14,"tag":32,"props":6946,"children":6947},{"class":308},[6948],{"type":20,"value":345},{"type":14,"tag":32,"props":6950,"children":6951},{"class":118},[6952],{"type":20,"value":121},{"type":14,"tag":32,"props":6954,"children":6955},{"class":112},[6956],{"type":20,"value":6862},{"type":14,"tag":32,"props":6958,"children":6959},{"class":118},[6960],{"type":20,"value":6961},"[",{"type":14,"tag":32,"props":6963,"children":6964},{"class":112},[6965],{"type":20,"value":6922},{"type":14,"tag":32,"props":6967,"children":6968},{"class":118},[6969],{"type":20,"value":5800},{"type":14,"tag":32,"props":6971,"children":6972},{"class":107,"line":427},[6973],{"type":14,"tag":32,"props":6974,"children":6975},{"class":118},[6976],{"type":20,"value":461},{"type":14,"tag":32,"props":6978,"children":6979},{"class":107,"line":455},[6980],{"type":14,"tag":32,"props":6981,"children":6982},{},[6983],{"type":20,"value":470},{"type":14,"tag":32,"props":6985,"children":6986},{"class":107,"line":464},[6987],{"type":14,"tag":32,"props":6988,"children":6989},{"class":291},[6990],{"type":20,"value":6991},"/** /src/types/__test__/MPick.test-d.ts */\n",{"type":14,"tag":32,"props":6993,"children":6994},{"class":107,"line":473},[6995],{"type":14,"tag":32,"props":6996,"children":6997},{},[6998],{"type":20,"value":470},{"type":14,"tag":32,"props":7000,"children":7001},{"class":107,"line":482},[7002],{"type":14,"tag":32,"props":7003,"children":7004},{"class":291},[7005],{"type":20,"value":7006},"// vitest 会自动扫描 .test-d.ts 命令的文件\n",{"type":14,"tag":32,"props":7008,"children":7009},{"class":107,"line":510},[7010,7014,7019,7023,7027],{"type":14,"tag":32,"props":7011,"children":7012},{"class":308},[7013],{"type":20,"value":488},{"type":14,"tag":32,"props":7015,"children":7016},{"class":118},[7017],{"type":20,"value":7018}," { expectTypeOf, test } ",{"type":14,"tag":32,"props":7020,"children":7021},{"class":308},[7022],{"type":20,"value":498},{"type":14,"tag":32,"props":7024,"children":7025},{"class":118},[7026],{"type":20,"value":121},{"type":14,"tag":32,"props":7028,"children":7029},{"class":124},[7030],{"type":20,"value":507},{"type":14,"tag":32,"props":7032,"children":7033},{"class":107,"line":536},[7034,7038,7042,7046,7051,7055,7059],{"type":14,"tag":32,"props":7035,"children":7036},{"class":308},[7037],{"type":20,"value":488},{"type":14,"tag":32,"props":7039,"children":7040},{"class":118},[7041],{"type":20,"value":121},{"type":14,"tag":32,"props":7043,"children":7044},{"class":308},[7045],{"type":20,"value":844},{"type":14,"tag":32,"props":7047,"children":7048},{"class":118},[7049],{"type":20,"value":7050}," { MPick } ",{"type":14,"tag":32,"props":7052,"children":7053},{"class":308},[7054],{"type":20,"value":498},{"type":14,"tag":32,"props":7056,"children":7057},{"class":118},[7058],{"type":20,"value":121},{"type":14,"tag":32,"props":7060,"children":7061},{"class":124},[7062],{"type":20,"value":7063},"'../MPick'\n",{"type":14,"tag":32,"props":7065,"children":7066},{"class":107,"line":544},[7067],{"type":14,"tag":32,"props":7068,"children":7069},{},[7070],{"type":20,"value":470},{"type":14,"tag":32,"props":7072,"children":7073},{"class":107,"line":577},[7074,7078,7082,7087,7091,7095],{"type":14,"tag":32,"props":7075,"children":7076},{"class":112},[7077],{"type":20,"value":447},{"type":14,"tag":32,"props":7079,"children":7080},{"class":118},[7081],{"type":20,"value":334},{"type":14,"tag":32,"props":7083,"children":7084},{"class":124},[7085],{"type":20,"value":7086},"'test mock Pick'",{"type":14,"tag":32,"props":7088,"children":7089},{"class":118},[7090],{"type":20,"value":564},{"type":14,"tag":32,"props":7092,"children":7093},{"class":308},[7094],{"type":20,"value":569},{"type":14,"tag":32,"props":7096,"children":7097},{"class":118},[7098],{"type":20,"value":574},{"type":14,"tag":32,"props":7100,"children":7101},{"class":107,"line":610},[7102,7106,7111,7115,7120],{"type":14,"tag":32,"props":7103,"children":7104},{"class":118},[7105],{"type":20,"value":200},{"type":14,"tag":32,"props":7107,"children":7108},{"class":308},[7109],{"type":20,"value":7110},"interface",{"type":14,"tag":32,"props":7112,"children":7113},{"class":118},[7114],{"type":20,"value":121},{"type":14,"tag":32,"props":7116,"children":7117},{"class":112},[7118],{"type":20,"value":7119},"Foo",{"type":14,"tag":32,"props":7121,"children":7122},{"class":118},[7123],{"type":20,"value":574},{"type":14,"tag":32,"props":7125,"children":7126},{"class":107,"line":664},[7127,7131,7136,7140,7144],{"type":14,"tag":32,"props":7128,"children":7129},{"class":118},[7130],{"type":20,"value":219},{"type":14,"tag":32,"props":7132,"children":7133},{"class":337},[7134],{"type":20,"value":7135},"a",{"type":14,"tag":32,"props":7137,"children":7138},{"class":308},[7139],{"type":20,"value":345},{"type":14,"tag":32,"props":7141,"children":7142},{"class":118},[7143],{"type":20,"value":121},{"type":14,"tag":32,"props":7145,"children":7146},{"class":134},[7147],{"type":20,"value":7148},"string\n",{"type":14,"tag":32,"props":7150,"children":7151},{"class":107,"line":673},[7152,7156,7161,7165,7169],{"type":14,"tag":32,"props":7153,"children":7154},{"class":118},[7155],{"type":20,"value":219},{"type":14,"tag":32,"props":7157,"children":7158},{"class":337},[7159],{"type":20,"value":7160},"b",{"type":14,"tag":32,"props":7162,"children":7163},{"class":308},[7164],{"type":20,"value":345},{"type":14,"tag":32,"props":7166,"children":7167},{"class":118},[7168],{"type":20,"value":121},{"type":14,"tag":32,"props":7170,"children":7171},{"class":134},[7172],{"type":20,"value":7173},"number\n",{"type":14,"tag":32,"props":7175,"children":7176},{"class":107,"line":1149},[7177],{"type":14,"tag":32,"props":7178,"children":7179},{"class":118},[7180],{"type":20,"value":1895},{"type":14,"tag":32,"props":7182,"children":7183},{"class":107,"line":1174},[7184,7188,7192,7196,7201,7205,7209,7213,7217,7221,7225,7229,7234],{"type":14,"tag":32,"props":7185,"children":7186},{"class":118},[7187],{"type":20,"value":200},{"type":14,"tag":32,"props":7189,"children":7190},{"class":308},[7191],{"type":20,"value":844},{"type":14,"tag":32,"props":7193,"children":7194},{"class":118},[7195],{"type":20,"value":121},{"type":14,"tag":32,"props":7197,"children":7198},{"class":112},[7199],{"type":20,"value":7200},"Bar",{"type":14,"tag":32,"props":7202,"children":7203},{"class":118},[7204],{"type":20,"value":121},{"type":14,"tag":32,"props":7206,"children":7207},{"class":308},[7208],{"type":20,"value":389},{"type":14,"tag":32,"props":7210,"children":7211},{"class":118},[7212],{"type":20,"value":121},{"type":14,"tag":32,"props":7214,"children":7215},{"class":112},[7216],{"type":20,"value":6853},{"type":14,"tag":32,"props":7218,"children":7219},{"class":118},[7220],{"type":20,"value":5692},{"type":14,"tag":32,"props":7222,"children":7223},{"class":112},[7224],{"type":20,"value":7119},{"type":14,"tag":32,"props":7226,"children":7227},{"class":118},[7228],{"type":20,"value":1228},{"type":14,"tag":32,"props":7230,"children":7231},{"class":124},[7232],{"type":20,"value":7233},"'a'",{"type":14,"tag":32,"props":7235,"children":7236},{"class":118},[7237],{"type":20,"value":7238},">\n",{"type":14,"tag":32,"props":7240,"children":7241},{"class":107,"line":1200},[7242,7246,7250,7254,7259],{"type":14,"tag":32,"props":7243,"children":7244},{"class":118},[7245],{"type":20,"value":200},{"type":14,"tag":32,"props":7247,"children":7248},{"class":308},[7249],{"type":20,"value":7110},{"type":14,"tag":32,"props":7251,"children":7252},{"class":118},[7253],{"type":20,"value":121},{"type":14,"tag":32,"props":7255,"children":7256},{"class":112},[7257],{"type":20,"value":7258},"Exp",{"type":14,"tag":32,"props":7260,"children":7261},{"class":118},[7262],{"type":20,"value":574},{"type":14,"tag":32,"props":7264,"children":7265},{"class":107,"line":1208},[7266,7270,7274,7278,7282],{"type":14,"tag":32,"props":7267,"children":7268},{"class":118},[7269],{"type":20,"value":219},{"type":14,"tag":32,"props":7271,"children":7272},{"class":337},[7273],{"type":20,"value":7135},{"type":14,"tag":32,"props":7275,"children":7276},{"class":308},[7277],{"type":20,"value":345},{"type":14,"tag":32,"props":7279,"children":7280},{"class":118},[7281],{"type":20,"value":121},{"type":14,"tag":32,"props":7283,"children":7284},{"class":134},[7285],{"type":20,"value":7148},{"type":14,"tag":32,"props":7287,"children":7288},{"class":107,"line":1249},[7289],{"type":14,"tag":32,"props":7290,"children":7291},{"class":118},[7292],{"type":20,"value":1895},{"type":14,"tag":32,"props":7294,"children":7295},{"class":107,"line":1297},[7296,7300,7305,7309,7313,7318,7323,7327,7331],{"type":14,"tag":32,"props":7297,"children":7298},{"class":118},[7299],{"type":20,"value":200},{"type":14,"tag":32,"props":7301,"children":7302},{"class":112},[7303],{"type":20,"value":7304},"expectTypeOf",{"type":14,"tag":32,"props":7306,"children":7307},{"class":118},[7308],{"type":20,"value":5692},{"type":14,"tag":32,"props":7310,"children":7311},{"class":112},[7312],{"type":20,"value":7200},{"type":14,"tag":32,"props":7314,"children":7315},{"class":118},[7316],{"type":20,"value":7317},">().",{"type":14,"tag":32,"props":7319,"children":7320},{"class":112},[7321],{"type":20,"value":7322},"toEqualTypeOf",{"type":14,"tag":32,"props":7324,"children":7325},{"class":118},[7326],{"type":20,"value":5692},{"type":14,"tag":32,"props":7328,"children":7329},{"class":112},[7330],{"type":20,"value":7258},{"type":14,"tag":32,"props":7332,"children":7333},{"class":118},[7334],{"type":20,"value":7335},">()\n",{"type":14,"tag":32,"props":7337,"children":7338},{"class":107,"line":1338},[7339],{"type":14,"tag":32,"props":7340,"children":7341},{"class":118},[7342],{"type":20,"value":679},{"type":14,"tag":26,"props":7344,"children":7345},{},[7346,7348,7353,7356,7358,7363],{"type":20,"value":7347},"为了启动类型测试, 需要在启动时指定 --typecheck, 添加一个新的 npm 命令 ",{"type":14,"tag":159,"props":7349,"children":7350},{},[7351],{"type":20,"value":7352},"\"test:type\": \"vitest --typecheck\"",{"type":14,"tag":153,"props":7354,"children":7355},{},[],{"type":20,"value":7357},"\n运行",{"type":14,"tag":159,"props":7359,"children":7360},{},[7361],{"type":20,"value":7362},"pnpm run test:type",{"type":20,"value":7364},"运行测试",{"type":14,"tag":795,"props":7366,"children":7368},{"id":7367},"可视化",[7369],{"type":20,"value":7367},{"type":14,"tag":26,"props":7371,"children":7372},{},[7373,7375,7380,7382,7387,7389,7394,7396],{"type":20,"value":7374},"Vitest 提供了 UI 界面进行交互, 运行",{"type":14,"tag":159,"props":7376,"children":7377},{},[7378],{"type":20,"value":7379},"pnpm install @vitest/ui",{"type":20,"value":7381},"安装, ",{"type":14,"tag":159,"props":7383,"children":7384},{},[7385],{"type":20,"value":7386},"pnpm run test:unit --ui",{"type":20,"value":7388}," 启动\n",{"type":14,"tag":693,"props":7390,"children":7393},{"alt":7391,"src":7392},"ui","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141744611.png",[],{"type":20,"value":7395},"\n里面涵盖了几乎所有的操作, 还可以查看 console、源码和依赖图.\n",{"type":14,"tag":693,"props":7397,"children":7400},{"alt":7398,"src":7399},"Graph","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141745142.png",[],{"type":14,"tag":795,"props":7402,"children":7404},{"id":7403},"代码覆盖率",[7405],{"type":20,"value":7403},{"type":14,"tag":26,"props":7407,"children":7408},{},[7409,7411,7416,7418,7421],{"type":20,"value":7410},"Vitest 通过 V8 提供代码覆盖率检查, 运行",{"type":14,"tag":159,"props":7412,"children":7413},{},[7414],{"type":20,"value":7415},"pnpm install @vitest/coverage-v8",{"type":20,"value":7417},"安装",{"type":14,"tag":153,"props":7419,"children":7420},{},[],{"type":20,"value":7422},"\n在 vitest.config 中配置覆盖率选项",{"type":14,"tag":91,"props":7424,"children":7427},{"className":7425,"code":7426,"language":278,"meta":5},[276],"defineConfig({\n  test: {\n    coverage: {\n      enabled: true,\n      reporter: ['html']\n    }\n  }\n})\n",[7428],{"type":14,"tag":99,"props":7429,"children":7430},{},[7431],{"type":14,"tag":91,"props":7432,"children":7433},{"__ignoreMap":5},[7434,7445,7452,7460,7476,7493,7500,7507],{"type":14,"tag":32,"props":7435,"children":7436},{"class":107,"line":108},[7437,7441],{"type":14,"tag":32,"props":7438,"children":7439},{"class":112},[7440],{"type":20,"value":5898},{"type":14,"tag":32,"props":7442,"children":7443},{"class":118},[7444],{"type":20,"value":2742},{"type":14,"tag":32,"props":7446,"children":7447},{"class":107,"line":213},[7448],{"type":14,"tag":32,"props":7449,"children":7450},{"class":118},[7451],{"type":20,"value":5910},{"type":14,"tag":32,"props":7453,"children":7454},{"class":107,"line":228},[7455],{"type":14,"tag":32,"props":7456,"children":7457},{"class":118},[7458],{"type":20,"value":7459},"    coverage: {\n",{"type":14,"tag":32,"props":7461,"children":7462},{"class":107,"line":256},[7463,7468,7472],{"type":14,"tag":32,"props":7464,"children":7465},{"class":118},[7466],{"type":20,"value":7467},"      enabled: ",{"type":14,"tag":32,"props":7469,"children":7470},{"class":134},[7471],{"type":20,"value":656},{"type":14,"tag":32,"props":7473,"children":7474},{"class":118},[7475],{"type":20,"value":253},{"type":14,"tag":32,"props":7477,"children":7478},{"class":107,"line":427},[7479,7484,7489],{"type":14,"tag":32,"props":7480,"children":7481},{"class":118},[7482],{"type":20,"value":7483},"      reporter: [",{"type":14,"tag":32,"props":7485,"children":7486},{"class":124},[7487],{"type":20,"value":7488},"'html'",{"type":14,"tag":32,"props":7490,"children":7491},{"class":118},[7492],{"type":20,"value":5800},{"type":14,"tag":32,"props":7494,"children":7495},{"class":107,"line":455},[7496],{"type":14,"tag":32,"props":7497,"children":7498},{"class":118},[7499],{"type":20,"value":3797},{"type":14,"tag":32,"props":7501,"children":7502},{"class":107,"line":464},[7503],{"type":14,"tag":32,"props":7504,"children":7505},{"class":118},[7506],{"type":20,"value":1895},{"type":14,"tag":32,"props":7508,"children":7509},{"class":107,"line":473},[7510],{"type":14,"tag":32,"props":7511,"children":7512},{"class":118},[7513],{"type":20,"value":679},{"type":14,"tag":26,"props":7515,"children":7516},{},[7517,7519,7522],{"type":20,"value":7518},"这样就可以在 ui 界面上看到代码覆盖率结果了",{"type":14,"tag":153,"props":7520,"children":7521},{},[],{"type":14,"tag":693,"props":7523,"children":7526},{"alt":7524,"src":7525},"coverage ui","https://pic-base-1307984077.cos.ap-nanjing.myqcloud.com/202312141752020.png",[],{"type":14,"tag":7528,"children":7529},"style",[7530],{"type":20,"value":7531},".ct-941699{color:#B392F0;}\n.light .ct-941699{color:#6F42C1;}\n.ct-212337{color:#E1E4E8;}\n.light .ct-212337{color:#24292E;}\n.ct-695486{color:#9ECBFF;}\n.light .ct-695486{color:#032F62;}\n.ct-055721{color:#79B8FF;}\n.light .ct-055721{color:#005CC5;}\n.ct-338738{color:#FDAEB7;font-style:italic;}\n.light .ct-338738{color:#B31D28;font-style:italic;}\n.ct-782603{color:#6A737D;}\n.ct-984823{color:#F97583;}\n.light .ct-984823{color:#D73A49;}\n.ct-880416{color:#FFAB70;}\n.light .ct-880416{color:#E36209;}\n.ct-273446{color:#DBEDFF;}\n.light .ct-273446{color:#032F62;}",{"title":5,"searchDepth":213,"depth":213,"links":7533},[7534,7535,7536,7537,7538,7539,7540,7541],{"id":53,"depth":213,"text":53},{"id":1501,"depth":213,"text":1501},{"id":3189,"depth":213,"text":3192},{"id":4580,"depth":213,"text":4580},{"id":6184,"depth":213,"text":6184},{"id":6789,"depth":213,"text":6792},{"id":7367,"depth":213,"text":7367},{"id":7403,"depth":213,"text":7403},"markdown","content:1701870426245.md","content","1701870426245.md","md",1702547988701]